import{r as S,a as ii,u as it,b as dt,L as Zt,c as Or,R as nt,_ as Mt,N as oi,B as ai,d as si,e as rt}from"./vendor-1754043543625.js";import{C as li,a as ci,L as di,P as ui,b as pi,p as hi,c as gi,d as fi,e as mi}from"./charts-1754043543625.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=r(o);fetch(o.href,a)}})();var fn={exports:{}},er={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xi=S,yi=Symbol.for("react.element"),bi=Symbol.for("react.fragment"),wi=Object.prototype.hasOwnProperty,Si=xi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,vi={key:!0,ref:!0,__self:!0,__source:!0};function mn(t,e,r){var n,o={},a=null,s=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(s=e.ref);for(n in e)wi.call(e,n)&&!vi.hasOwnProperty(n)&&(o[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)o[n]===void 0&&(o[n]=e[n]);return{$$typeof:yi,type:t,key:a,ref:s,props:o,_owner:Si.current}}er.Fragment=bi;er.jsx=mn;er.jsxs=mn;fn.exports=er;var i=fn.exports,Sr={},Wr=ii;Sr.createRoot=Wr.createRoot,Sr.hydrateRoot=Wr.hydrateRoot;const ur=!1,Ci=()=>{const t=new Date,e=t.toTimeString().slice(0,8),r=t.getMilliseconds().toString().padStart(3,"0");return`${e}.${r}`},Di=t=>{const e=Ci();return typeof t=="string"?`[${e}] ${t}`:`[${e}]`},c={debug:(t,...e)=>{},info:(t,...e)=>{},warn:(t,...e)=>{},error:(t,...e)=>{console.error(Di(t),...e)},log:(t,...e)=>{},raw:{log:(...t)=>ur,warn:(...t)=>ur,error:(...t)=>console.error(...t),info:(...t)=>ur}};function vr(t,e,r,n="?",o=null){var y,C,A,R,Y;if(!Array.isArray(t)||t.length===0)return{startPoint:null,endPoint:null};const a=new Date,s={D:"D",W:"W",M:"M",Y:"Y",YTD:"YTD",MAX:"MAX"}[e]||e;let l;switch(s){case"D":l=new Date(a.getTime()-24*60*60*1e3),l.setHours(0,0,0,0),c.log(`üìÖ DAILY timeframe: Using previous day at midnight = ${l.toISOString()}`);break;case"W":l=new Date(a.getTime()-7*24*60*60*1e3),c.log(`üìÖ WEEKLY timeframe: Using 7 days ago = ${l.toISOString()}`);break;case"M":l=new Date(a.getTime()-30*24*60*60*1e3),c.log(`üìÖ MONTHLY timeframe: Using 30 days ago = ${l.toISOString()}`),c.log(`üìÖ MONTHLY timeframe: Today is ${a.toISOString()}, 30 days ago is ${l.toDateString()}`);break;case"Y":l=new Date(a.getTime()-365*24*60*60*1e3),c.log(`üìÖ YEARLY timeframe: Using 365 days ago = ${l.toISOString()}`);break;case"YTD":l=new Date(a.getFullYear(),0,1),c.log(`üìÖ YTD timeframe: Using Jan 1 = ${l.toISOString()}`);break;case"MAX":default:l=null}const d=new Date(r||((y=t[0])==null?void 0:y.timestamp)||a);let h,u;if(e==="MAX")if(h=d,o&&!isNaN(o))u=Number(o),c.log(`üìÖ MAX timeframe: Using provided buy price ${u} for ${n}`);else{const g=[...t].sort((E,_)=>new Date(E.timestamp)-new Date(_.timestamp)),P=f(g,h.getTime());u=((C=g[P])==null?void 0:C.price)||0,c.log(`üìÖ MAX timeframe: Using historical price ${u} from ${(A=g[P])==null?void 0:A.timestamp} for ${n} (closest to buy date ${d.toISOString()})`)}else if(e==="YTD"){const g=new Date(a.getFullYear(),0,1),P=g>d?g:d,E=[...t].sort((W,$)=>new Date(W.timestamp)-new Date($.timestamp)),_=E[0],U=new Date(_==null?void 0:_.timestamp);if(U<=P){h=P;const W=f(E,h.getTime());u=((R=E[W])==null?void 0:R.price)||0,g>d?c.log(`üìÖ YTD: Using Jan 1st ${g.toDateString()} ‚Üí price: ${u} for ${n} (buy date is older)`):c.log(`üìÖ YTD: Using buy date ${d.toDateString()} ‚Üí price: ${u} for ${n} (Jan 1st is before buy date)`)}else h=U,u=(_==null?void 0:_.price)||0,c.log(`üìÖ YTD: Effective start not available, using first data point ${U.toDateString()} ‚Üí price: ${u} for ${n}`)}else{h=l>d?l:d;const P=[...t].sort((_,U)=>new Date(_.timestamp)-new Date(U.timestamp)),E=f(P,h.getTime());u=((Y=P[E])==null?void 0:Y.price)||0,l>d?c.log(`üìÖ ${s}: Using timeframe start ${l.toISOString()} ‚Üí price: ${u} for ${n} (buy date is older)`):c.log(`üìÖ ${s}: Using buy date ${d.toISOString()} ‚Üí price: ${u} for ${n} (timeframe would go before buy date)`)}c.debug(`TIMEFRAME DEBUG ${n}: timeframe=${e}`),c.log(`üîç Buy date: ${d.toISOString()}`),c.log(`üîç Timeframe start: ${(l==null?void 0:l.toISOString())||"now"}`),c.log(`üîç Effective start: ${h.toISOString()}`),c.log(`üîç Start price: ${u}`);function f(g,P){let E=0,_=g.length-1,U=0,W=Math.abs(new Date(g[0].timestamp)-P);for(;E<=_;){const $=Math.floor((E+_)/2),I=new Date(g[$].timestamp).getTime(),q=Math.abs(I-P);if(q<W&&(W=q,U=$),I<P)E=$+1;else if(I>P)_=$-1;else return $}return U}let x=null,b=null;const k=[...t].sort((g,P)=>new Date(g.timestamp)-new Date(P.timestamp)),T=k[0],w=k[k.length-1];c.debug(`Data range for ${n}: ${T==null?void 0:T.timestamp} to ${w==null?void 0:w.timestamp}`);const v=f(k,h.getTime());if(x={...k[v],timestamp:h.toISOString(),price:u},b=k[k.length-1],c.debug(`Return calculation for ${n} (${e}):`),e==="MAX"?c.log(`‚úÖ Start: Buy date ${d.toISOString()} ‚Üí Buy Price: ${x.price}`):(c.log(`‚úÖ Buy date: ${d.toISOString()}`),c.log(`‚úÖ Timeframe start: ${(l==null?void 0:l.toISOString())||"now"}`),c.log(`‚úÖ Effective start: ${h.toISOString()} ‚Üí Price: ${x.price}`),h===d?c.log("‚úÖ Using buy date (more recent than timeframe start)"):c.log("‚úÖ Using timeframe start (buy date is older)")),c.log(`‚úÖ End: ${b==null?void 0:b.timestamp} ‚Üí Price: ${b==null?void 0:b.price}`),x&&b&&x.price&&b.price){const g=(b.price-x.price)/x.price*100;c.log(`‚úÖ Return: ${g.toFixed(2)}%`),c.debug(`DEBUG: startPoint.price=${x.price}, endPoint.price=${b.price}, difference=${b.price-x.price}`),c.debug(`TIMESTAMP DEBUG: startPoint.timestamp=${x.timestamp}, endPoint.timestamp=${b.timestamp}`)}return x?b?(c.log(`Filtered ${k.length} ‚Üí start = ${x==null?void 0:x.price} @ ${x==null?void 0:x.timestamp}, end = ${b==null?void 0:b.price} @ ${b==null?void 0:b.timestamp}, buyDate = ${d.toISOString()}`),{startPoint:x,endPoint:b}):(c.warn(`‚õî No valid endPoint found for ${n}`),{startPoint:null,endPoint:null}):(c.warn(`‚õî No valid startPoint found for ${n}`),{startPoint:null,endPoint:null})}const xn=S.createContext(),Hr="rgb(140,185,162)",ki="#8CB9A2",Vr="#e31507",pr="#000",Ai="#000000";function $i(t,e){if(!e)return t;const r=t.trim().toLowerCase();return r===pr||r===Ai||r==="black"||r.startsWith("rgb(0,0,0)")?Hr:r===Hr||r===ki||r.startsWith("rgb(140,185,162)")?pr:r===Vr?Vr:pr}function ji({children:t}){const[e,r]=S.useState(!1),n=()=>r(o=>!o);return i.jsx(xn.Provider,{value:{isInverted:e,toggleTheme:n},children:t})}function ut(){return S.useContext(xn)}function ne(t){const{isInverted:e}=ut();return $i(t,e)}class Ti{constructor(){this.maxDataPoints=100,this.cleanupDays=30}saveWatchlistDatapoint(e,r){try{const n=`burnlist_chart_data_${e}`;let o=JSON.parse(localStorage.getItem(n)||"[]");return o.push({timestamp:r.timestamp,averageReturn:r.averageReturn,tickerCount:r.tickerCount,fetchTimestamp:new Date().toISOString()}),o.length>this.maxDataPoints&&(o=o.slice(-this.maxDataPoints)),localStorage.setItem(n,JSON.stringify(o)),console.log(`üìä Saved watchlist datapoint for ${e}: ${r.averageReturn.toFixed(2)}% (${r.tickerCount} tickers)`),!0}catch(n){return console.error(`‚ùå Error saving watchlist datapoint for ${e}:`,n),!1}}getWatchlistChartData(e,r=100){try{const n=`burnlist_chart_data_${e}`;return JSON.parse(localStorage.getItem(n)||"[]").slice(-r)}catch(n){return console.error(`‚ùå Error getting chart data for ${e}:`,n),[]}}savePriceDatapoint(e,r){const{meta:n,values:o,status:a}=r;if(a!=="ok"||!o||o.length===0)return console.warn(`Invalid Twelve Data response for ${e}`),null;const s=o[0],l=this.convertTwelveDataDateTime(s.datetime,n.exchange_timezone);return{price:parseFloat(s.close),timestamp:l,fetchTimestamp:new Date().toISOString()}}updateTickerHistoricalData(e,r){try{const n=JSON.parse(localStorage.getItem("burnlist_watchlists")||"{}");let o=!1;return Object.values(n).forEach(a=>{if(a.items){const s=a.items.find(l=>l.symbol===e);s&&(s.historicalData||(s.historicalData=[]),s.historicalData.push(r),s.historicalData.length>this.maxDataPoints&&(s.historicalData=s.historicalData.slice(-this.maxDataPoints)),s.currentPrice=r.price,o=!0)}}),o&&(localStorage.setItem("burnlist_watchlists",JSON.stringify(n)),console.log(`üíæ Updated historical data for ${e} across all watchlists`)),o}catch(n){return console.error(`‚ùå Error updating historical data for ${e}:`,n),!1}}convertTwelveDataDateTime(e,r="America/New_York"){try{return new Date(e).toISOString()}catch(n){return console.error("Error converting datetime:",n),new Date().toISOString()}}getHistoricalData(e,r=100){try{const n=JSON.parse(localStorage.getItem("burnlist_watchlists")||"{}");for(const o of Object.values(n))if(o.items){const a=o.items.find(s=>s.symbol===e);if(a&&a.historicalData)return a.historicalData.slice(-r)}return[]}catch(n){return console.error(`‚ùå Error getting historical data for ${e}:`,n),[]}}calculateAverageReturn(e,r="1D"){try{const n=this.getHistoricalData(e);if(n.length<2)return null;const o=n[0],a=n[n.length-1];if(!o||!a)return null;const s=o.price,l=a.price;if(s<=0)return null;const d=(l-s)/s*100;return{symbol:e,startPrice:s,endPrice:l,returnPercent:d,timeframe:r,dataPoints:n.length}}catch(n){return console.error(`‚ùå Error calculating average return for ${e}:`,n),null}}cleanupOldData(){try{const e=JSON.parse(localStorage.getItem("burnlist_watchlists")||"{}"),r=new Date;r.setDate(r.getDate()-this.cleanupDays);let n=0;return Object.values(e).forEach(o=>{o.items&&o.items.forEach(a=>{if(a.historicalData){const s=a.historicalData.length;a.historicalData=a.historicalData.filter(l=>new Date(l.timestamp)>r),n+=s-a.historicalData.length}})}),n>0&&(localStorage.setItem("burnlist_watchlists",JSON.stringify(e)),console.log(`üßπ Cleaned up ${n} old datapoints`)),n}catch(e){return console.error("‚ùå Error cleaning up old data:",e),0}}getHistoricalDataStats(){try{const e=JSON.parse(localStorage.getItem("burnlist_watchlists")||"{}"),r={totalTickers:0,tickersWithHistoricalData:0,totalDataPoints:0,averageDataPointsPerTicker:0,oldestDataPoint:null,newestDataPoint:null};let n=Date.now(),o=0;return Object.values(e).forEach(a=>{a.items&&a.items.forEach(s=>{r.totalTickers++,s.historicalData&&s.historicalData.length>0&&(r.tickersWithHistoricalData++,r.totalDataPoints+=s.historicalData.length,s.historicalData.forEach(l=>{const d=new Date(l.timestamp).getTime();d<n&&(n=d,r.oldestDataPoint=l.timestamp),d>o&&(o=d,r.newestDataPoint=l.timestamp)}))})}),r.tickersWithHistoricalData>0&&(r.averageDataPointsPerTicker=Math.round(r.totalDataPoints/r.tickersWithHistoricalData)),r}catch(e){return console.error("‚ùå Error getting historical data stats:",e),null}}exportHistoricalData(){try{const e=JSON.parse(localStorage.getItem("burnlist_watchlists")||"{}"),r={timestamp:new Date().toISOString(),watchlists:{},stats:this.getHistoricalDataStats()};return Object.entries(e).forEach(([n,o])=>{r.watchlists[n]={name:o.name,slug:o.slug,items:o.items.map(a=>({symbol:a.symbol,buyPrice:a.buyPrice,buyDate:a.buyDate,historicalDataCount:a.historicalData?a.historicalData.length:0,historicalData:a.historicalData||[]}))}}),r}catch(e){return console.error("‚ùå Error exporting historical data:",e),null}}}const yn=new Ti;li.register(ci,di,ui,pi,hi,gi,fi);const Pi="rgb(140,185,162)",bn=({portfolioReturnData:t,watchlistSlug:e,height:r=300,showTooltip:n=!0,mini:o=!1,suppressEmptyMessage:a=!1})=>{const s=ne(Pi),l=ne("black");ne("#888");const d=S.useMemo(()=>{if(e){const U=yn.getWatchlistChartData(e);if(U.length>0)return c.debug(`üìä Using watchlist chart data for ${e}: ${U.length} datapoints`),U.map((W,$)=>({timestampValue:new Date(W.timestamp).getTime(),returnPercent:W.averageReturn,xIndex:$}));c.debug(`‚ö†Ô∏è No watchlist chart data found for ${e}, falling back to individual ticker data`)}if(!Array.isArray(t)||t.length===0)return[];c.debug(`üîç WatchlistChart: Processing ${t.length} portfolio entries`);const C=t.map(U=>{if(!U||!Array.isArray(U.historicalData)||U.historicalData.length===0)return c.debug("‚ö†Ô∏è Skipping entry with no historical data:",U),null;const{historicalData:W,buyDate:$,buyPrice:I,symbol:q,timeframe:H}=U;c.debug(`üîç Processing ${q}: ${W.length} historical points, timeframe: ${H}`);const z=[...W].sort((O,K)=>new Date(O.timestamp)-new Date(K.timestamp)),V=new Date(z[0].timestamp),ee=new Date(z[z.length-1].timestamp);c.debug(`üìÖ ${q} data range: ${V.toISOString()} to ${ee.toISOString()}`);const ge=$&&new Date($).toString()!=="Invalid Date"?$:null,{startPoint:ve,endPoint:ye}=vr(W,H,ge,q,I);if(!ve||!ye)return c.debug(`‚ö†Ô∏è No valid start/end points for ${q} in timeframe ${H}`),null;c.debug(`üîç ${q}: startPoint=${ve.timestamp}, endPoint=${ye.timestamp}`);const Ce=new Date(ve.timestamp).getTime(),Ie=new Date(ye.timestamp).getTime();let fe=W.filter(O=>{const K=new Date(O.timestamp).getTime();return K>=Ce&&K<=Ie}).map(O=>({...O,timestampValue:new Date(O.timestamp).getTime()}));return c.debug(`üîç ${q}: ${fe.length} points within timeframe (${Ce} to ${Ie})`),fe.length<=5&&c.debug(`üîç ${q} timestamps:`,fe.map(O=>new Date(O.timestamp).toISOString())),fe.length===0&&(console.warn(`‚ö†Ô∏è No points found for ${q} in timeframe ${H}!`),console.warn("‚ö†Ô∏è This could be why the chart line is not showing."),console.warn(`‚ö†Ô∏è Available data: ${W.length} points from ${V.toISOString()} to ${ee.toISOString()}`),console.warn(`‚ö†Ô∏è Requested timeframe: ${H} (start: ${new Date(Ce).toISOString()}, end: ${new Date(Ie).toISOString()})`),(H==="W"||H==="M")&&(console.warn(`üîç DEBUG: ${H} timeframe calculation:`),console.warn(`üîç - Buy date: ${ge}`),console.warn(`üîç - Start point: ${ve?ve.timestamp:"null"}`),console.warn(`üîç - End point: ${ye?ye.timestamp:"null"}`),console.warn(`üîç - Effective start: ${new Date(Ce).toISOString()}`),console.warn(`üîç - Effective end: ${new Date(Ie).toISOString()}`))),fe.length>0&&fe[0].timestampValue>Ce&&fe.unshift({...fe[0],timestamp:new Date(Ce).toISOString(),timestampValue:Ce,price:fe[0].price}),fe.length>0&&fe[fe.length-1].timestampValue<Ie&&fe.push({...fe[fe.length-1],timestamp:new Date(Ie).toISOString(),timestampValue:Ie,price:fe[fe.length-1].price}),{symbol:q,points:fe,timeframe:H,buyDate:$,buyPrice:I,startPoint:ve}}).filter(Boolean);if(C.length===0)return c.debug("‚ö†Ô∏è No valid sliced data found"),[];c.debug(`‚úÖ Sliced data: ${C.length} valid entries`);const A=Array.from(new Set(C.flatMap(U=>U.points.map(W=>W.timestampValue)))).sort((U,W)=>U-W);if(A.length===0)return c.debug("‚ö†Ô∏è No timestamps found after flattening"),[];c.debug(`üîç Total unique timestamps: ${A.length}`);const R=o?5:30,Y=A.length<=R?1:Math.floor(A.length/R),g=A.filter((U,W)=>W%Y===0);g[g.length-1]!==A[A.length-1]&&g.push(A[A.length-1]),c.debug(`üîç After downsampling: ${g.length} points`);const P=60*60*1e3;if(g.length<=5){c.debug(`üîç Very few timestamps (${g.length}), skipping time gap filtering`);const U=g;c.debug(`üîç Chart data processing: ${A.length} total timestamps ‚Üí ${g.length} sampled ‚Üí ${U.length} filtered`),U.length>0&&(c.debug(`üîç First timestamp: ${new Date(U[0]).toISOString()}`),c.debug(`üîç Last timestamp: ${new Date(U[U.length-1]).toISOString()}`));const W=U.map(($,I)=>{let q=0,H=0;C.forEach(V=>{if(!V.points||V.points.length===0){c.debug(`‚ö†Ô∏è Skipping ${V.symbol}: no valid points`);return}const ee=V.points.reduce((ge,ve)=>{const ye=Math.abs(ve.timestampValue-$),Ce=Math.abs(ge.timestampValue-$);return ye<Ce?ve:ge});if(ee&&ee.price>0){const ge=(ee.price-V.buyPrice)/V.buyPrice*100;Number.isFinite(ge)&&(q+=ge,H++)}});const z=H>0?q/H:0;return{timestampValue:$,returnPercent:z,xIndex:I}});return c.debug("Chart data points:",W),W}const E=[];for(let U=0;U<g.length;U++){const W=g[U],$=E[E.length-1];U===0||!$||W-$>=P?E.push(W):c.debug(`üîç Skipping close timestamp: ${new Date(W).toISOString()} (${Math.round((W-$)/1e3)}s after ${new Date($).toISOString()})`)}if(c.debug(`üîç Chart data processing: ${A.length} total timestamps ‚Üí ${g.length} sampled ‚Üí ${E.length} filtered`),E.length>0&&(c.debug(`üîç First timestamp: ${new Date(E[0]).toISOString()}`),c.debug(`üîç Last timestamp: ${new Date(E[E.length-1]).toISOString()}`)),E.length<3&&A.length>2)return c.debug(`‚ö†Ô∏è Too few points after filtering (${E.length}), using all timestamps`),A.map((U,W)=>{const $=C.map(q=>{const H=q.points.findIndex(ge=>ge.timestampValue>=U),z=H===-1?q.points[q.points.length-1]:q.points[H],V=q.startPoint;if(!V||!z||V.price===0)return 0;const ee=(z.price-V.price)/V.price*100;return Number.isFinite(ee)?ee:0}),I=$.length?$.reduce((q,H)=>q+H,0)/$.length:0;return{timestampValue:U,returnPercent:Number.isFinite(I)?I:0,xIndex:W}});if(E.length===0)return c.debug("‚ö†Ô∏è No valid timestamps found for chart data"),[];const _=E.map((U,W)=>{let $=0,I=0;C.forEach(H=>{if(!H.points||H.points.length===0){console.warn(`‚ö†Ô∏è Skipping ${H.symbol}: no valid points`);return}const z=H.points.reduce((V,ee)=>{const ge=Math.abs(ee.timestampValue-U),ve=Math.abs(V.timestampValue-U);return ge<ve?ee:V});if(z&&z.price>0){let V=0;if(W===0)V=0;else{const ee=H.points[0];ee&&ee.price>0&&(V=(z.price-ee.price)/ee.price*100)}Number.isFinite(V)&&($+=V,I++)}});const q=I>0?$/I:0;return{timestampValue:U,returnPercent:q,xIndex:W}});return c.debug("Chart data points:",_),_},[t,o,JSON.stringify(t.map(C=>({symbol:C.symbol,buyPrice:C.buyPrice,buyDate:C.buyDate,timeframe:C.timeframe})))]);if(!d||d.length===0)return a?null:i.jsx("div",{style:{textAlign:"center",padding:40,color:s,fontFamily:"'Courier New'",background:l},children:"No valid data to display yet."});const h=d.map((C,A)=>A),u=d.map(C=>C.returnPercent),f=d.map(C=>Number.isFinite(C.returnPercent)?C.returnPercent:0),x=Math.min(...f),b=Math.max(...f),k=b-x;let T,w;if(k===0){const C=x,A=Math.max(Math.abs(C)*.1,.5);T=C-A,w=C+A}else{const C=Math.max(k*.1,1);T=x-C,w=b+C}if(Math.abs(w-T)<2){const C=(w+T)/2;T=C-1,w=C+1}const v={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{enabled:n&&!o,mode:"index",intersect:!1,backgroundColor:"transparent",titleColor:s,bodyColor:s,borderColor:"transparent",borderWidth:0,displayColors:!1,titleFont:{family:"Courier New",size:12},bodyFont:{family:"Courier New",size:11},callbacks:{title:function(C){if(!C||!C[0])return"";const A=C[0].dataIndex,R=d[A];if(R&&R.timestampValue){const Y=new Date(R.timestampValue),g=String(Y.getDate()).padStart(2,"0"),P=String(Y.getMonth()+1).padStart(2,"0"),E=String(Y.getFullYear()).slice(-2),_=Y.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});return`${g}-${P}-${E} ${_}`}return""},label:function(C){if(!C||!C.parsed)return"";const A=C.parsed.y;return`Return: ${A>=0?"+":""}${A.toFixed(2)}%`},afterLabel:function(C){if(!C||!C[0])return"";const A=C[0].dataIndex,R=d[A];return R&&R.xIndex!==void 0?`Point ${R.xIndex+1}`:""}}}},scales:{x:{display:!o,grid:{display:!1},ticks:{display:!1},border:{display:!1}},y:{display:!o,grid:{display:!0,color:C=>C.tick.value===0?"rgba(140, 185, 162, 0.3)":"transparent",lineWidth:1},ticks:{display:!1,callback:function(C){return C===0?"0":""}},border:{display:!1},min:T,max:w}},elements:{point:{radius:0,hoverRadius:0,backgroundColor:s,borderColor:l,borderWidth:1},line:{borderColor:s,borderWidth:2,tension:.4}},interaction:{intersect:!1,mode:"index"}},y={labels:h,datasets:[{label:"Portfolio Return",data:u,borderColor:s,backgroundColor:s,fill:!1,tension:.4}]};return i.jsx("div",{style:{width:"100%",height:r,backgroundColor:"transparent",fontFamily:"Courier New",overflow:"hidden"},children:i.jsx(mi,{data:y,options:v})})},qr=["Today‚Äôs Edge","Quiet Capital","Simple Gains","Still Waters ETF","Monochrome Alpha","Code Zen","Tokyo Drift Fund","6AM Markets","Silent Buy-In","Whisper Equity","Margins & Moonlight","Espresso Exposure","The Black Candle","No Noise Holdings","White Line Risk","Bare NAV","Precision & Profit","N≈çnai Investment","Folded Capital","Ink Thin Margin","ETF Me Later","Bull Sheet","Bagholders Anonymous","Pump & Zen","2% Club","Fade the Fed","Just the Tip‚Ä¶ of the Chart","Buy High, Cry Later","Margin of Safety? Never Heard of Her","Quant & Furious","Diamond Hands Club","Degen Lite","Buffett‚Äôs Burner Wallet","Icarus Capital","Stoploss Therapy","Roaring Zen","YoloZen ETF","Theta Is My Safe Word","Long and Wrong","The Drawdown Diaries","Kintsugi Holdings","Ky≈ç Balance","Tanaka Trades","Nami (Wave) Fund","Kanjo Capital","Tora Volatility","Ky≈´ Capital","Nikkei Nights","Sumi Ink Index","Origami Alpha","404: Ticker Not Found","async(portfolio)","Fetching Gains‚Ä¶","The JSON Fund","SimuLedger","Web3Bois","Ctrl+Alt+Rebalance","LoFi Alpha","API or Die","Console.Log(Rich)","Fade","Wick","Drift","Latch","Fold","Snap","Bite","Risk","Ping","ZenVest","Dead Cat ETF","Rangebound AF","Opex Overload","Smart Beta Beta","Macro Micro Fund","CPI Szn","Taper Tears","FOMO Fund","Gensler‚Äôs Sandbox","Gamma Goblins","The Contrarian","The Ghost Trader","The Quiet Bull","The Daily Monk","The Candle Whisperer","The Macro Stoic","The Alpha Hermit","The Tape Reader","The Vol Addict","The Hedge Poet","Buy Buy Baby","NAVy Seals","Beta Males","Quants of Solitude","Emotional Damage Holdings","Mo‚Äô Money, No Backend","Risk Management-ish","All Weather-ish","Zero Day Holds","Return of the MACD"],Te=[];for(let t=0;t<256;++t)Te.push((t+256).toString(16).slice(1));function Ei(t,e=0){return(Te[t[e+0]]+Te[t[e+1]]+Te[t[e+2]]+Te[t[e+3]]+"-"+Te[t[e+4]]+Te[t[e+5]]+"-"+Te[t[e+6]]+Te[t[e+7]]+"-"+Te[t[e+8]]+Te[t[e+9]]+"-"+Te[t[e+10]]+Te[t[e+11]]+Te[t[e+12]]+Te[t[e+13]]+Te[t[e+14]]+Te[t[e+15]]).toLowerCase()}let hr;const Ni=new Uint8Array(16);function Ri(){if(!hr){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");hr=crypto.getRandomValues.bind(crypto)}return hr(Ni)}const Ii=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Jr={randomUUID:Ii};function Jt(t,e,r){var o;if(Jr.randomUUID&&!t)return Jr.randomUUID();t=t||{};const n=t.random??((o=t.rng)==null?void 0:o.call(t))??Ri();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,Ei(n)}function wn(t,e){return function(){return t.apply(e,arguments)}}const{toString:Oi}=Object.prototype,{getPrototypeOf:Fr}=Object,{iterator:tr,toStringTag:Sn}=Symbol,rr=(t=>e=>{const r=Oi.call(e);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Qe=t=>(t=t.toLowerCase(),e=>rr(e)===t),nr=t=>e=>typeof e===t,{isArray:bt}=Array,Et=nr("undefined");function Rt(t){return t!==null&&!Et(t)&&t.constructor!==null&&!Et(t.constructor)&&Ve(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const vn=Qe("ArrayBuffer");function Fi(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&vn(t.buffer),e}const Bi=nr("string"),Ve=nr("function"),Cn=nr("number"),It=t=>t!==null&&typeof t=="object",Mi=t=>t===!0||t===!1,Wt=t=>{if(rr(t)!=="object")return!1;const e=Fr(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Sn in t)&&!(tr in t)},Li=t=>{if(!It(t)||Rt(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},Ui=Qe("Date"),zi=Qe("File"),_i=Qe("Blob"),Wi=Qe("FileList"),Hi=t=>It(t)&&Ve(t.pipe),Vi=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Ve(t.append)&&((e=rr(t))==="formdata"||e==="object"&&Ve(t.toString)&&t.toString()==="[object FormData]"))},qi=Qe("URLSearchParams"),[Ji,Gi,Yi,Qi]=["ReadableStream","Request","Response","Headers"].map(Qe),Xi=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ot(t,e,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let n,o;if(typeof t!="object"&&(t=[t]),bt(t))for(n=0,o=t.length;n<o;n++)e.call(null,t[n],n,t);else{if(Rt(t))return;const a=r?Object.getOwnPropertyNames(t):Object.keys(t),s=a.length;let l;for(n=0;n<s;n++)l=a[n],e.call(null,t[l],l,t)}}function Dn(t,e){if(Rt(t))return null;e=e.toLowerCase();const r=Object.keys(t);let n=r.length,o;for(;n-- >0;)if(o=r[n],e===o.toLowerCase())return o;return null}const pt=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,kn=t=>!Et(t)&&t!==pt;function Cr(){const{caseless:t}=kn(this)&&this||{},e={},r=(n,o)=>{const a=t&&Dn(e,o)||o;Wt(e[a])&&Wt(n)?e[a]=Cr(e[a],n):Wt(n)?e[a]=Cr({},n):bt(n)?e[a]=n.slice():e[a]=n};for(let n=0,o=arguments.length;n<o;n++)arguments[n]&&Ot(arguments[n],r);return e}const Ki=(t,e,r,{allOwnKeys:n}={})=>(Ot(e,(o,a)=>{r&&Ve(o)?t[a]=wn(o,r):t[a]=o},{allOwnKeys:n}),t),Zi=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),eo=(t,e,r,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},to=(t,e,r,n)=>{let o,a,s;const l={};if(e=e||{},t==null)return e;do{for(o=Object.getOwnPropertyNames(t),a=o.length;a-- >0;)s=o[a],(!n||n(s,t,e))&&!l[s]&&(e[s]=t[s],l[s]=!0);t=r!==!1&&Fr(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},ro=(t,e,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=e.length;const n=t.indexOf(e,r);return n!==-1&&n===r},no=t=>{if(!t)return null;if(bt(t))return t;let e=t.length;if(!Cn(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},io=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&Fr(Uint8Array)),oo=(t,e)=>{const n=(t&&t[tr]).call(t);let o;for(;(o=n.next())&&!o.done;){const a=o.value;e.call(t,a[0],a[1])}},ao=(t,e)=>{let r;const n=[];for(;(r=t.exec(e))!==null;)n.push(r);return n},so=Qe("HTMLFormElement"),lo=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,o){return n.toUpperCase()+o}),Gr=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),co=Qe("RegExp"),An=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),n={};Ot(r,(o,a)=>{let s;(s=e(o,a,t))!==!1&&(n[a]=s||o)}),Object.defineProperties(t,n)},uo=t=>{An(t,(e,r)=>{if(Ve(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=t[r];if(Ve(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},po=(t,e)=>{const r={},n=o=>{o.forEach(a=>{r[a]=!0})};return bt(t)?n(t):n(String(t).split(e)),r},ho=()=>{},go=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function fo(t){return!!(t&&Ve(t.append)&&t[Sn]==="FormData"&&t[tr])}const mo=t=>{const e=new Array(10),r=(n,o)=>{if(It(n)){if(e.indexOf(n)>=0)return;if(Rt(n))return n;if(!("toJSON"in n)){e[o]=n;const a=bt(n)?[]:{};return Ot(n,(s,l)=>{const d=r(s,o+1);!Et(d)&&(a[l]=d)}),e[o]=void 0,a}}return n};return r(t,0)},xo=Qe("AsyncFunction"),yo=t=>t&&(It(t)||Ve(t))&&Ve(t.then)&&Ve(t.catch),$n=((t,e)=>t?setImmediate:e?((r,n)=>(pt.addEventListener("message",({source:o,data:a})=>{o===pt&&a===r&&n.length&&n.shift()()},!1),o=>{n.push(o),pt.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Ve(pt.postMessage)),bo=typeof queueMicrotask<"u"?queueMicrotask.bind(pt):typeof process<"u"&&process.nextTick||$n,wo=t=>t!=null&&Ve(t[tr]),D={isArray:bt,isArrayBuffer:vn,isBuffer:Rt,isFormData:Vi,isArrayBufferView:Fi,isString:Bi,isNumber:Cn,isBoolean:Mi,isObject:It,isPlainObject:Wt,isEmptyObject:Li,isReadableStream:Ji,isRequest:Gi,isResponse:Yi,isHeaders:Qi,isUndefined:Et,isDate:Ui,isFile:zi,isBlob:_i,isRegExp:co,isFunction:Ve,isStream:Hi,isURLSearchParams:qi,isTypedArray:io,isFileList:Wi,forEach:Ot,merge:Cr,extend:Ki,trim:Xi,stripBOM:Zi,inherits:eo,toFlatObject:to,kindOf:rr,kindOfTest:Qe,endsWith:ro,toArray:no,forEachEntry:oo,matchAll:ao,isHTMLForm:so,hasOwnProperty:Gr,hasOwnProp:Gr,reduceDescriptors:An,freezeMethods:uo,toObjectSet:po,toCamelCase:lo,noop:ho,toFiniteNumber:go,findKey:Dn,global:pt,isContextDefined:kn,isSpecCompliantForm:fo,toJSONObject:mo,isAsyncFn:xo,isThenable:yo,setImmediate:$n,asap:bo,isIterable:wo};function oe(t,e,r,n,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),n&&(this.request=n),o&&(this.response=o,this.status=o.status?o.status:null)}D.inherits(oe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:D.toJSONObject(this.config),code:this.code,status:this.status}}});const jn=oe.prototype,Tn={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Tn[t]={value:t}});Object.defineProperties(oe,Tn);Object.defineProperty(jn,"isAxiosError",{value:!0});oe.from=(t,e,r,n,o,a)=>{const s=Object.create(jn);return D.toFlatObject(t,s,function(d){return d!==Error.prototype},l=>l!=="isAxiosError"),oe.call(s,t.message,e,r,n,o),s.cause=t,s.name=t.name,a&&Object.assign(s,a),s};const So=null;function Dr(t){return D.isPlainObject(t)||D.isArray(t)}function Pn(t){return D.endsWith(t,"[]")?t.slice(0,-2):t}function Yr(t,e,r){return t?t.concat(e).map(function(o,a){return o=Pn(o),!r&&a?"["+o+"]":o}).join(r?".":""):e}function vo(t){return D.isArray(t)&&!t.some(Dr)}const Co=D.toFlatObject(D,{},null,function(e){return/^is[A-Z]/.test(e)});function ir(t,e,r){if(!D.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,r=D.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(T,w){return!D.isUndefined(w[T])});const n=r.metaTokens,o=r.visitor||u,a=r.dots,s=r.indexes,d=(r.Blob||typeof Blob<"u"&&Blob)&&D.isSpecCompliantForm(e);if(!D.isFunction(o))throw new TypeError("visitor must be a function");function h(k){if(k===null)return"";if(D.isDate(k))return k.toISOString();if(D.isBoolean(k))return k.toString();if(!d&&D.isBlob(k))throw new oe("Blob is not supported. Use a Buffer instead.");return D.isArrayBuffer(k)||D.isTypedArray(k)?d&&typeof Blob=="function"?new Blob([k]):Buffer.from(k):k}function u(k,T,w){let v=k;if(k&&!w&&typeof k=="object"){if(D.endsWith(T,"{}"))T=n?T:T.slice(0,-2),k=JSON.stringify(k);else if(D.isArray(k)&&vo(k)||(D.isFileList(k)||D.endsWith(T,"[]"))&&(v=D.toArray(k)))return T=Pn(T),v.forEach(function(C,A){!(D.isUndefined(C)||C===null)&&e.append(s===!0?Yr([T],A,a):s===null?T:T+"[]",h(C))}),!1}return Dr(k)?!0:(e.append(Yr(w,T,a),h(k)),!1)}const f=[],x=Object.assign(Co,{defaultVisitor:u,convertValue:h,isVisitable:Dr});function b(k,T){if(!D.isUndefined(k)){if(f.indexOf(k)!==-1)throw Error("Circular reference detected in "+T.join("."));f.push(k),D.forEach(k,function(v,y){(!(D.isUndefined(v)||v===null)&&o.call(e,v,D.isString(y)?y.trim():y,T,x))===!0&&b(v,T?T.concat(y):[y])}),f.pop()}}if(!D.isObject(t))throw new TypeError("data must be an object");return b(t),e}function Qr(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function Br(t,e){this._pairs=[],t&&ir(t,this,e)}const En=Br.prototype;En.append=function(e,r){this._pairs.push([e,r])};En.toString=function(e){const r=e?function(n){return e.call(this,n,Qr)}:Qr;return this._pairs.map(function(o){return r(o[0])+"="+r(o[1])},"").join("&")};function Do(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Nn(t,e,r){if(!e)return t;const n=r&&r.encode||Do;D.isFunction(r)&&(r={serialize:r});const o=r&&r.serialize;let a;if(o?a=o(e,r):a=D.isURLSearchParams(e)?e.toString():new Br(e,r).toString(n),a){const s=t.indexOf("#");s!==-1&&(t=t.slice(0,s)),t+=(t.indexOf("?")===-1?"?":"&")+a}return t}class Xr{constructor(){this.handlers=[]}use(e,r,n){return this.handlers.push({fulfilled:e,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){D.forEach(this.handlers,function(n){n!==null&&e(n)})}}const Rn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ko=typeof URLSearchParams<"u"?URLSearchParams:Br,Ao=typeof FormData<"u"?FormData:null,$o=typeof Blob<"u"?Blob:null,jo={isBrowser:!0,classes:{URLSearchParams:ko,FormData:Ao,Blob:$o},protocols:["http","https","file","blob","url","data"]},Mr=typeof window<"u"&&typeof document<"u",kr=typeof navigator=="object"&&navigator||void 0,To=Mr&&(!kr||["ReactNative","NativeScript","NS"].indexOf(kr.product)<0),Po=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Eo=Mr&&window.location.href||"http://localhost",No=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Mr,hasStandardBrowserEnv:To,hasStandardBrowserWebWorkerEnv:Po,navigator:kr,origin:Eo},Symbol.toStringTag,{value:"Module"})),Re={...No,...jo};function Ro(t,e){return ir(t,new Re.classes.URLSearchParams,{visitor:function(r,n,o,a){return Re.isNode&&D.isBuffer(r)?(this.append(n,r.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...e})}function Io(t){return D.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Oo(t){const e={},r=Object.keys(t);let n;const o=r.length;let a;for(n=0;n<o;n++)a=r[n],e[a]=t[a];return e}function In(t){function e(r,n,o,a){let s=r[a++];if(s==="__proto__")return!0;const l=Number.isFinite(+s),d=a>=r.length;return s=!s&&D.isArray(o)?o.length:s,d?(D.hasOwnProp(o,s)?o[s]=[o[s],n]:o[s]=n,!l):((!o[s]||!D.isObject(o[s]))&&(o[s]=[]),e(r,n,o[s],a)&&D.isArray(o[s])&&(o[s]=Oo(o[s])),!l)}if(D.isFormData(t)&&D.isFunction(t.entries)){const r={};return D.forEachEntry(t,(n,o)=>{e(Io(n),o,r,0)}),r}return null}function Fo(t,e,r){if(D.isString(t))try{return(e||JSON.parse)(t),D.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(t)}const Ft={transitional:Rn,adapter:["xhr","http","fetch"],transformRequest:[function(e,r){const n=r.getContentType()||"",o=n.indexOf("application/json")>-1,a=D.isObject(e);if(a&&D.isHTMLForm(e)&&(e=new FormData(e)),D.isFormData(e))return o?JSON.stringify(In(e)):e;if(D.isArrayBuffer(e)||D.isBuffer(e)||D.isStream(e)||D.isFile(e)||D.isBlob(e)||D.isReadableStream(e))return e;if(D.isArrayBufferView(e))return e.buffer;if(D.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Ro(e,this.formSerializer).toString();if((l=D.isFileList(e))||n.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return ir(l?{"files[]":e}:e,d&&new d,this.formSerializer)}}return a||o?(r.setContentType("application/json",!1),Fo(e)):e}],transformResponse:[function(e){const r=this.transitional||Ft.transitional,n=r&&r.forcedJSONParsing,o=this.responseType==="json";if(D.isResponse(e)||D.isReadableStream(e))return e;if(e&&D.isString(e)&&(n&&!this.responseType||o)){const s=!(r&&r.silentJSONParsing)&&o;try{return JSON.parse(e)}catch(l){if(s)throw l.name==="SyntaxError"?oe.from(l,oe.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Re.classes.FormData,Blob:Re.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};D.forEach(["delete","get","head","post","put","patch"],t=>{Ft.headers[t]={}});const Bo=D.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Mo=t=>{const e={};let r,n,o;return t&&t.split(`
`).forEach(function(s){o=s.indexOf(":"),r=s.substring(0,o).trim().toLowerCase(),n=s.substring(o+1).trim(),!(!r||e[r]&&Bo[r])&&(r==="set-cookie"?e[r]?e[r].push(n):e[r]=[n]:e[r]=e[r]?e[r]+", "+n:n)}),e},Kr=Symbol("internals");function At(t){return t&&String(t).trim().toLowerCase()}function Ht(t){return t===!1||t==null?t:D.isArray(t)?t.map(Ht):String(t)}function Lo(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(t);)e[n[1]]=n[2];return e}const Uo=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function gr(t,e,r,n,o){if(D.isFunction(n))return n.call(this,e,r);if(o&&(e=r),!!D.isString(e)){if(D.isString(n))return e.indexOf(n)!==-1;if(D.isRegExp(n))return n.test(e)}}function zo(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,n)=>r.toUpperCase()+n)}function _o(t,e){const r=D.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+r,{value:function(o,a,s){return this[n].call(this,e,o,a,s)},configurable:!0})})}let qe=class{constructor(e){e&&this.set(e)}set(e,r,n){const o=this;function a(l,d,h){const u=At(d);if(!u)throw new Error("header name must be a non-empty string");const f=D.findKey(o,u);(!f||o[f]===void 0||h===!0||h===void 0&&o[f]!==!1)&&(o[f||d]=Ht(l))}const s=(l,d)=>D.forEach(l,(h,u)=>a(h,u,d));if(D.isPlainObject(e)||e instanceof this.constructor)s(e,r);else if(D.isString(e)&&(e=e.trim())&&!Uo(e))s(Mo(e),r);else if(D.isObject(e)&&D.isIterable(e)){let l={},d,h;for(const u of e){if(!D.isArray(u))throw TypeError("Object iterator must return a key-value pair");l[h=u[0]]=(d=l[h])?D.isArray(d)?[...d,u[1]]:[d,u[1]]:u[1]}s(l,r)}else e!=null&&a(r,e,n);return this}get(e,r){if(e=At(e),e){const n=D.findKey(this,e);if(n){const o=this[n];if(!r)return o;if(r===!0)return Lo(o);if(D.isFunction(r))return r.call(this,o,n);if(D.isRegExp(r))return r.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=At(e),e){const n=D.findKey(this,e);return!!(n&&this[n]!==void 0&&(!r||gr(this,this[n],n,r)))}return!1}delete(e,r){const n=this;let o=!1;function a(s){if(s=At(s),s){const l=D.findKey(n,s);l&&(!r||gr(n,n[l],l,r))&&(delete n[l],o=!0)}}return D.isArray(e)?e.forEach(a):a(e),o}clear(e){const r=Object.keys(this);let n=r.length,o=!1;for(;n--;){const a=r[n];(!e||gr(this,this[a],a,e,!0))&&(delete this[a],o=!0)}return o}normalize(e){const r=this,n={};return D.forEach(this,(o,a)=>{const s=D.findKey(n,a);if(s){r[s]=Ht(o),delete r[a];return}const l=e?zo(a):String(a).trim();l!==a&&delete r[a],r[l]=Ht(o),n[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const r=Object.create(null);return D.forEach(this,(n,o)=>{n!=null&&n!==!1&&(r[o]=e&&D.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){const n=new this(e);return r.forEach(o=>n.set(o)),n}static accessor(e){const n=(this[Kr]=this[Kr]={accessors:{}}).accessors,o=this.prototype;function a(s){const l=At(s);n[l]||(_o(o,s),n[l]=!0)}return D.isArray(e)?e.forEach(a):a(e),this}};qe.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);D.reduceDescriptors(qe.prototype,({value:t},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(n){this[r]=n}}});D.freezeMethods(qe);function fr(t,e){const r=this||Ft,n=e||r,o=qe.from(n.headers);let a=n.data;return D.forEach(t,function(l){a=l.call(r,a,o.normalize(),e?e.status:void 0)}),o.normalize(),a}function On(t){return!!(t&&t.__CANCEL__)}function wt(t,e,r){oe.call(this,t??"canceled",oe.ERR_CANCELED,e,r),this.name="CanceledError"}D.inherits(wt,oe,{__CANCEL__:!0});function Fn(t,e,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?t(r):e(new oe("Request failed with status code "+r.status,[oe.ERR_BAD_REQUEST,oe.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Wo(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function Ho(t,e){t=t||10;const r=new Array(t),n=new Array(t);let o=0,a=0,s;return e=e!==void 0?e:1e3,function(d){const h=Date.now(),u=n[a];s||(s=h),r[o]=d,n[o]=h;let f=a,x=0;for(;f!==o;)x+=r[f++],f=f%t;if(o=(o+1)%t,o===a&&(a=(a+1)%t),h-s<e)return;const b=u&&h-u;return b?Math.round(x*1e3/b):void 0}}function Vo(t,e){let r=0,n=1e3/e,o,a;const s=(h,u=Date.now())=>{r=u,o=null,a&&(clearTimeout(a),a=null),t(...h)};return[(...h)=>{const u=Date.now(),f=u-r;f>=n?s(h,u):(o=h,a||(a=setTimeout(()=>{a=null,s(o)},n-f)))},()=>o&&s(o)]}const Gt=(t,e,r=3)=>{let n=0;const o=Ho(50,250);return Vo(a=>{const s=a.loaded,l=a.lengthComputable?a.total:void 0,d=s-n,h=o(d),u=s<=l;n=s;const f={loaded:s,total:l,progress:l?s/l:void 0,bytes:d,rate:h||void 0,estimated:h&&l&&u?(l-s)/h:void 0,event:a,lengthComputable:l!=null,[e?"download":"upload"]:!0};t(f)},r)},Zr=(t,e)=>{const r=t!=null;return[n=>e[0]({lengthComputable:r,total:t,loaded:n}),e[1]]},en=t=>(...e)=>D.asap(()=>t(...e)),qo=Re.hasStandardBrowserEnv?((t,e)=>r=>(r=new URL(r,Re.origin),t.protocol===r.protocol&&t.host===r.host&&(e||t.port===r.port)))(new URL(Re.origin),Re.navigator&&/(msie|trident)/i.test(Re.navigator.userAgent)):()=>!0,Jo=Re.hasStandardBrowserEnv?{write(t,e,r,n,o,a){const s=[t+"="+encodeURIComponent(e)];D.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),D.isString(n)&&s.push("path="+n),D.isString(o)&&s.push("domain="+o),a===!0&&s.push("secure"),document.cookie=s.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Go(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Yo(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function Bn(t,e,r){let n=!Go(e);return t&&(n||r==!1)?Yo(t,e):e}const tn=t=>t instanceof qe?{...t}:t;function gt(t,e){e=e||{};const r={};function n(h,u,f,x){return D.isPlainObject(h)&&D.isPlainObject(u)?D.merge.call({caseless:x},h,u):D.isPlainObject(u)?D.merge({},u):D.isArray(u)?u.slice():u}function o(h,u,f,x){if(D.isUndefined(u)){if(!D.isUndefined(h))return n(void 0,h,f,x)}else return n(h,u,f,x)}function a(h,u){if(!D.isUndefined(u))return n(void 0,u)}function s(h,u){if(D.isUndefined(u)){if(!D.isUndefined(h))return n(void 0,h)}else return n(void 0,u)}function l(h,u,f){if(f in e)return n(h,u);if(f in t)return n(void 0,h)}const d={url:a,method:a,data:a,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:l,headers:(h,u,f)=>o(tn(h),tn(u),f,!0)};return D.forEach(Object.keys({...t,...e}),function(u){const f=d[u]||o,x=f(t[u],e[u],u);D.isUndefined(x)&&f!==l||(r[u]=x)}),r}const Mn=t=>{const e=gt({},t);let{data:r,withXSRFToken:n,xsrfHeaderName:o,xsrfCookieName:a,headers:s,auth:l}=e;e.headers=s=qe.from(s),e.url=Nn(Bn(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),l&&s.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let d;if(D.isFormData(r)){if(Re.hasStandardBrowserEnv||Re.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if((d=s.getContentType())!==!1){const[h,...u]=d?d.split(";").map(f=>f.trim()).filter(Boolean):[];s.setContentType([h||"multipart/form-data",...u].join("; "))}}if(Re.hasStandardBrowserEnv&&(n&&D.isFunction(n)&&(n=n(e)),n||n!==!1&&qo(e.url))){const h=o&&a&&Jo.read(a);h&&s.set(o,h)}return e},Qo=typeof XMLHttpRequest<"u",Xo=Qo&&function(t){return new Promise(function(r,n){const o=Mn(t);let a=o.data;const s=qe.from(o.headers).normalize();let{responseType:l,onUploadProgress:d,onDownloadProgress:h}=o,u,f,x,b,k;function T(){b&&b(),k&&k(),o.cancelToken&&o.cancelToken.unsubscribe(u),o.signal&&o.signal.removeEventListener("abort",u)}let w=new XMLHttpRequest;w.open(o.method.toUpperCase(),o.url,!0),w.timeout=o.timeout;function v(){if(!w)return;const C=qe.from("getAllResponseHeaders"in w&&w.getAllResponseHeaders()),R={data:!l||l==="text"||l==="json"?w.responseText:w.response,status:w.status,statusText:w.statusText,headers:C,config:t,request:w};Fn(function(g){r(g),T()},function(g){n(g),T()},R),w=null}"onloadend"in w?w.onloadend=v:w.onreadystatechange=function(){!w||w.readyState!==4||w.status===0&&!(w.responseURL&&w.responseURL.indexOf("file:")===0)||setTimeout(v)},w.onabort=function(){w&&(n(new oe("Request aborted",oe.ECONNABORTED,t,w)),w=null)},w.onerror=function(){n(new oe("Network Error",oe.ERR_NETWORK,t,w)),w=null},w.ontimeout=function(){let A=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const R=o.transitional||Rn;o.timeoutErrorMessage&&(A=o.timeoutErrorMessage),n(new oe(A,R.clarifyTimeoutError?oe.ETIMEDOUT:oe.ECONNABORTED,t,w)),w=null},a===void 0&&s.setContentType(null),"setRequestHeader"in w&&D.forEach(s.toJSON(),function(A,R){w.setRequestHeader(R,A)}),D.isUndefined(o.withCredentials)||(w.withCredentials=!!o.withCredentials),l&&l!=="json"&&(w.responseType=o.responseType),h&&([x,k]=Gt(h,!0),w.addEventListener("progress",x)),d&&w.upload&&([f,b]=Gt(d),w.upload.addEventListener("progress",f),w.upload.addEventListener("loadend",b)),(o.cancelToken||o.signal)&&(u=C=>{w&&(n(!C||C.type?new wt(null,t,w):C),w.abort(),w=null)},o.cancelToken&&o.cancelToken.subscribe(u),o.signal&&(o.signal.aborted?u():o.signal.addEventListener("abort",u)));const y=Wo(o.url);if(y&&Re.protocols.indexOf(y)===-1){n(new oe("Unsupported protocol "+y+":",oe.ERR_BAD_REQUEST,t));return}w.send(a||null)})},Ko=(t,e)=>{const{length:r}=t=t?t.filter(Boolean):[];if(e||r){let n=new AbortController,o;const a=function(h){if(!o){o=!0,l();const u=h instanceof Error?h:this.reason;n.abort(u instanceof oe?u:new wt(u instanceof Error?u.message:u))}};let s=e&&setTimeout(()=>{s=null,a(new oe(`timeout ${e} of ms exceeded`,oe.ETIMEDOUT))},e);const l=()=>{t&&(s&&clearTimeout(s),s=null,t.forEach(h=>{h.unsubscribe?h.unsubscribe(a):h.removeEventListener("abort",a)}),t=null)};t.forEach(h=>h.addEventListener("abort",a));const{signal:d}=n;return d.unsubscribe=()=>D.asap(l),d}},Zo=function*(t,e){let r=t.byteLength;if(r<e){yield t;return}let n=0,o;for(;n<r;)o=n+e,yield t.slice(n,o),n=o},ea=async function*(t,e){for await(const r of ta(t))yield*Zo(r,e)},ta=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:r,value:n}=await e.read();if(r)break;yield n}}finally{await e.cancel()}},rn=(t,e,r,n)=>{const o=ea(t,e);let a=0,s,l=d=>{s||(s=!0,n&&n(d))};return new ReadableStream({async pull(d){try{const{done:h,value:u}=await o.next();if(h){l(),d.close();return}let f=u.byteLength;if(r){let x=a+=f;r(x)}d.enqueue(new Uint8Array(u))}catch(h){throw l(h),h}},cancel(d){return l(d),o.return()}},{highWaterMark:2})},or=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Ln=or&&typeof ReadableStream=="function",ra=or&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),Un=(t,...e)=>{try{return!!t(...e)}catch{return!1}},na=Ln&&Un(()=>{let t=!1;const e=new Request(Re.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),nn=64*1024,Ar=Ln&&Un(()=>D.isReadableStream(new Response("").body)),Yt={stream:Ar&&(t=>t.body)};or&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Yt[e]&&(Yt[e]=D.isFunction(t[e])?r=>r[e]():(r,n)=>{throw new oe(`Response type '${e}' is not supported`,oe.ERR_NOT_SUPPORT,n)})})})(new Response);const ia=async t=>{if(t==null)return 0;if(D.isBlob(t))return t.size;if(D.isSpecCompliantForm(t))return(await new Request(Re.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(D.isArrayBufferView(t)||D.isArrayBuffer(t))return t.byteLength;if(D.isURLSearchParams(t)&&(t=t+""),D.isString(t))return(await ra(t)).byteLength},oa=async(t,e)=>{const r=D.toFiniteNumber(t.getContentLength());return r??ia(e)},aa=or&&(async t=>{let{url:e,method:r,data:n,signal:o,cancelToken:a,timeout:s,onDownloadProgress:l,onUploadProgress:d,responseType:h,headers:u,withCredentials:f="same-origin",fetchOptions:x}=Mn(t);h=h?(h+"").toLowerCase():"text";let b=Ko([o,a&&a.toAbortSignal()],s),k;const T=b&&b.unsubscribe&&(()=>{b.unsubscribe()});let w;try{if(d&&na&&r!=="get"&&r!=="head"&&(w=await oa(u,n))!==0){let R=new Request(e,{method:"POST",body:n,duplex:"half"}),Y;if(D.isFormData(n)&&(Y=R.headers.get("content-type"))&&u.setContentType(Y),R.body){const[g,P]=Zr(w,Gt(en(d)));n=rn(R.body,nn,g,P)}}D.isString(f)||(f=f?"include":"omit");const v="credentials"in Request.prototype;k=new Request(e,{...x,signal:b,method:r.toUpperCase(),headers:u.normalize().toJSON(),body:n,duplex:"half",credentials:v?f:void 0});let y=await fetch(k,x);const C=Ar&&(h==="stream"||h==="response");if(Ar&&(l||C&&T)){const R={};["status","statusText","headers"].forEach(E=>{R[E]=y[E]});const Y=D.toFiniteNumber(y.headers.get("content-length")),[g,P]=l&&Zr(Y,Gt(en(l),!0))||[];y=new Response(rn(y.body,nn,g,()=>{P&&P(),T&&T()}),R)}h=h||"text";let A=await Yt[D.findKey(Yt,h)||"text"](y,t);return!C&&T&&T(),await new Promise((R,Y)=>{Fn(R,Y,{data:A,headers:qe.from(y.headers),status:y.status,statusText:y.statusText,config:t,request:k})})}catch(v){throw T&&T(),v&&v.name==="TypeError"&&/Load failed|fetch/i.test(v.message)?Object.assign(new oe("Network Error",oe.ERR_NETWORK,t,k),{cause:v.cause||v}):oe.from(v,v&&v.code,t,k)}}),$r={http:So,xhr:Xo,fetch:aa};D.forEach($r,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const on=t=>`- ${t}`,sa=t=>D.isFunction(t)||t===null||t===!1,zn={getAdapter:t=>{t=D.isArray(t)?t:[t];const{length:e}=t;let r,n;const o={};for(let a=0;a<e;a++){r=t[a];let s;if(n=r,!sa(r)&&(n=$r[(s=String(r)).toLowerCase()],n===void 0))throw new oe(`Unknown adapter '${s}'`);if(n)break;o[s||"#"+a]=n}if(!n){const a=Object.entries(o).map(([l,d])=>`adapter ${l} `+(d===!1?"is not supported by the environment":"is not available in the build"));let s=e?a.length>1?`since :
`+a.map(on).join(`
`):" "+on(a[0]):"as no adapter specified";throw new oe("There is no suitable adapter to dispatch the request "+s,"ERR_NOT_SUPPORT")}return n},adapters:$r};function mr(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new wt(null,t)}function an(t){return mr(t),t.headers=qe.from(t.headers),t.data=fr.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),zn.getAdapter(t.adapter||Ft.adapter)(t).then(function(n){return mr(t),n.data=fr.call(t,t.transformResponse,n),n.headers=qe.from(n.headers),n},function(n){return On(n)||(mr(t),n&&n.response&&(n.response.data=fr.call(t,t.transformResponse,n.response),n.response.headers=qe.from(n.response.headers))),Promise.reject(n)})}const _n="1.11.0",ar={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{ar[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const sn={};ar.transitional=function(e,r,n){function o(a,s){return"[Axios v"+_n+"] Transitional option '"+a+"'"+s+(n?". "+n:"")}return(a,s,l)=>{if(e===!1)throw new oe(o(s," has been removed"+(r?" in "+r:"")),oe.ERR_DEPRECATED);return r&&!sn[s]&&(sn[s]=!0,console.warn(o(s," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(a,s,l):!0}};ar.spelling=function(e){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function la(t,e,r){if(typeof t!="object")throw new oe("options must be an object",oe.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let o=n.length;for(;o-- >0;){const a=n[o],s=e[a];if(s){const l=t[a],d=l===void 0||s(l,a,t);if(d!==!0)throw new oe("option "+a+" must be "+d,oe.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new oe("Unknown option "+a,oe.ERR_BAD_OPTION)}}const Vt={assertOptions:la,validators:ar},Ze=Vt.validators;let ht=class{constructor(e){this.defaults=e||{},this.interceptors={request:new Xr,response:new Xr}}async request(e,r){try{return await this._request(e,r)}catch(n){if(n instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const a=o.stack?o.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=gt(this.defaults,r);const{transitional:n,paramsSerializer:o,headers:a}=r;n!==void 0&&Vt.assertOptions(n,{silentJSONParsing:Ze.transitional(Ze.boolean),forcedJSONParsing:Ze.transitional(Ze.boolean),clarifyTimeoutError:Ze.transitional(Ze.boolean)},!1),o!=null&&(D.isFunction(o)?r.paramsSerializer={serialize:o}:Vt.assertOptions(o,{encode:Ze.function,serialize:Ze.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Vt.assertOptions(r,{baseUrl:Ze.spelling("baseURL"),withXsrfToken:Ze.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let s=a&&D.merge(a.common,a[r.method]);a&&D.forEach(["delete","get","head","post","put","patch","common"],k=>{delete a[k]}),r.headers=qe.concat(s,a);const l=[];let d=!0;this.interceptors.request.forEach(function(T){typeof T.runWhen=="function"&&T.runWhen(r)===!1||(d=d&&T.synchronous,l.unshift(T.fulfilled,T.rejected))});const h=[];this.interceptors.response.forEach(function(T){h.push(T.fulfilled,T.rejected)});let u,f=0,x;if(!d){const k=[an.bind(this),void 0];for(k.unshift(...l),k.push(...h),x=k.length,u=Promise.resolve(r);f<x;)u=u.then(k[f++],k[f++]);return u}x=l.length;let b=r;for(f=0;f<x;){const k=l[f++],T=l[f++];try{b=k(b)}catch(w){T.call(this,w);break}}try{u=an.call(this,b)}catch(k){return Promise.reject(k)}for(f=0,x=h.length;f<x;)u=u.then(h[f++],h[f++]);return u}getUri(e){e=gt(this.defaults,e);const r=Bn(e.baseURL,e.url,e.allowAbsoluteUrls);return Nn(r,e.params,e.paramsSerializer)}};D.forEach(["delete","get","head","options"],function(e){ht.prototype[e]=function(r,n){return this.request(gt(n||{},{method:e,url:r,data:(n||{}).data}))}});D.forEach(["post","put","patch"],function(e){function r(n){return function(a,s,l){return this.request(gt(l||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:s}))}}ht.prototype[e]=r(),ht.prototype[e+"Form"]=r(!0)});let ca=class Wn{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(a){r=a});const n=this;this.promise.then(o=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](o);n._listeners=null}),this.promise.then=o=>{let a;const s=new Promise(l=>{n.subscribe(l),a=l}).then(o);return s.cancel=function(){n.unsubscribe(a)},s},e(function(a,s,l){n.reason||(n.reason=new wt(a,s,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const e=new AbortController,r=n=>{e.abort(n)};return this.subscribe(r),e.signal.unsubscribe=()=>this.unsubscribe(r),e.signal}static source(){let e;return{token:new Wn(function(o){e=o}),cancel:e}}};function da(t){return function(r){return t.apply(null,r)}}function ua(t){return D.isObject(t)&&t.isAxiosError===!0}const jr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(jr).forEach(([t,e])=>{jr[e]=t});function Hn(t){const e=new ht(t),r=wn(ht.prototype.request,e);return D.extend(r,ht.prototype,e,{allOwnKeys:!0}),D.extend(r,e,null,{allOwnKeys:!0}),r.create=function(o){return Hn(gt(t,o))},r}const he=Hn(Ft);he.Axios=ht;he.CanceledError=wt;he.CancelToken=ca;he.isCancel=On;he.VERSION=_n;he.toFormData=ir;he.AxiosError=oe;he.Cancel=he.CanceledError;he.all=function(e){return Promise.all(e)};he.spread=da;he.isAxiosError=ua;he.mergeConfig=gt;he.AxiosHeaders=qe;he.formToJSON=t=>In(D.isHTMLForm(t)?new FormData(t):t);he.getAdapter=zn.getAdapter;he.HttpStatusCode=jr;he.default=he;const{Axios:Ls,AxiosError:Us,CanceledError:zs,isCancel:_s,CancelToken:Ws,VERSION:Hs,all:Vs,Cancel:qs,isAxiosError:Js,spread:Gs,toFormData:Ys,AxiosHeaders:Qs,HttpStatusCode:Xs,formToJSON:Ks,getAdapter:Zs,mergeConfig:el}=he,Lr="/api";function Vn(t){return{d:"1day",w:"1week",m:"1month","1min":"1min","5min":"5min","15min":"15min","30min":"30min","1h":"1h","1day":"1day","1week":"1week","1month":"1month"}[t]||"1min"}async function pa(t,e="1min"){try{t=t.toUpperCase();const r=Vn(e),n=`${Lr}/twelvedata-quote?symbols=${t}&interval=${r}`;c.info(`üåê Requesting Twelve Data quote for symbol: ${t} (interval: ${r}, original timeframe: ${e})`);const a=(await he.get(n)).data;if(c.log(`üì• Raw Twelve Data data for ${t}:`,a),c.log(`üìä Data length: ${a.length} records`),a.length>0&&c.log("üìä First record:",a[0]),!a||!Array.isArray(a)||a.length===0)return c.warn(`‚ùó No data received for ${t}:`,a),null;const s=a.find(l=>l.symbol===t);return s?(c.log(`üì° fetchQuote ‚Üí ${t}: $${s.price} @ ${s.timestamp}`),{symbol:t,buyPrice:s.price,buyDate:s.timestamp,historicalData:[{price:s.price,timestamp:s.timestamp,fetchTimestamp:s.fetchTimestamp,symbol:t}]}):(c.warn(`‚ùó No data found for ${t} in response`),null)}catch(r){return c.error(`‚ùå fetchQuote error for ${t}:`,r),r.response?c.error(`‚ùå Server error for ${t}:`,{status:r.response.status,statusText:r.response.statusText,data:r.response.data}):r.request?c.error(`‚ùå Network error for ${t}:`,r.request):c.error(`‚ùå Other error for ${t}:`,r.message),null}}async function Ur(t,e,r=null,n="1h",o=null){try{t=t.toUpperCase();const a=new Date(e).toISOString(),s=r?new Date(r).toISOString():null;let l=`${Lr}/twelvedata-historical?symbol=${t}&start_date=${a}&interval=${n}`;s&&(l+=`&end_date=${s}`),o&&Number.isInteger(o)&&o>0&&(l+=`&outputsize=${o}`),c.info(`üåê Requesting Twelve Data historical data for symbol: ${t} from ${a} to ${s||"now"} (interval: ${n}${o?`, outputsize: ${o}`:""})`);const h=(await he.get(l)).data;if(c.log(`üì• Raw Twelve Data historical data for ${t}:`,h),!h||h.status!=="ok"||!h.historicalData)return c.warn(`‚ùó No historical data received for ${t}:`,h),null;if(c.log(`üì° fetchHistoricalData ‚Üí ${t}: ${h.historicalData.length} datapoints`),h.historicalData.length>0){const u=h.historicalData[h.historicalData.length-1];c.log(`üí∞ Latest Historical Data for ${t}:`,{price:u.price,close:u.close,open:u.open,high:u.high,low:u.low,timestamp:u.timestamp,fullPoint:u})}return{symbol:t,historicalData:h.historicalData.map(u=>({price:u.close||u.price,timestamp:u.timestamp,fetchTimestamp:new Date().toISOString(),symbol:t}))}}catch(a){return c.error(`‚ùå fetchHistoricalData error for ${t}:`,a),a.response?c.error(`‚ùå Server error for ${t}:`,{status:a.response.status,statusText:a.response.statusText,data:a.response.data}):a.request?c.error(`‚ùå Network error for ${t}:`,a.request):c.error(`‚ùå Other error for ${t}:`,a.message),null}}async function qn(t,e="1min"){try{const r=t.map(d=>d.toUpperCase()).join(", "),n=Vn(e),o=`${Lr}/twelvedata-quote?symbols=${r}&interval=${n}`;c.log(`üåê Requesting Twelve Data batch quote for symbols: ${r} (interval: ${n}, original timeframe: ${e})`);const s=(await he.get(o)).data;if(c.log("üì• Raw Twelve Data batch data:",s),c.log(`üìä Data length: ${s.length} records`),!s||!Array.isArray(s)||s.length===0)return c.warn("‚ùó No batch data received:",s),[];const l=s.map(d=>{c.log(`üí∞ API Response for ${d.symbol}:`,{symbol:d.symbol,price:d.price,close:d.close,open:d.open,high:d.high,low:d.low,timestamp:d.timestamp,fullResponse:d});const h=d.close||d.price;return{symbol:d.symbol,buyPrice:h,buyDate:d.timestamp,historicalData:[{price:h,timestamp:d.timestamp,fetchTimestamp:d.fetchTimestamp,symbol:d.symbol}]}});return c.log(`üì° fetchBatchQuotes ‚Üí ${l.length} symbols processed`),l}catch(r){return c.error("‚ùå fetchBatchQuotes error:",r),r.response?c.error("‚ùå Server error:",{status:r.response.status,statusText:r.response.statusText,data:r.response.data}):r.request?c.error("‚ùå Network error:",r.request):c.error("‚ùå Other error:",r.message),[]}}const xr=Object.freeze(Object.defineProperty({__proto__:null,fetchBatchQuotes:qn,fetchHistoricalData:Ur,fetchQuote:pa},Symbol.toStringTag,{value:"Module"}));class ha{constructor(){this.activeBurnlists=new Map,this.maxActiveBurnlists=5,this.manualUpdateQueue=[]}registerActiveBurnlist(e,r=[]){const n=Date.now();if(this.activeBurnlists.has(e)){const o=this.activeBurnlists.get(e);o.lastOpened=n,o.tickers=new Set(r),this.activeBurnlists.set(e,o),c.log(`üìù Updated active burnlist: ${e}`);return}if(this.activeBurnlists.size>=this.maxActiveBurnlists){const o=this.getOldestActiveBurnlist();o&&(this.activeBurnlists.delete(o),c.log(`üóëÔ∏è Removed oldest active burnlist: ${o}`))}this.activeBurnlists.set(e,{lastOpened:n,priority:this.calculatePriority(n),tickers:new Set(r)}),c.log(`‚úÖ Registered active burnlist: ${e} (${this.activeBurnlists.size}/${this.maxActiveBurnlists})`)}unregisterActiveBurnlist(e){this.activeBurnlists.has(e)&&(this.activeBurnlists.delete(e),c.log(`‚ùå Unregistered active burnlist: ${e}`))}getActiveBurnlists(){return Array.from(this.activeBurnlists.entries()).map(([e,r])=>({slug:e,lastOpened:r.lastOpened,priority:r.priority,tickers:Array.from(r.tickers)}))}isActiveBurnlist(e){return this.activeBurnlists.has(e)}getBurnlistPriority(e){const r=this.activeBurnlists.get(e);return r?r.priority:0}getAllUniqueTickers(){const e=new Set;return this.activeBurnlists.forEach((r,n)=>{r.tickers.forEach(o=>e.add(o))}),Array.from(e)}getBurnlistsForTicker(e){const r=[];return this.activeBurnlists.forEach((n,o)=>{n.tickers.has(e)&&r.push(o)}),r}getOldestActiveBurnlist(){let e=null,r=Date.now();return this.activeBurnlists.forEach((n,o)=>{n.lastOpened<r&&(r=n.lastOpened,e=o)}),e}calculatePriority(e){const n=Date.now()-e;return Math.max(0,1e3-Math.floor(n/1e3))}requestManualUpdate(e){return this.isActiveBurnlist(e)?(c.log(`‚ö†Ô∏è Manual update requested for active burnlist: ${e}`),!1):this.manualUpdateQueue.find(n=>n.slug===e)?(c.log(`‚ö†Ô∏è Manual update already queued for: ${e}`),!1):(this.manualUpdateQueue.push({slug:e,timestamp:Date.now(),status:"pending"}),c.log(`üìã Queued manual update for: ${e}`),!0)}getManualUpdateQueue(){return this.manualUpdateQueue.map(e=>({...e}))}isManualUpdatePending(e){return this.manualUpdateQueue.some(r=>r.slug===e&&r.status==="pending")}markManualUpdateProcessing(e){const r=this.manualUpdateQueue.find(n=>n.slug===e);r&&(r.status="processing",c.log(`‚öôÔ∏è Processing manual update for: ${e}`))}markManualUpdateCompleted(e){const r=this.manualUpdateQueue.findIndex(n=>n.slug===e);r!==-1&&(this.manualUpdateQueue.splice(r,1),c.log(`‚úÖ Completed manual update for: ${e}`))}getNextManualUpdate(){return this.manualUpdateQueue.find(e=>e.status==="pending")}getSystemStatus(){return{activeBurnlists:this.activeBurnlists.size,maxActiveBurnlists:this.maxActiveBurnlists,manualUpdateQueue:this.manualUpdateQueue.length,totalUniqueTickers:this.getAllUniqueTickers().length}}cleanupOldManualUpdates(){const e=Date.now()-3e5,r=this.manualUpdateQueue.length;this.manualUpdateQueue=this.manualUpdateQueue.filter(o=>o.timestamp>e);const n=r-this.manualUpdateQueue.length;n>0&&c.log(`üßπ Cleaned up ${n} old manual update requests`)}}const ct=new ha,ga=Object.freeze(Object.defineProperty({__proto__:null,default:ct},Symbol.toStringTag,{value:"Module"}));class fa{constructor(){this.notificationCallback=null}setNotificationCallback(e){this.notificationCallback=e}calculateWatchlistReturn(e,r="MAX"){try{if(!Array.isArray(e)||e.length===0)return null;let n=0,o=0;if(e.forEach(s=>{if(!s.historicalData||!Array.isArray(s.historicalData)||s.historicalData.length===0){c.warn(`‚ö†Ô∏è Skipping ${s.symbol}: no historical data`);return}if(!s.buyPrice||s.buyPrice<=0){c.warn(`‚ö†Ô∏è Skipping ${s.symbol}: invalid buy price`);return}const l=s.buyDate&&new Date(s.buyDate).toString()!=="Invalid Date"?s.buyDate:null;let d,h;if(r==="MAX"){const{startPoint:b,endPoint:k}=this.getSlicedDataLocal(s.historicalData,r,l,s.symbol,s.buyPrice);d=b,h=k}else{const{startPoint:b,endPoint:k}=this.getSlicedDataLocal(s.historicalData,r,null,s.symbol,null);d=b,h=k}if(!d||!h||typeof d.price!="number"||d.price<=0){c.warn(`‚ö†Ô∏è Skipping ${s.symbol}: invalid price points`);return}let u;if(typeof s.currentPrice=="number")u=s.currentPrice;else if(h&&typeof h.price=="number")u=h.price;else{c.warn(`‚ö†Ô∏è No valid current price found for ${s.symbol}, skipping from watchlist average`);return}let f;r==="MAX"?f=s.buyPrice:f=d.price;const x=(u-f)/f*100;Number.isFinite(x)?(n+=x,o++,c.debug(`[Watchlist Calc] ${s.symbol}: referencePrice=${f}, currentPrice=${u}, return=${x.toFixed(2)}% (timeframe: ${r})`)):c.warn(`‚ö†Ô∏è Skipping ${s.symbol}: invalid return calculation`)}),o===0)return c.warn("‚ö†Ô∏è No valid items for watchlist return calculation"),null;const a=n/o;return c.debug(`Watchlist average return (${r}): ${a.toFixed(2)}% (${o}/${e.length} valid tickers)`),Number.isFinite(a)?a:null}catch(n){return c.error("‚ùå Error calculating watchlist return:",n),null}}getTimeframeStartTime(e,r=new Date){switch(e){case"D":const n=new Date(r.getTime()-864e5);return n.setHours(0,0,0,0),n;case"W":return new Date(r.getTime()-7*24*60*60*1e3);case"M":return new Date(r.getTime()-30*24*60*60*1e3);case"YTD":return new Date(r.getFullYear(),0,1);case"MAX":default:return null}}findClosestHistoricalPrice(e,r){if(!e||e.length===0)return null;const n=r.getTime();let o=null,a=1/0;return e.forEach(s=>{const l=new Date(s.timestamp).getTime(),d=Math.abs(l-n);d<a&&(a=d,o=s)}),o}calculateReturnsForBurnlist(e,r){try{const n=e.items.map(o=>{const a=r.find(s=>s.symbol===o.symbol);return a&&(o.currentPrice=a.price,o.buyPrice&&o.buyPrice>0&&(o.returnPercent=(a.price-o.buyPrice)/o.buyPrice*100,o.returnDollar=a.price-o.buyPrice),o.historicalData||(o.historicalData=[]),o.historicalData.push({price:a.price,timestamp:a.timestamp,fetchTimestamp:a.fetchTimestamp}),o.historicalData.length>100&&(o.historicalData=o.historicalData.slice(-100))),o});return{...e,items:n}}catch(n){return c.error("‚ùå Error calculating returns for burnlist:",n),e}}calculateAverageReturn(e,r="1D"){try{if(!Array.isArray(e)||e.length===0)return 0;let n=0,o=0;return e.forEach(a=>{if(a.buyPrice&&a.buyPrice>0&&a.currentPrice){const s=(a.currentPrice-a.buyPrice)/a.buyPrice*100;n+=s,o++}}),o>0?n/o:0}catch(n){return c.error("‚ùå Error calculating average return:",n),0}}calculateTickerReturn(e){try{if(!e.buyPrice||e.buyPrice<=0||!e.currentPrice)return null;const r=(e.currentPrice-e.buyPrice)/e.buyPrice*100,n=e.currentPrice-e.buyPrice;return{symbol:e.symbol,buyPrice:e.buyPrice,currentPrice:e.currentPrice,returnPercent:r,returnDollar:n,timestamp:new Date().toISOString()}}catch(r){return c.error(`‚ùå Error calculating return for ${e.symbol}:`,r),null}}updateBurnlistReturns(e){try{const r=e.items.map(n=>{const o=this.calculateTickerReturn(n);return o&&(n.returnPercent=o.returnPercent,n.returnDollar=o.returnDollar),n});return{...e,items:r}}catch(r){return c.error("‚ùå Error updating burnlist returns:",r),e}}getReturnStats(e){try{const r={totalTickers:0,tickersWithReturns:0,averageReturn:0,totalReturn:0,bestPerformer:null,worstPerformer:null,positiveReturns:0,negativeReturns:0};if(!e.items||!Array.isArray(e.items))return r;const n=[];return e.items.forEach(o=>{r.totalTickers++,o.returnPercent!==void 0&&o.returnPercent!==null&&(r.tickersWithReturns++,r.totalReturn+=o.returnPercent,n.push({symbol:o.symbol,returnPercent:o.returnPercent,returnDollar:o.returnDollar}),o.returnPercent>0?r.positiveReturns++:o.returnPercent<0&&r.negativeReturns++)}),r.tickersWithReturns>0&&(r.averageReturn=r.totalReturn/r.tickersWithReturns),n.length>0&&(n.sort((o,a)=>a.returnPercent-o.returnPercent),r.bestPerformer=n[0],r.worstPerformer=n[n.length-1]),r}catch(r){return c.error("‚ùå Error getting return stats:",r),null}}calculatePortfolioPerformance(e,r="1D"){try{if(!e.items||!Array.isArray(e.items))return null;const n={timeframe:r,startDate:null,endDate:null,totalValue:0,currentValue:0,totalReturn:0,returnPercent:0,tickerPerformance:[]};let o=0,a=0;return e.items.forEach(s=>{if(s.buyPrice&&s.buyPrice>0&&s.currentPrice){const l=s.buyPrice,d=s.currentPrice;o+=l,a+=d,n.tickerPerformance.push({symbol:s.symbol,buyPrice:s.buyPrice,currentPrice:s.currentPrice,returnPercent:(d-l)/l*100,returnDollar:d-l})}}),o>0&&(n.totalValue=o,n.currentValue=a,n.totalReturn=a-o,n.returnPercent=(a-o)/o*100),n}catch(n){return c.error("‚ùå Error calculating portfolio performance:",n),null}}notifyReturnChanges(e,r={}){try{if(!this.notificationCallback)return;const n=[],o=2;e.items.forEach(a=>{if(a.symbol&&a.returnPercent!==void 0){const s=r[a.symbol]||0;Math.abs(a.returnPercent-s)>=o&&n.push({symbol:a.symbol,previousReturn:s,currentReturn:a.returnPercent,change:a.returnPercent-s})}}),n.length>0&&this.notificationCallback("return-changes",n)}catch(n){c.error("‚ùå Error notifying return changes:",n)}}exportReturnData(e){try{return{burnlistName:e.name,burnlistSlug:e.slug,exportDate:new Date().toISOString(),stats:this.getReturnStats(e),performance:this.calculatePortfolioPerformance(e),tickers:e.items.map(n=>({symbol:n.symbol,buyPrice:n.buyPrice,buyDate:n.buyDate,currentPrice:n.currentPrice,returnPercent:n.returnPercent,returnDollar:n.returnDollar,historicalDataCount:n.historicalData?n.historicalData.length:0}))}}catch(r){return c.error("‚ùå Error exporting return data:",r),null}}getSlicedDataLocal(e,r,n,o="?",a=null){var w,v,y,C;if(!Array.isArray(e)||e.length===0)return{startPoint:null,endPoint:null};const s=new Date,l=[...e].sort((A,R)=>new Date(A.timestamp)-new Date(R.timestamp)),d={D:"D",W:"W",M:"M",Y:"Y",YTD:"YTD",MAX:"MAX"}[r]||r;let h;switch(d){case"D":h=new Date(s.getTime()-24*60*60*1e3),h.setHours(0,0,0,0);break;case"W":h=new Date(s.getTime()-7*24*60*60*1e3);break;case"M":h=new Date(s.getTime()-30*24*60*60*1e3),c.log(`üìÖ [ReturnCalculator] MONTHLY: Today is ${s.toDateString()}, 30 days ago is ${h.toDateString()}`);break;case"Y":h=new Date(s.getTime()-365*24*60*60*1e3);break;case"YTD":h=new Date(s.getFullYear(),0,1);break;case"MAX":default:h=null}const u=new Date(n||((w=e[0])==null?void 0:w.timestamp)||s);let f,x;if(r==="MAX")if(f=u,a&&!isNaN(a))x=Number(a);else{const A=this.binarySearchClosestIdx(l,f.getTime());x=((v=l[A])==null?void 0:v.price)||0}else if(r==="YTD"){const A=new Date(s.getFullYear(),0,1),R=A>u?A:u,Y=l[0],g=new Date(Y==null?void 0:Y.timestamp);if(g<=R){f=R;const P=this.binarySearchClosestIdx(l,f.getTime());x=((y=l[P])==null?void 0:y.price)||0,A>u?c.log(`üìÖ [ReturnCalculator] YTD: Using Jan 1st ${A.toDateString()} ‚Üí price: ${x} for ${o} (buy date is older)`):c.log(`üìÖ [ReturnCalculator] YTD: Using buy date ${u.toDateString()} ‚Üí price: ${x} for ${o} (Jan 1st is before buy date)`)}else f=g,x=(Y==null?void 0:Y.price)||0,c.log(`üìÖ [ReturnCalculator] YTD: Effective start not available, using first data point ${g.toDateString()} ‚Üí price: ${x} for ${o}`)}else{f=h>u?h:u;const R=this.binarySearchClosestIdx(l,f.getTime());x=((C=l[R])==null?void 0:C.price)||0,h>u?c.log(`üìÖ [ReturnCalculator] ${d}: Using timeframe start ${h.toISOString()} ‚Üí price: ${x} for ${o} (buy date is older)`):c.log(`üìÖ [ReturnCalculator] ${d}: Using buy date ${u.toISOString()} ‚Üí price: ${x} for ${o} (timeframe would go before buy date)`)}const b=this.binarySearchClosestIdx(l,f.getTime()),k={...l[b],timestamp:f.toISOString(),price:x},T=l[l.length-1];return{startPoint:k,endPoint:T}}binarySearchClosestIdx(e,r){let n=0,o=e.length-1,a=0,s=Math.abs(new Date(e[0].timestamp)-r);for(;n<=o;){const l=Math.floor((n+o)/2),d=new Date(e[l].timestamp).getTime(),h=Math.abs(d-r);if(h<s&&(s=h,a=l),d<r)n=l+1;else if(d>r)o=l-1;else return l}return a}}const ma=new fa;class xa{constructor(){this.notifications=[],this.callbacks=new Set,this.apiStatus="online",this.lastApiCheck=Date.now()}addCallback(e){this.callbacks.add(e)}removeCallback(e){this.callbacks.delete(e)}notify(e,r){this.callbacks.forEach(n=>{try{n(e,r)}catch(o){console.error("‚ùå Error in notification callback:",o)}})}handleApiOffline(e){this.apiStatus="offline",this.lastApiCheck=Date.now();const r={type:"api-offline",message:"API is offline. Using cached data.",details:(e==null?void 0:e.message)||"Unknown error",timestamp:new Date().toISOString(),severity:"warning"};this.notifications.push(r),this.notify("api-offline",r),console.error("‚ùå API Offline:",e)}handleApiOnline(){const e=this.apiStatus==="offline";if(this.apiStatus="online",this.lastApiCheck=Date.now(),e){const r={type:"api-online",message:"API is back online.",timestamp:new Date().toISOString(),severity:"success"};this.notifications.push(r),this.notify("api-online",r),console.log("‚úÖ API Online")}}handleRateLimitWarning(e){if(e.atLimit){const r={type:"rate-limit-reached",message:"Rate limit reached. Waiting for reset...",details:`${e.totalRate}/${e.maxCallsPerMinute} calls`,timestamp:new Date().toISOString(),severity:"error"};this.notifications.push(r),this.notify("rate-limit-reached",r),console.warn("‚ö†Ô∏è Rate limit reached")}else if(e.approaching){const r={type:"rate-limit-approaching",message:"Approaching rate limit.",details:`${e.totalRate}/${e.maxCallsPerMinute} calls`,timestamp:new Date().toISOString(),severity:"warning"};this.notifications.push(r),this.notify("rate-limit-approaching",r),console.warn("‚ö†Ô∏è Approaching rate limit")}}handleManualUpdateStatus(e,r){const n={type:"manual-update",message:`Manual update ${r} for ${e}`,slug:e,status:r,timestamp:new Date().toISOString(),severity:r==="completed"?"success":"info"};this.notifications.push(n),this.notify("manual-update",n),console.log(`üìã Manual update ${r} for ${e}`)}handleReturnChanges(e){if(e.length===0)return;const r={type:"return-changes",message:`${e.length} ticker(s) with significant return changes`,changes:e,timestamp:new Date().toISOString(),severity:"info"};this.notifications.push(r),this.notify("return-changes",r),console.log(`üìä ${e.length} significant return changes detected`)}handleSystemError(e,r){const n={type:"system-error",message:"System error occurred",details:(e==null?void 0:e.message)||"Unknown error",context:r,timestamp:new Date().toISOString(),severity:"error"};this.notifications.push(n),this.notify("system-error",n),console.error("‚ùå System Error:",e)}handleSyncStatus(e,r){const n={type:"sync-status",message:`Sync ${e}`,details:r,timestamp:new Date().toISOString(),severity:e==="completed"?"success":"info"};this.notifications.push(n),this.notify("sync-status",n),console.log(`üîÑ Sync ${e}:`,r)}getApiStatus(){return{status:this.apiStatus,lastCheck:this.lastApiCheck,isOnline:this.apiStatus==="online"}}getRecentNotifications(e=10){return this.notifications.slice(-e).reverse()}clearOldNotifications(){const e=Date.now()-36e5,r=this.notifications.length;this.notifications=this.notifications.filter(o=>new Date(o.timestamp).getTime()>e);const n=r-this.notifications.length;n>0&&console.log(`üßπ Cleared ${n} old notifications`)}getNotificationStats(){const e={total:this.notifications.length,byType:{},bySeverity:{}};return this.notifications.forEach(r=>{e.byType[r.type]=(e.byType[r.type]||0)+1,e.bySeverity[r.severity]=(e.bySeverity[r.severity]||0)+1}),e}exportNotifications(){return{timestamp:new Date().toISOString(),apiStatus:this.getApiStatus(),notifications:this.notifications,stats:this.getNotificationStats()}}reset(){this.notifications=[],this.apiStatus="online",this.lastApiCheck=Date.now(),console.log("üîÑ Notification manager reset")}}const Lt=new xa;class ya{constructor(){this.isRunning=!1,this.cycleTimeouts=[],this.currentCycleStartTime=null,this.batchesInCurrentMinute=0,this.lastMinuteTimestamp=0,this.BATCH_SIZE=5,this.BATCHES_PER_CYCLE=20,this.CYCLE_DURATION_MS=3*60*1e3,this.BATCH_INTERVAL_MS=9*1e3,this.MAX_BATCHES_PER_MINUTE=11,this.stats={totalCycles:0,totalBatches:0,successfulBatches:0,failedBatches:0,lastError:null,lastCycleTime:null}}async start(){if(console.log("üîß DEBUG: batchedFetchManager.start() called"),this.isRunning){console.log("‚ö†Ô∏è Batched fetch manager already running");return}this.isRunning=!0,console.log("üöÄ Starting batched fetch manager (3-minute cycles, 9-second intervals)"),this.verifyRateLimitCompliance(),await this.startNewCycle()}stop(){this.isRunning=!1,this.cycleTimeouts.forEach(e=>clearTimeout(e)),this.cycleTimeouts=[],console.log("üõë Stopped batched fetch manager")}async startNewCycle(){if(console.log("üîß DEBUG: startNewCycle called"),console.log("üîß DEBUG: isRunning:",this.isRunning),!this.isRunning){console.log("üîß DEBUG: Not running, returning");return}const e=this.isMarketOpen();if(console.log("üîß DEBUG: Market open check:",e),!e){console.log("‚è∞ Market is closed (extended NYC hours: Mon-Fri, 4:00 AM - 8:00 PM ET). Skipping automatic fetch cycle."),console.log("‚è∞ Manual fetches (add ticker, edit buy date, click header) are still allowed anytime."),this.scheduleNextCycle();return}this.currentCycleStartTime=Date.now(),this.stats.totalCycles++,this.stats.lastCycleTime=new Date().toISOString(),console.log(`üîÑ Starting fetch cycle #${this.stats.totalCycles} (extended NYC market hours)`);const r=ct.getAllUniqueTickers();if(console.log("üîß DEBUG: All tickers found:",r),r.length===0){console.log("üì≠ No active tickers to fetch, scheduling next cycle"),this.scheduleNextCycle();return}console.log(`üìä Processing ${r.length} tickers in ${this.BATCHES_PER_CYCLE} batches`);const n=this.createBatches(r,this.BATCH_SIZE),o=n.slice(0,this.BATCHES_PER_CYCLE);n.length>this.BATCHES_PER_CYCLE&&console.log(`‚ö†Ô∏è Limited to ${this.BATCHES_PER_CYCLE} batches, ${n.length-this.BATCHES_PER_CYCLE} batches will be processed in next cycle`),o.forEach((l,d)=>{const h=d*this.BATCH_INTERVAL_MS;console.log(`‚è∞ Scheduling batch ${d+1}/${o.length} in ${h/1e3}s`);const u=setTimeout(async()=>{await this.processBatch(l,d+1,o.length)},h);this.cycleTimeouts.push(u)});const a=o.length*this.BATCH_INTERVAL_MS+1e3,s=setTimeout(async()=>{await this.completeCycle(),this.scheduleNextCycle()},a);this.cycleTimeouts.push(s)}createBatches(e,r){const n=[];for(let o=0;o<e.length;o+=r)n.push(e.slice(o,o+r));return n}async processBatch(e,r,n){if(!this.isRunning)return;const o=Math.floor(Date.now()/6e4);if(o!==this.lastMinuteTimestamp&&(this.lastMinuteTimestamp=o,this.batchesInCurrentMinute=0),this.batchesInCurrentMinute>=this.MAX_BATCHES_PER_MINUTE){console.warn(`‚ö†Ô∏è Rate limit reached: ${this.batchesInCurrentMinute} batches in current minute, skipping batch ${r}`),this.stats.failedBatches++;return}this.batchesInCurrentMinute++,this.stats.totalBatches++,console.log(`üì° Processing batch ${r}/${n}: [${e.join(", ")}] (${this.batchesInCurrentMinute}/${this.MAX_BATCHES_PER_MINUTE} this minute, ${e.length} credits)`);try{const a=[];for(const s of e)try{const l=new Date,d=new Date(l.getTime()-24*60*60*1e3),h=await Ur(s,d.toISOString().split("T")[0],l.toISOString().split("T")[0],"1h",24);h&&a.push(h)}catch(l){console.error(`‚ùå Failed to fetch historical data for ${s}:`,l)}a&&a.length>0?(console.log(`‚úÖ Batch ${r} successful: ${a.length} historical datasets received`),this.stats.successfulBatches++,this.updateBurnlistPrices(a)):(console.warn(`‚ùå Batch ${r} failed: no data received`),this.stats.failedBatches++)}catch(a){console.error(`‚ùå Batch ${r} error:`,a),this.stats.failedBatches++,this.stats.lastError=a.message}}updateBurnlistPrices(e){ct.getActiveBurnlists().forEach(n=>{const o=this.updateWatchlistItems(n,e);o.length>0&&console.log(`üìä Updated ${o.length} items in watchlist ${n}`)})}updateWatchlistItems(e,r){try{const n=JSON.parse(localStorage.getItem("burnlist_watchlists")||"{}"),o=Object.keys(n).find(l=>n[l].slug===e);if(!o||!n[o].items)return[];const a=n[o],s=[];return a.items.forEach(l=>{var h;const d=r.find(u=>u.symbol===l.symbol);if(d){console.log("üîß DEBUG: Processing",l.symbol),console.log("üîß DEBUG: Original buy price:",l.buyPrice),console.log("üîß DEBUG: Original buy date:",l.buyDate),console.log("üîß DEBUG: New historical data:",d);const u=l.buyPrice,f=l.buyDate,x=(h=d.historicalData[d.historicalData.length-1])==null?void 0:h.price;x&&(logger.log(`üí∞ Setting current price for ${l.symbol}: $${x} (from historical data)`),l.currentPrice=x),l.historicalData||(l.historicalData=[]),d.historicalData.forEach(b=>{l.historicalData.find(T=>T.timestamp===b.timestamp)||l.historicalData.push({price:b.price,timestamp:b.timestamp,fetchTimestamp:new Date().toISOString(),symbol:l.symbol})}),l.historicalData.sort((b,k)=>new Date(b.timestamp)-new Date(k.timestamp)),l.historicalData.length>100&&(l.historicalData=l.historicalData.slice(-100)),l.buyPrice=u,l.buyDate=f,console.log("üîß DEBUG: Final buy price after restore:",l.buyPrice),console.log("üîß DEBUG: Final current price:",l.currentPrice),s.push(l)}}),s.length>0&&(localStorage.setItem("burnlist_watchlists",JSON.stringify(n)),window.dispatchEvent(new StorageEvent("storage",{key:"burnlist_watchlists",newValue:JSON.stringify(n),storageArea:localStorage})),console.log(`üíæ Updated localStorage and triggered storage event for ${e}`)),s}catch(n){return console.error(`‚ùå Error updating watchlist items for ${e}:`,n),[]}}async completeCycle(){if(!this.isRunning)return;console.log(`üèÅ Completing fetch cycle #${this.stats.totalCycles}`);const e=ct.getActiveBurnlists();for(const n of e)await this.computeAndSaveWatchlistAverage(n);const r=Date.now()-this.currentCycleStartTime;console.log(`‚ú® Cycle #${this.stats.totalCycles} completed in ${(r/1e3).toFixed(1)}s`)}async computeAndSaveWatchlistAverage(e){try{const r=JSON.parse(localStorage.getItem("burnlist_watchlists")||"{}"),n=Object.keys(r).find(l=>r[l].slug===e);if(!n||!r[n].items)return;const a=r[n].items,s=this.calculateTimeframeBasedReturn(a,"MAX");if(s!==null){const l={timestamp:new Date().toISOString(),averageReturn:parseFloat(s.toFixed(5)),tickerCount:a.length,timeframe:"MAX"};yn.saveWatchlistDatapoint(e,l)&&console.log(`üíæ Saved watchlist datapoint for ${e}: ${s.toFixed(2)}% (${a.length} tickers)`)}}catch(r){console.error(`‚ùå Error computing watchlist average for ${e}:`,r)}}calculateTimeframeBasedReturn(e,r="MAX"){if(!Array.isArray(e)||e.length===0)return null;let n=0,o=0;const a=new Date;return e.forEach(s=>{if(!s.currentPrice||!s.buyPrice||s.buyPrice<=0)return;let l=s.buyPrice;if(r!=="MAX"&&s.historicalData&&s.historicalData.length>0){const h=this.getTimeframeStartTime(r,a);if(h)if(new Date(s.buyDate)<=h){const f=this.findClosestHistoricalPrice(s.historicalData,h);f&&(l=f.price)}else{const f=s.historicalData[0];f&&f.price>0&&(l=f.price)}}const d=(s.currentPrice-l)/l*100;Number.isFinite(d)&&(n+=d,o++)}),o===0?null:n/o}getTimeframeStartTime(e,r=new Date){switch(e){case"D":return new Date(r.getTime()-24*60*60*1e3);case"W":return new Date(r.getTime()-7*24*60*60*1e3);case"M":return new Date(r.getTime()-30*24*60*60*1e3);case"YTD":return new Date(r.getFullYear(),0,1);case"MAX":default:return null}}findClosestHistoricalPrice(e,r){if(!e||e.length===0)return null;const n=r.getTime();let o=null,a=1/0;return e.forEach(s=>{const l=new Date(s.timestamp).getTime(),d=Math.abs(l-n);d<a&&(a=d,o=s)}),o}scheduleNextCycle(){if(!this.isRunning)return;const e=this.CYCLE_DURATION_MS;console.log(`‚è∞ Next fetch cycle in ${(e/1e3).toFixed(1)}s`);const r=setTimeout(()=>{this.startNewCycle()},e);this.cycleTimeouts.push(r)}isMarketOpen(){const e=new Date,r=new Date(e.toLocaleString("en-US",{timeZone:"America/New_York"})),n=r.getDay(),o=r.getHours();return!(n===0||n===6||o<4||o>=20)}verifyRateLimitCompliance(){const e=this.getStatus(),{configuration:r,currentCycle:n}=e;Math.ceil(100/r.batchSize)*r.batchIntervalMs;const a=r.maxBatchesPerMinute*r.batchSize,s={batchSize:r.batchSize===5,batchesPerCycle:r.batchesPerCycle===20,cycleDuration:Math.abs(r.cycleDurationMs-18e4)<1e3,batchInterval:r.batchIntervalMs===9e3,maxBatchesPerMinute:r.maxBatchesPerMinute===11,maxCreditsPerMinute:a===55,marketHoursCheck:this.isMarketOpen!==void 0},l=Object.values(s).every(Boolean);return console.log("üîç Rate Limit Compliance Check:"),console.log(`  ‚úÖ Batch size (5 tickers): ${s.batchSize}`),console.log(`  ‚úÖ Batches per cycle (20): ${s.batchesPerCycle}`),console.log(`  ‚úÖ Cycle duration (3min): ${s.cycleDuration}`),console.log(`  ‚úÖ Batch interval (9s): ${s.batchInterval}`),console.log(`  ‚úÖ Max batches/min (11): ${s.maxBatchesPerMinute}`),console.log(`  ‚úÖ Max credits/min (55): ${s.maxCreditsPerMinute}`),console.log(`  ‚úÖ Market hours check: ${s.marketHoursCheck}`),console.log(`  ${l?"‚úÖ":"‚ùå"} Overall compliance: ${l?"PASS":"FAIL"}`),{compliance:s,allCompliant:l}}getStatus(){const e=this.currentCycleStartTime?Date.now()-this.currentCycleStartTime:0;return{isRunning:this.isRunning,stats:{...this.stats},currentCycle:{startTime:this.currentCycleStartTime,uptime:e,batchesInCurrentMinute:this.batchesInCurrentMinute},configuration:{batchSize:this.BATCH_SIZE,batchesPerCycle:this.BATCHES_PER_CYCLE,cycleDurationMs:this.CYCLE_DURATION_MS,batchIntervalMs:this.BATCH_INTERVAL_MS,maxBatchesPerMinute:this.MAX_BATCHES_PER_MINUTE},marketHours:{isOpen:this.isMarketOpen(),currentNYTime:new Date().toLocaleString("en-US",{timeZone:"America/New_York"})}}}}const Ut=new ya;class ba{constructor(e=55){this.maxCallsPerMinute=e,this.automaticCalls=[],this.manualCalls=[],this.reservedForManual=10,this.batchSize=5}canMakeAutomaticRequest(){const r=Date.now()-6e4;this.automaticCalls=this.automaticCalls.filter(o=>o>r);const n=this.maxCallsPerMinute-this.reservedForManual;return this.automaticCalls.length<n}canMakeManualRequest(){const r=Date.now()-6e4;return this.manualCalls=this.manualCalls.filter(n=>n>r),this.manualCalls.length<this.reservedForManual}recordAutomaticRequest(){this.automaticCalls.push(Date.now()),c.log(`üìä Automatic API call recorded. Total: ${this.automaticCalls.length}`)}recordManualRequest(){this.manualCalls.push(Date.now()),c.log(`üìä Manual API call recorded. Total: ${this.manualCalls.length}`)}getRateLimitStatus(){const r=Date.now()-6e4,n=this.automaticCalls.filter(s=>s>r).length,o=this.manualCalls.filter(s=>s>r).length,a=n+o;return{automaticRate:n,manualRate:o,totalRate:a,maxCallsPerMinute:this.maxCallsPerMinute,reservedForManual:this.reservedForManual,availableForAutomatic:this.maxCallsPerMinute-this.reservedForManual,approaching:a>=this.maxCallsPerMinute*.8,atLimit:a>=this.maxCallsPerMinute,nextAutomaticAvailable:this.canMakeAutomaticRequest()?0:this.getNextAvailableTime("automatic"),nextManualAvailable:this.canMakeManualRequest()?0:this.getNextAvailableTime("manual")}}getNextAvailableTime(e){const r=Date.now(),n=r-6e4;if(e==="automatic"){const o=this.automaticCalls.filter(s=>s>n);return o.length<this.maxCallsPerMinute-this.reservedForManual?0:Math.min(...o)+6e4-r}else{const o=this.manualCalls.filter(s=>s>n);return o.length<this.reservedForManual?0:Math.min(...o)+6e4-r}}getMaxTickersPerMinute(){return(this.maxCallsPerMinute-this.reservedForManual)*this.batchSize}calculateRefreshInterval(e){const r=this.getMaxTickersPerMinute();return e<=r?6e4:e<=r*2?9e4:12e4}async waitForRateLimit(e="automatic"){const r=this.getNextAvailableTime(e);r>0&&(c.log(`‚è≥ Waiting ${Math.ceil(r/1e3)}s for rate limit reset (${e})`),await new Promise(n=>setTimeout(n,r)))}getStatusMessage(){const e=this.getRateLimitStatus();return e.atLimit?"Rate limit reached. Waiting for reset...":e.approaching?`Approaching rate limit: ${e.totalRate}/${e.maxCallsPerMinute} calls`:`API calls: ${e.totalRate}/${e.maxCallsPerMinute}`}}const qt=new ba;function zr(t){if(!t||typeof t!="object")return c.warn("‚ö†Ô∏è normalizeTicker received invalid input:",t),{symbol:"UNKNOWN",buyPrice:0,buyDate:new Date().toISOString(),historicalData:[],addedAt:new Date().toISOString(),type:"real"};let e=!1;const r=Array.isArray(t.historicalData)?t.historicalData.map(l=>{const d=Number(l==null?void 0:l.price),h=new Date(l==null?void 0:l.timestamp).toISOString();return(isNaN(d)||!(l!=null&&l.timestamp))&&c.warn("‚ö†Ô∏è Malformed historical entry:",l),d===0&&(c.warn("‚ö†Ô∏è Historical entry has price = 0:",l),e=!0),{price:isNaN(d)?0:d,timestamp:h}}):[];let n=Number(t.buyPrice);isNaN(n)&&(c.warn("‚ö†Ô∏è Invalid or missing buyPrice, defaulting to 0:",t),n=0,e=!0);let o;t.buyDate&&!isNaN(new Date(t.buyDate))?o=new Date(t.buyDate).toISOString():(o=new Date(t.addedAt||Date.now()).toISOString(),c.warn("‚ö†Ô∏è Invalid or missing buyDate, falling back to addedAt or now:",t));const a=new Date(t.addedAt||Date.now()).toISOString(),s={symbol:String(t.symbol||"UNKNOWN").toUpperCase(),buyPrice:n,buyDate:o,historicalData:r,addedAt:a,type:t.type||"real",incomplete:e,...t.currentPrice!==void 0&&{currentPrice:Number(t.currentPrice)}};return c.log("üßº normalizeTicker ‚Üí",s),s}const Be=new Map,yr=new Map;let Nt=0,Qt=Date.now();function wa(){const t=Date.now();t-Qt>=6e4&&(Nt=0,Qt=t)}function ln(){return qt.canMakeAutomaticRequest()}function Sa(){wa(),Nt++,c.log(`üìä Global API Request #${Nt} (Twelve Data)`)}function Jn(t){return yr.has(t)||yr.set(t,{count:0,resetTime:Date.now()}),yr.get(t)}function va(t){const e=Jn(t);e.count++,c.log(`üìä Watchlist ${t} API Request #${e.count}`)}function Ca(){const t=new Date,e=new Date(t.toLocaleString("en-US",{timeZone:"America/New_York"})),r=e.getDay(),n=e.getHours();return!(r===0||r===6||n<4||n>=20)}function Da(t,e=5){const r=[];for(let n=0;n<t.length;n+=e)r.push(t.slice(n,n+e));return r}class ka{constructor(){this.isInitialized=!1}async initialize(){if(!this.isInitialized)try{await Ut.start(),this.isInitialized=!0,c.log("‚úÖ Twelve Data Fetch Manager initialized (automatic fetching enabled)")}catch(e){c.error("‚ùå Error initializing Twelve Data Fetch Manager:",e),Lt.handleSystemError(e,"fetch-manager-init")}}isFetchActive(e){const r=Be.get(e);return r&&r.status==="active"}getFetchStatus(e){const r=Be.get(e);if(!r)return{status:"idle",progress:0,message:"No active fetch"};const{status:n,currentBatch:o,totalBatches:a,message:s}=r,l=a>0?o/a*100:0;return{status:n,progress:Math.round(l),currentBatch:o,totalBatches:a,message:s}}cancelFetch(e){const r=Be.get(e);return r&&r.abortController?(r.abortController.abort(),Be.delete(e),c.log(`‚ùå Cancelled fetch for ${e}`),!0):!1}pauseFetch(e){const r=Be.get(e);return r&&r.status==="active"?(r.status="paused",c.log(`‚è∏Ô∏è Paused fetch for ${e}`),!0):!1}async resumeFetch(e,r,n){const o=Be.get(e);return o&&o.status==="paused"?(o.status="active",c.log(`‚ñ∂Ô∏è Resumed fetch for ${e}`),await this._executeFetch(e,r,n,o.currentBatch),!0):!1}async startFetch(e,r,n,o=!1,a=!1,s="1min"){if(this.isInitialized||await this.initialize(),!o){const l=r.map(d=>d.symbol);ct.registerActiveBurnlist(e,l)}if(!a&&!Ca()){const l="Market is closed. Click again to force refresh.";return c.log(`‚ö†Ô∏è ${l}`),{success:!1,message:l}}return o&&!ct.isActiveBurnlist(e)?await this._handleManualUpdate(e,r,n):await this._executeFetch(e,r,n,0,s)}async _handleManualUpdate(e,r,n){try{return c.log(`üìã Processing manual update for ${e}`),ct.requestManualUpdate(e)?(c.log(`Manual update requested for ${e} - will be processed in next batch cycle`),{success:!0,message:`Manual update queued for ${e}. Data will be refreshed in next batch cycle.`,batchedSystem:!0}):{success:!1,message:"Manual update already queued"}}catch(o){return c.error(`‚ùå Manual update error for ${e}:`,o),Lt.handleSystemError(o,"manual-update"),{success:!1,message:o.message}}}async _executeFetch(e,r,n,o=0,a="1min"){const s=new AbortController,l=r.map(u=>u.symbol),d=Da(l,5),h=d.length;Be.set(e,{status:"active",currentBatch:o,totalBatches:h,abortController:s,message:`Processing ${l.length} tickers in ${h} batches`}),c.log(`üîÑ Starting fetch for ${e}: ${l.length} tickers in ${h} batches`);try{let u=0;const f=[...r];for(let x=o;x<d.length;x++){if(s.signal.aborted){c.log(`‚ùå Fetch cancelled for ${e}`);break}const b=Be.get(e);if(b&&b.status==="paused"){c.log(`‚è∏Ô∏è Fetch paused for ${e}`);break}if(!ln()){c.log("‚è≥ Rate limit reached, waiting..."),await new Promise(T=>setTimeout(T,5e3));continue}const k=d[x];c.log(`üì¶ Processing batch ${x+1}/${h} for ${e}: ${k.join(", ")}`);try{const T=[];for(const v of k)try{const y=new Date,C=new Date(y.getTime()-24*60*60*1e3),A=await Ur(v,C.toISOString().split("T")[0],y.toISOString().split("T")[0],"1h",24);A&&T.push(A)}catch(y){console.error(`‚ùå Failed to fetch historical data for ${v}:`,y)}Sa(),va(e),qt.recordAutomaticRequest(),T.forEach(v=>{var C;const y=f.findIndex(A=>A.symbol===v.symbol);if(y!==-1){const A=f[y],R=A.buyPrice,Y=A.buyDate,g=(C=v.historicalData[v.historicalData.length-1])==null?void 0:C.price;g&&(c.log(`üí∞ Setting current price for ${v.symbol}: $${g} (from historical data)`),A.currentPrice=g),A.historicalData||(A.historicalData=[]),v.historicalData.forEach(P=>{A.historicalData.find(_=>_.timestamp===P.timestamp)||A.historicalData.push({price:P.price,timestamp:P.timestamp,fetchTimestamp:new Date().toISOString(),symbol:A.symbol})}),A.historicalData.sort((P,E)=>new Date(P.timestamp)-new Date(E.timestamp)),A.historicalData.length>100&&(A.historicalData=A.historicalData.slice(-100)),A.buyPrice=R,A.buyDate=Y,f[y]=zr(A),u++}});const w=Math.round((x+1)/h*100);Be.set(e,{...Be.get(e),currentBatch:x+1,message:`Processed ${x+1}/${h} batches`}),n&&n(f,w)}catch(T){c.error(`‚ùå Batch error for ${e}:`,T),Lt.handleSystemError(T,"batch-processing");continue}}return Be.set(e,{status:"completed",currentBatch:h,totalBatches:h,message:`Completed: ${u} tickers updated`}),c.log(`‚úÖ Fetch completed for ${e}: ${u} tickers updated`),{success:!0,message:`Updated ${u} tickers`}}catch(u){return c.error(`‚ùå Fetch error for ${e}:`,u),Lt.handleSystemError(u,"fetch-execution"),Be.set(e,{status:"error",currentBatch:0,totalBatches:h,message:`Error: ${u.message}`}),{success:!1,message:u.message}}finally{s.signal.aborted||s.abort()}}async _processBatch(e,r,n,o,a){if(n.signal.aborted)return[];try{return await qn(e,a)}catch(s){return c.error("‚ùå Batch processing error:",s),[]}}getRequestStatus(){return{globalRequestCount:Nt,lastResetTime:Qt,canMakeRequest:ln(),rateLimitStatus:qt.getRateLimitStatus(),syncStatus:Ut.getStatus()}}getWatchlistRequestStatus(e){const r=Jn(e);return{count:r.count,resetTime:r.resetTime,isActive:this.isFetchActive(e),status:this.getFetchStatus(e)}}cleanup(){Be.forEach((e,r)=>{e.abortController&&e.abortController.abort()}),Be.clear(),Ut.stop(),c.log("üßπ Twelve Data Fetch Manager cleaned up")}getSystemStats(){return{fetchManager:{activeFetches:Be.size,globalRequestCount:Nt,lastResetTime:Qt},batchedFetchManager:Ut.getStatus(),rateLimiter:qt.getRateLimitStatus(),activeBurnlists:ct.getSystemStatus()}}}const Me=new ka,Je=({message:t,type:e="info",onClose:r})=>{if(!t)return null;const n=ne(e==="error"?"#1a0f0f":e==="success"?"#0f1a0f":e==="loading"?"#0a0a0a":"#0f0f0f"),o=ne("#8CB9A2"),a=ne(e==="error"?"#e31507":e==="success"?"#0de309":"#8CB9A2");return i.jsx("div",{style:{background:n,color:o,border:`2px solid ${a}`,padding:"12px 16px",textAlign:"center",fontFamily:"Courier New",fontSize:14,fontWeight:"bold",position:"relative",marginBottom:8,cursor:r?"pointer":"default",userSelect:"none",opacity:1,borderRadius:0,boxShadow:"0 2px 8px rgba(0,0,0,0.3)",letterSpacing:"0.5px",textTransform:"uppercase",minHeight:"44px",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(4px)"},onClick:r,"aria-label":r?"Dismiss notification":void 0,tabIndex:r?0:void 0,role:"alert",children:t})},de=({children:t,onClick:e,type:r="button",style:n={},disabled:o=!1,mobile:a=!1,...s})=>{const l=ne(o?"#444":"#000"),d=ne("#8CB9A2"),h=ne("#8CB9A2"),u=a?{minHeight:"44px",fontSize:"16px",padding:"12px 16px",borderRadius:"0",transition:"all 0.2s ease",":active":{backgroundColor:d,color:l}}:{};return i.jsx("button",{type:r,onClick:e,disabled:o,style:{backgroundColor:l,color:d,border:`1px solid ${h}`,padding:a?"12px 16px":"6px 16px",fontFamily:"Courier New",fontSize:a?"16px":"15px",cursor:o?"not-allowed":"pointer",opacity:o?.6:1,borderRadius:a?0:2,margin:a?"4px":"2px",minHeight:a?"44px":"auto",transition:"all 0.2s ease",...u,...n},...s,children:t})},Gn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAGSElEQVR4Xu2dsXMcNRjFpXWG8QwFlHSELiUlJWly8VCQNMxQ2Ng1FWPHlISSwRn/CRfsghJ3xmmcMmXo6HBJkSIzUHiGywotOExu4uN+n28VnbTvSvvtJ+l9b5+0WknrnX6DZsAPuvVqvJMABi4CCUACGDgDA2++HEACGDgDA2++HEACGDgDA2++HEACqI+BvZPxjdBee4+07N7a+mOCqxVTpQPsnRz8FBN2hyRtZ7RRJQek7R2mysbPFkDX3DDFjQRApVIQTg7AkzUwB3idGDkAF0sxSDkAT5UcQINArpZSkHIAnik5gByAq6UUpByAZ0oOIAfgasmJ3D8eX580zWbfdbg3+uJ+3zFLileMA+ydHMap3dBN8YKfv7szWj8CwMFDJICBS0ACkADKYEBdQJo8yQHS8FpMVAmgmFSlqagEkIbXYqJKAMWkKk1FJYA0vBYTVQIoJlVpKppdAA9ODn4jTYsr+VYjbmqlbxP/0F5ysW/d1vbaxkMS11D+k7h66HMS04LJXX52AcQ3d9OrNC3szcTyqWBD+UdRAHd7qd4rQXKXLwFwAUoAfau/i2e4AwzFywEoWXIAOQDVShqcHACPgZJ0QXIAOUCaO5tGlQPIAfQYyO4WdQGX8XT5ZJCeApimlmB3cIouwDITyMv3T0PrviLEhnby6+4nW78T7N6jw1OC8y6ctS/8DwRrKV+DQD4IJNxfYLgD0aCpVkQtsQBe38tPyYrGhlcFcwfgpVvKp1EHKABKzWU4CYAui19iB5AAXmVADmDSgxxADgB3BmkMYLqz+gfnTsCVyp+1EuU/ergDUUbVBVCm/sHxBFxJAHPrwsufG+oCIAFQpiQA0w2gpwBNBJluLQTu7Cq49kMC9s5/Q3BGzFFw4RdyTYryLVPRpI4d5vvjw499E9i0sWFRbBIHsBzRQgkoCzfwMYAEIAHgw5rLurNpbSUACQBORFFJFfUYqC5ADiAHkAOwDzZQCywLJweQA8gB5AB9upYGgX2ymTxWQV1Aiv3pDx4djENwm8l5XtYCvHvmg/uTVG97tPEBwd0/Ha++cz59PsKs695affvZlzc/Q+V7w+tQvDFBj4Ekpf9icn+yRgLguUqClACS0FpOUAmgnFwlqakEkITWAoJerCuUAArIVcoqSgAp2S0gtgRAkjR3GTYJspwYCWA589JfreaItxwBeP9459b6TcJMopnA5877p6R8F8KNiJs6VRRdlwFEBbB/On53cn4NLbQ1nQ9Q0ExglTORVADJXga9EQF0pwAtvv5YAkjw1bSSpoIlAAmAHdZc0suouruAfqz/5dAsuwMscmjNrPFl3QLod1SdXQD9Nsf2OrjsQWA/zEkAGgNoDMDuJb4kTU8BjNFkKI0BOLXqAnJ2AXEEfNa6gI4q9a75NH7qHU1b4vwbpqJTnE9wtfZ3n7TqXgbM/sVzDL4lHDTev08X2lrOJ7B0AaSeKTHYASyVeCMzoZYK9YJNMwbopWoLBJEAMHkSAKZKDpDkkCTMvwUoB8BsyQEwVXKAhRwgxez4zNzJAbCs5QCYKjnAQg6Aee4DKAfALMoBMFVyADkA/WwddqD8C1IMDrB/PL5ObpdJs/JRHPL9SLAWzEr7Yu7++NUY8I/WndMvcVnKp+3/y1B+olXRuFmmqWAa1bYggUbNvz+e15Qji3IA2iwJgDLlnATAucp+QoahqhgqAWCq1AUYqDJADYNAGlVdAGVKXQBnKiLpkihT0MxgdQGGBEgABrIwVF0ApioFUA5gYFUOYCALQxM4gOWjRbieERhaj84cCCuT57u3ttj5AJYKQKxlf37ThK/j/PJtGJrC8PkIbeu+2729/jMJjDdtp3oKIJW8wOC5eENMDK21/RIAlIAEEL8FGA27+w5Arp8cYMS2xlkSJAeAbMkB5ABVOqAcQA7AGKjVAlnru/n9OsdAcgCoAAmg0jsA5l8OUOsdIAFABrrFk5Om2STwFOcDWPbnkzpaMZb9+ZbY+HyA1p9tr208tMQmWDwGIMFeYvK/DbPUNi8298uwZAKI52Lc6c7H0O//GahWALHZceJEv3kMSADzGKr8/xJAVQm2b5eXAKoSgL0xEoCds6quGKQAKv4GlFmcgxSAmSXjBfae2FhAj3AJoEcySwyVWwB/A6OnkMyQojWgAAAAAElFTkSuQmCC",Yn="/assets/logoblack-1754043543625.png",St=()=>{const[t,e]=S.useState(""),[r,n]=S.useState("info"),[o,a]=S.useState(null);S.useEffect(()=>()=>{o&&clearTimeout(o)},[o]);const s=S.useCallback((d,h="info")=>{if(o&&clearTimeout(o),e(d),n(h),d){const u=setTimeout(()=>{e(""),n("info")},4e3);a(u)}},[o]),l=S.useCallback(()=>{o&&(clearTimeout(o),a(null)),e(""),n("info")},[o]);return{notification:t,notificationType:r,setNotification:s,setNotificationType:n,clearNotification:l}},br=t=>t.toString().toLowerCase().trim().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-"),_e="rgb(140,185,162)",Aa=({watchlists:t={},setWatchlists:e})=>{const r=it(),n=dt(),[o,a]=S.useState("terminal"),{notification:s,notificationType:l,setNotification:d,setNotificationType:h}=St(),[u,f]=S.useState(!1),[x,b]=S.useState(!1),k="MAX",[T,w]=S.useState(!1),[v,y]=S.useState(null),{isInverted:C,toggleTheme:A}=ut(),R=ne(_e),Y=ne("black"),g=ne("#e31507"),P=ne("#888"),E=S.useMemo(()=>{const O=Object.values(t).flatMap(K=>(K.items||[]).map(le=>le.symbol)).filter(K=>K&&typeof K=="string"&&!K.startsWith("#"));return Array.from(new Set(O.map(K=>K.toUpperCase())))},[t]),[_,U]=S.useState(()=>{const O=localStorage.getItem("burnlist_fetch_count");return O?parseInt(O,10):0});function W(){const O=new Date,K=new Date(O.toLocaleString("en-US",{timeZone:"America/New_York"}));return K.getHours()===9&&K.getMinutes()===29}S.useEffect(()=>{const O=setInterval(()=>{W()&&(U(0),localStorage.setItem("burnlist_fetch_count","0"))},6e4);return()=>clearInterval(O)},[]);const $=O=>{if(!O)return"Unknown";try{const K=new Date(O),le=String(K.getDate()).padStart(2,"0"),N=String(K.getMonth()+1).padStart(2,"0"),m=String(K.getFullYear()).slice(-2);return`${le}-${N}-${m}`}catch{return"Unknown"}};S.useEffect(()=>()=>{Me.cancelFetch("homepage")},[]);const I=()=>{b(!0),setTimeout(()=>b(!1),150);const O=qr[Math.floor(Math.random()*qr.length)],K=br(O);if(Object.values(t).some(B=>B.name&&B.name.toLowerCase()===O.toLowerCase())){d("‚ö†Ô∏è Name already exists"),h("error");return}const N={id:Jt(),name:O,slug:K,items:[],reason:"",createdAt:new Date().toISOString()},m={...t,[N.id]:N};e(m),localStorage.setItem("burnlist_watchlists",JSON.stringify(m)),d("")},q=O=>{const K=Object.keys(t).find(m=>t[m].id===O);if(!K){c.log("üóëÔ∏è Could not find watchlist with id:",O);return}const{[K]:le,...N}=t;e(N),localStorage.setItem("burnlist_watchlists",JSON.stringify(N)),le?c.log("üóëÔ∏è Deleted watchlist:",le.name):c.log("üóëÔ∏è Deleted watchlist with id:",O)};S.useCallback((O,K)=>{if(Object.values(t).some(N=>N.id!==O&&N.name&&N.name.toLowerCase()===K.toLowerCase())){d("‚ö†Ô∏è Name already exists"),h("error");return}e(N=>{const m={...N};return m[O]&&(m[O]={...m[O],name:K,slug:br(K)}),localStorage.setItem("burnlist_watchlists",JSON.stringify(m)),m})},[e,t]);const H=S.useCallback((O,K)=>{const le={...t,[O]:{...t[O],reason:K}};e(le),localStorage.setItem("burnlist_watchlists",JSON.stringify(le))},[e,t]),z=()=>{try{const O={};for(let B=0;B<localStorage.length;B++){const L=localStorage.key(B);if(L)try{const J=localStorage.getItem(L);try{O[L]=JSON.parse(J)}catch{O[L]=J}}catch(J){c.warn(`Could not export localStorage key: ${L}`,J)}}const K={localStorage:O,exportInfo:{timestamp:new Date().toISOString(),totalKeys:Object.keys(O).length,keys:Object.keys(O)}},le=JSON.stringify(K,null,2),N=new Blob([le],{type:"application/json"}),m=document.createElement("a");m.href=URL.createObjectURL(N),m.download=`burnlist_complete_backup_${new Date().toISOString().split("T")[0]}.json`,m.click(),d(`‚úÖ All localStorage data exported (${Object.keys(O).length} keys)`,"success")}catch(O){c.error("Export error:",O),d("‚ùå Export failed","error")}},V=O=>{const K=O.target.files[0];if(!K)return;const le=new FileReader;le.onload=N=>{try{const m=JSON.parse(N.target.result);if(m.localStorage&&m.exportInfo){const B=m.localStorage;let L=0;if(Object.keys(B).forEach(J=>{try{const Q=B[J];typeof Q=="string"?localStorage.setItem(J,Q):localStorage.setItem(J,JSON.stringify(Q)),L++}catch(Q){c.warn(`Could not import localStorage key: ${J}`,Q)}}),B.burnlist_watchlists)try{const J=typeof B.burnlist_watchlists=="string"?JSON.parse(B.burnlist_watchlists):B.burnlist_watchlists;e(J)}catch(J){c.warn("Could not parse watchlists data",J)}if(B.burnlist_fetch_count)try{const J=typeof B.burnlist_fetch_count=="string"?parseInt(B.burnlist_fetch_count):B.burnlist_fetch_count;U(J)}catch(J){c.warn("Could not parse fetch count data",J)}d(`‚úÖ Complete backup imported (${L} keys)`,"success")}else{if(!m.watchlists||typeof m.watchlists!="object")throw new Error("Invalid data format: missing watchlists");e(m.watchlists),localStorage.setItem("burnlist_watchlists",JSON.stringify(m.watchlists)),m.fetchCount!==void 0&&(U(m.fetchCount),localStorage.setItem("burnlist_fetch_count",String(m.fetchCount))),m.tradeJournalTrades&&Array.isArray(m.tradeJournalTrades)&&localStorage.setItem("trade_journal_trades",JSON.stringify(m.tradeJournalTrades)),d("‚úÖ Legacy data imported successfully","success")}}catch(m){c.error("Import error:",m),d("‚ùå Import failed: Invalid file format","error")}},le.readAsText(K),O.target.value=""},[ee,ge]=S.useState({});S.useEffect(()=>{if(u){const O={};Object.values(t).forEach(K=>{O[K.id]={value:K.name,prev:K.name}}),ge(O)}else ge({})},[u,t]);const ve=(O,K)=>{ge(le=>({...le,[O]:{...le[O],value:K}}))},ye=O=>{var N;const K=((N=ee[O])==null?void 0:N.value)||"";if(Object.values(t).some(m=>m.id!==O&&m.name&&m.name.toLowerCase()===K.toLowerCase())){d("‚ö†Ô∏è Name already exists"),h("error"),ge(m=>({...m,[O]:{...m[O],value:m[O].prev}}));return}e(m=>{const B={...m};return B[O]&&(B[O]={...B[O],name:K,slug:br(K)}),localStorage.setItem("burnlist_watchlists",JSON.stringify(B)),B}),ge(m=>({...m,[O]:{...m[O],prev:K}}))},Ce=S.useMemo(()=>Object.values(t),[t]),Ie=S.useMemo(()=>Ce.map(O=>{const K=O.items||[];if(!K.length)return 0;const le=K.map(N=>{var J,Q;const m=N.historicalData;if(!Array.isArray(m)||m.length<2)return 0;const B=(J=m[0])==null?void 0:J.price,L=(Q=m[m.length-1])==null?void 0:Q.price;return typeof B!="number"||typeof L!="number"||B===0?0:(L-B)/B*100});return le.reduce((N,m)=>N+m,0)/le.length}),[Ce]),fe=S.useRef(null);return i.jsx("div",{style:{fontFamily:"Courier New",color:R,backgroundColor:Y,minHeight:"100vh",padding:"0",transition:"background 0.3s, color 0.3s"},children:i.jsxs("div",{style:{padding:"32px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:24,flexWrap:"wrap",gap:"12px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},title:"Test tooltip - hover to see if tooltips work",children:[i.jsx("button",{onClick:A,style:{border:"none",background:"none",padding:0,cursor:"pointer",display:"flex",alignItems:"center",minHeight:"44px"},"aria-label":"Toggle theme",children:i.jsx("img",{src:C?Yn:Gn,alt:"Burnlist Logo",style:{width:40,height:40,marginRight:10,transition:"filter 0.3s"}})}),i.jsx("strong",{style:{fontSize:"170%",lineHeight:"40px",display:"inline-block",color:R},children:"BURNLIST v1.1"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[i.jsx("span",{style:{color:g,fontWeight:"bold",fontSize:12},children:E.length}),i.jsx("span",{style:{color:R,fontWeight:"bold",fontSize:12},children:_}),i.jsx("span",{onClick:()=>{const O=JSON.parse(localStorage.getItem("burnlist_watchlists"));c.log("üß™ Current localStorage burnlist_watchlists:",O)},style:{cursor:"pointer",color:R},children:"ACCOUNT: local"})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"10px 20px",borderBottom:`1px solid ${_e}`,background:"rgba(0,0,0,0.3)",gap:"10px",marginBottom:"20px"},children:[i.jsx(de,{onClick:()=>r("/universes"),style:{background:n.pathname==="/universes"||n.pathname.startsWith("/universe/")?_e:"transparent",color:n.pathname==="/universes"||n.pathname.startsWith("/universe/")?"#000000":_e,border:`1px solid ${_e}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"UNIVERSE"}),i.jsx(de,{onClick:()=>r("/journal"),style:{background:n.pathname==="/journal"?_e:"transparent",color:n.pathname==="/journal"?"#000000":_e,border:`1px solid ${_e}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"JOURNAL"}),i.jsx(de,{onClick:()=>r("/market"),style:{background:n.pathname==="/market"?_e:"transparent",color:n.pathname==="/market"?"#000000":_e,border:`1px solid ${_e}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"MARKET"}),i.jsx(de,{onClick:()=>a(o==="terminal"?"graph":"terminal"),style:{background:o==="graph"?_e:"transparent",color:o==="graph"?"#000000":_e,border:`1px solid ${_e}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"GRAPH VIEW"})]}),s&&i.jsx("div",{style:{position:"fixed",top:24,left:0,right:0,zIndex:10001,display:"flex",justifyContent:"center",pointerEvents:"none"},children:i.jsx("div",{style:{minWidth:320,maxWidth:480,pointerEvents:"auto"},children:i.jsx(Je,{message:s,type:l,onClose:()=>d("")})})}),T&&i.jsx(Je,{message:"Loading watchlists...",type:"loading"}),v&&i.jsx(Je,{message:v,type:"error",onClose:()=>y(null)}),Object.keys(t).length===0&&i.jsx("p",{children:"No watchlists found."}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(252px, 252px))",rowGap:"20px",columnGap:"20px",margin:"70px 0 1px 0",justifyContent:"center",alignItems:"start"},children:Ce.map((O,K,le)=>{var me;const N=O.items||[],m=Ie[K],B=m>=0;let L=null,J=null,Q=N.length===0?"None":"LOW";if(N.length>0){const ae=N.map(te=>{var ke,Ae;const xe=te.historicalData;if(!Array.isArray(xe)||xe.length<2)return{symbol:te.symbol,return:0};const pe=(ke=xe[0])==null?void 0:ke.price,we=(Ae=xe[xe.length-1])==null?void 0:Ae.price;if(typeof pe!="number"||typeof we!="number"||pe===0)return{symbol:te.symbol,return:0};const Le=(we-pe)/pe*100;return{symbol:te.symbol,return:Le}});L=ae.reduce((te,xe)=>xe.return>te.return?xe:te,ae[0]),J=ae.reduce((te,xe)=>xe.return<te.return?xe:te,ae[0]);const be=Math.min(...ae.map(te=>te.return)),se=Math.max(...ae.map(te=>te.return))-be;be<-20||se>50?Q="HIGH":be<-10||se>30?Q="MED":Q="LOW"}let X="Unknown";if(N.length>0){const ae=N.flatMap(be=>{var ue;return((ue=be.historicalData)==null?void 0:ue.map(se=>new Date(se.timestamp).getTime()))||[]});if(ae.length>0){const be=Math.max(...ae),ue=Date.now(),se=Math.floor((ue-be)/(1e3*60*60));se<1?X="Just now":se<24?X=`${se}h ago`:X=`${Math.floor(se/24)}d ago`}}const Z=i.jsxs("div",{style:{width:"100%",maxWidth:252,height:u?160:o==="graph"?200:120,fontFamily:"Courier New",background:"transparent",padding:"10px 8px",margin:0,border:`1px solid ${R}`,borderRadius:0,boxShadow:"none",display:"flex",flexDirection:"column",alignItems:"stretch",justifyContent:"flex-start",position:"relative",boxSizing:"border-box",overflow:"hidden"},children:[u?i.jsx("input",{value:((me=ee[O.id])==null?void 0:me.value)??O.name,onChange:ae=>ve(O.id,ae.target.value),onBlur:()=>ye(O.id),onKeyDown:ae=>{ae.key==="Enter"&&(ae.preventDefault(),ye(O.id))},style:{fontFamily:"Courier New",fontSize:16,color:R,background:"transparent",border:`1px solid ${R}`,marginBottom:2,padding:"2px 4px",width:"100%",fontWeight:"bold",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",minHeight:"24px"}}):i.jsx("div",{style:{fontSize:18,color:R,fontWeight:"bold",marginBottom:4,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer"},title:`Watchlist: ${O.name||`PORTFOLIO ${K+1}`} | Stocks: ${N.length} | Created: ${$(O.createdAt)}`,onClick:()=>r(`/burn/${O.slug}`),children:O.name||`PORTFOLIO ${K+1}`}),u&&i.jsx("button",{onClick:()=>q(O.id),style:{backgroundColor:"transparent",color:g,border:`1px solid ${g}`,padding:"1px 4px",marginBottom:2,fontSize:9,width:"100%",fontWeight:"bold",fontFamily:"Courier New",cursor:"pointer",minHeight:"16px"},title:"Delete this watchlist",children:"DELETE"}),u?i.jsx("input",{value:O.reason||"",onChange:ae=>H(O.id,ae.target.value),style:{fontFamily:"Courier New",fontSize:12,color:R,background:"transparent",border:`1px solid ${R}`,marginBottom:2,padding:"1px 3px",width:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",minHeight:"18px"},placeholder:"Reason..."}):o!=="graph"&&i.jsx("div",{style:{fontSize:14,color:R,marginBottom:4,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:O.reason||"N/A"}),i.jsxs("div",{style:{fontSize:13,color:R,marginBottom:2,cursor:"help"},title:`Risk Level: ${Q} | Best: ${(L==null?void 0:L.symbol)||"N/A"} | Worst: ${(J==null?void 0:J.symbol)||"N/A"}`,children:[N.length," stocks | Risk: ",Q]}),i.jsx("div",{style:{fontSize:11,color:P,marginBottom:2,cursor:"help"},title:`Last Update: ${X} | Data Age: ${X}`,children:X}),o!=="graph"&&N.length>0&&i.jsxs("div",{style:{fontSize:19,color:B?R:g,fontWeight:"bold",cursor:"help"},title:`Return: ${m>=0?"+":""}${m.toFixed(2)}% | Timeframe: MAX`,children:[m>=0?"+":"",m.toFixed(2),"%"]}),o==="graph"&&N.length>0&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{fontSize:19,color:B?R:g,fontWeight:"bold",marginBottom:2},children:[m>=0?"+":"",m.toFixed(2),"%"]}),i.jsx("div",{style:{width:"100%",maxWidth:180,height:94,alignSelf:"flex-end",border:`1.5px solid ${R}`,borderRadius:0,background:"transparent",padding:1,marginTop:2,display:"flex",justifyContent:"flex-end",alignItems:"flex-end"},children:i.jsx(bn,{portfolioReturnData:N.map(ae=>({symbol:ae.symbol,buyDate:ae.buyDate,historicalData:ae.historicalData,timeframe:k})),showBacktestLine:!1,height:94,lineColor:B?R:g,hideAxes:!0,hideBorder:!0,showTooltip:!1,mini:!0})})]})]});return i.jsx("div",{style:{margin:0},children:u?Z:i.jsx(Zt,{to:`/watchlist/${O.slug}`,style:{textDecoration:"none",color:"inherit"},children:Z})},O.id)})}),i.jsxs("div",{className:"action-buttons-container",children:[i.jsx("style",{children:`
            .action-buttons-container {
              position: fixed;
              bottom: 20px;
              right: 20px;
              display: flex;
              gap: 8px;
              z-index: 1000;
            }
            
            @media (max-width: 768px) {
              .action-buttons-container {
                position: fixed;
                top: 50%;
                right: 10px;
                transform: translateY(-50%);
                flex-direction: column;
                gap: 8px;
              }
            }
            
            @media (max-width: 480px) {
              .action-buttons-container {
                position: fixed;
                top: 50%;
                right: 8px;
                transform: translateY(-50%);
                flex-direction: column;
                gap: 6px;
              }
            }
            
            .action-button {
              background: ${Y};
              color: ${R};
              border: 1px solid ${R};
              font-size: 12px;
              padding: 6px 12px;
              box-shadow: 0 2px 4px rgba(0,0,0,0.3);
              min-height: 32px;
              font-family: 'Courier New', monospace;
              cursor: pointer;
              text-decoration: none;
              display: flex;
              align-items: center;
              justify-content: center;
            }
            
            @media (max-width: 768px) {
              .action-button {
                font-size: 10px;
                padding: 6px 8px;
                min-height: 32px;
                width: 60px;
              }
            }
            
            @media (max-width: 480px) {
              .action-button {
                font-size: 9px;
                padding: 4px 6px;
                min-height: 28px;
                width: 50px;
              }
            }
          `}),i.jsx("button",{onClick:I,className:"action-button",style:{backgroundColor:R,color:Y,fontWeight:"bold",fontSize:"14px",transition:"all 0.2s ease-in-out",padding:"8px 16px"},children:"+++"}),i.jsx("button",{onClick:()=>{f(!u),c.log("üõ†Ô∏è Edit mode:",!u)},className:"action-button",style:{textTransform:"lowercase",fontWeight:400,letterSpacing:1},children:u?"done":"edit"}),i.jsx("input",{type:"file",accept:".json",onChange:V,style:{display:"none"},ref:fe}),i.jsx("button",{onClick:()=>fe.current&&fe.current.click(),className:"action-button",style:{textTransform:"lowercase",fontWeight:400,letterSpacing:1},children:"import"}),i.jsx("button",{onClick:z,className:"action-button",style:{textTransform:"lowercase",fontWeight:400,letterSpacing:1},children:"export"})]})]})})},Qn="/assets/backbutton-1754043543625.png",$a="rgb(140,185,162)",ja=({name:t,averageReturn:e,selected:r,setWatchlists:n,notification:o,onNotificationClose:a,onRefresh:s,realStockCount:l,etfPriceData:d,twapData:h})=>{const{isInverted:u}=ut(),f=ne($a),x=ne("black"),b=ne("#e31507"),k=ne("#FFA500"),T=ne("#888");c.debug("üìä WatchlistHeader received averageReturn:",e),(Number.isFinite(e)?e:null)===null&&c.debug("‚ö†Ô∏è averageReturn is invalid:",e);const v=l||0,{slug:y}=Or(),[C,A]=S.useState(!1),[R,Y]=S.useState(null),[g,P]=S.useState(""),[E,_]=S.useState(null);S.useEffect(()=>{const W=()=>{const I=Me.getWatchlistRequestStatus(y);_(I)};W();const $=setInterval(W,1e3);return()=>clearInterval($)},[y]),S.useEffect(()=>{const W=()=>{var q,H;const I=Me.getFetchStatus(y);if(I&&I.status==="active"){const z=(H=(q=Me.activeFetches)==null?void 0:q.get)==null?void 0:H.call(q,y);let V=null,ee=null;z&&z.lastProgress&&(V=z.lastProgress.tickersFetched,ee=z.lastProgress.totalTickers),Y({tickersFetched:V,totalTickers:ee}),A(!0)}else Y(null),A(!1)};W();const $=setInterval(W,1e3);return()=>clearInterval($)},[y]),S.useEffect(()=>{const W=Me.startFetch;return Me.startFetch=async function($,I,q,H){return W.call(this,$,I,(z,V)=>{this.activeFetches&&this.activeFetches.get($)&&(this.activeFetches.get($).lastProgress=V),typeof q=="function"&&q(z,V)},H)},()=>{Me.startFetch=W}},[]);const U=async()=>{const W=Me.getFetchStatus(y);if(W&&W.status==="active"){Me.cancelFetch(y),P("Fetch cancelled"),setTimeout(()=>P(""),3e3);return}s&&typeof s=="function"?(console.log("üîÑ Refresh requested from header - calling parent"),s()):console.log("üîÑ Refresh requested from header - no parent handler")};return S.useEffect(()=>{if(t&&Array.isArray(t.items)){const W=t.items.filter($=>$.type==="real");setRealStockCount(W.length),console.log("üìä Real stocks count:",W.length)}},[t]),i.jsxs("div",{style:{display:"flex",flexDirection:"column",width:"100%",position:"fixed",top:0,left:0,zIndex:1e4},children:[o&&i.jsx(Je,{notification:o,handleNotificationClose:a}),g&&i.jsx(Je,{notification:g,handleNotificationClose:()=>P("")}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"1.5rem 2rem",backgroundColor:x,color:f,fontFamily:"'Courier New', Courier, monospace",width:"100%"},children:[i.jsx("div",{style:{},children:i.jsx("a",{href:"/",style:{display:"flex",alignItems:"center",textDecoration:"none",border:"none",background:"none",padding:0,gap:0,minHeight:"44px"},"aria-label":"back to home",children:i.jsx("img",{src:Qn,alt:"back",style:{width:22,height:22,filter:u?"invert(1)":"none"}})})}),i.jsxs("div",{style:{textAlign:"right",paddingRight:"3.5rem",maxWidth:"60%"},children:[i.jsx("h1",{style:{margin:0,marginTop:"8px",fontSize:"2rem",whiteSpace:"nowrap",color:f,cursor:"pointer",textDecoration:"underline",textUnderlineOffset:"4px",transition:"color 0.2s",minHeight:"44px",display:"flex",alignItems:"center"},onClick:U,title:C?"Cancel refresh":"Refresh watchlist",tabIndex:0,onKeyDown:W=>{(W.key==="Enter"||W.key===" ")&&U()},role:"button","aria-pressed":C,children:t||"Untitled Watchlist"}),R&&E&&i.jsxs("div",{style:{marginTop:"0.5rem",fontSize:"0.8rem",color:E.current>0?k:T,cursor:E.current>0?"help":"default"},title:E.current>0?"API requests in progress - waiting 1 minute between batches":"",children:[E.current,"/",v," (",Math.round(E.current/v*100),"%)"]}),i.jsx("div",{style:{marginTop:"0.5rem",fontSize:"0.8rem"},children:R&&typeof R.tickersFetched=="number"&&typeof R.totalTickers=="number"&&i.jsxs("span",{style:{color:b,fontWeight:"bold"},children:[R.tickersFetched,"/",R.totalTickers]})})]})]})]})},Ta="rgb(140,185,162)",Pa=({selected:t,onChange:e})=>{const r=ne(Ta),n=ne("black");return i.jsx("div",{style:{marginTop:10,marginBottom:10,display:"flex",gap:12,alignItems:"center",padding:"6px"},children:["D","W","M","YTD","Y","MAX"].map(o=>i.jsx("button",{onClick:()=>{console.log("üéØ [TIMEFRAME SELECTOR] User clicked timeframe:",o),console.log("üéØ [TIMEFRAME SELECTOR] Previous timeframe was:",t),e(o),console.log("üéØ [TIMEFRAME SELECTOR] onChange called with:",o)},style:{backgroundColor:t===o?r:"transparent",color:t===o?n:r,border:`1px solid ${r}`,height:"32px",minHeight:"32px",maxHeight:"32px",width:"40px",fontFamily:"'Courier New', Courier, monospace",fontSize:"0.9rem",cursor:"pointer",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"center",boxSizing:"border-box",margin:0,padding:0},children:o},o))})};function Xn(t,e="MAX"){const r=S.useRef(!1);return S.useEffect(()=>{r.current=!0},[]),S.useMemo(()=>{if(c.debug("useAverageReturn called with items:",t),t.forEach((l,d)=>{const h=Array.isArray(l.historicalData)&&l.historicalData.length>0,u=!isNaN(Number(l.buyPrice));(!h||!u)&&c.warn(`‚ö†Ô∏è Item ${d} is malformed:`,{symbol:l.symbol,buyPrice:l.buyPrice,historicalData:l.historicalData})}),c.debug(`[useAverageReturn] Calculating for timeframe: ${e}`),c.debug("[useAverageReturn] Input items:",t.length),!Array.isArray(t)||t.length===0)return r.current&&c.warn("‚ö†Ô∏è useAverageReturn received invalid or empty items"),0;t.some(l=>!l.buyDate)&&c.warn("‚ö†Ô∏è Some items are missing buyDate. This may cause invalid return calculations.");const o=t.filter((l,d)=>{const h=Array.isArray(l.historicalData)&&l.historicalData.length>=1,u=!isNaN(Number(l.buyPrice))&&Number(l.buyPrice)>0,f=!!l.buyDate&&new Date(l.buyDate).toString()!=="Invalid Date";return h?u?f?!0:(c.warn(`‚ö†Ô∏è Skipping item ${d} (${l.symbol}): invalid buyDate`,l.buyDate),!1):(c.warn(`‚ö†Ô∏è Skipping item ${d} (${l.symbol}): invalid buyPrice`,l.buyPrice),!1):(c.warn(`‚ö†Ô∏è Skipping item ${d} (${l.symbol}): insufficient historicalData`,l.historicalData),!1)});c.debug(`Proceeding with ${o.length} valid items (filtered ${t.length-o.length})`);const a=ma.calculateWatchlistReturn(o,e);if(a===null)return c.warn("‚ö†Ô∏è useAverageReturn: No valid return calculated"),0;const s=parseFloat(a.toFixed(2));return c.debug(`useAverageReturn result (${e}): ${s}%`),Number.isFinite(s)?s:0},[t,e,t.map(n=>n.buyPrice).join(","),JSON.stringify({timeframe:e,itemsLength:t.length})])}const Tr=new Set,Tt=new Set;async function Ea(){try{console.log("üìä NASDAQ symbol loading disabled (CORS issues) - using fallback"),["AAPL","MSFT","GOOGL","GOOG","AMZN","TSLA","META","NVDA","NFLX","ADBE","CRM","PYPL","INTC","AMD","QCOM","AVGO","TXN","MU","AMAT","KLAC","LRCX","ASML","TSM","NVDA","AMD","INTC","QCOM","AVGO","TXN","MU","AMAT","KLAC","LRCX","ASML","TSM","AAPL","MSFT","GOOGL","GOOG","AMZN","TSLA","META","NVDA","NFLX","ADBE","CRM","PYPL","INTC","AMD","QCOM"].forEach(e=>Tr.add(e)),console.log(`üìä Loaded ${Tr.size} NASDAQ symbols from fallback list`)}catch(t){console.warn("‚ö†Ô∏è Error loading NASDAQ symbols:",t)}}async function Na(){try{const t=await fetch("/twelvedata-api-server/flat-ui__data-Wed Jul 30 2025.json");if(!t.ok){console.warn("‚ö†Ô∏è Could not fetch NYSE symbols, using fallback");return}(await t.json()).forEach(r=>{r["ACT Symbol"]&&r["ACT Symbol"].trim()&&Tt.add(r["ACT Symbol"].trim())}),console.log(`üìä Loaded ${Tt.size} NYSE symbols from official data`)}catch(t){console.warn("‚ö†Ô∏è Error loading NYSE symbols:",t),["SPY","QQQ","IWM","VTI","VOO","VEA","VWO","BND","GLD","SLV","USO","TLT","TBT","TMF","TMV","UVXY","VXX","XLE","XLF","XLK","XLV","XLI","XLP","XLY","XLU","XLB","XLC","XBI","IBB","SOXL","SOXS","TQQQ","SQQQ","LABU","LABD","DPST","WDRN","JNUG","JDST","NUGT","DUST","YANG","YINN","ERX","ERY","FAS","FAZ","TNA","TZA","UPRO","SPXU","UDOW","SDOW","UMDD","SMDD","URTY","SRTY","JPM","BAC","WFC","C","GS","MS","AIG","GE","XOM","CVX","KO","PEP","WMT","HD","MCD","DIS","NKE","BA","CAT","MMM","IBM","INTC","CSCO","ORCL","VZ","T","ATT","CMCSA","CMCSK"].forEach(r=>Tt.add(r)),console.log(`üìä Loaded ${Tt.size} NYSE symbols from fallback list`)}}let cn=!1;async function Kn(){cn||(await Ea(),await Na(),cn=!0)}async function Ra(t){if(!t)return"NASDAQ";await Kn();const e=t.toUpperCase();if(Tr.has(e))return"NASDAQ";if(Tt.has(e))return"NYSE";try{const r=await fetch(`https://query1.finance.yahoo.com/v8/finance/chart/${e}`);if(!r.ok)return console.warn(`‚ö†Ô∏è Could not fetch exchange info for ${t}, using pattern detection`),zt(e);const n=await r.json();if(n.chart&&n.chart.result&&n.chart.result[0]){const o=n.chart.result[0];if(o.meta&&o.meta.exchangeName){const a=o.meta.exchangeName.toUpperCase();return a.includes("NASDAQ")?"NASDAQ":a.includes("NYSE")||a.includes("NEW YORK")?"NYSE":a.includes("AMEX")||a.includes("ARCA")?"AMEX":zt(e)}}return zt(e)}catch(r){return console.warn(`‚ö†Ô∏è Error fetching exchange info for ${t}:`,r),zt(e)}}function zt(t){return t.length>=4&&t.length<=5?"NASDAQ":t.length===3?"NYSE":"NASDAQ"}const wr=new Map;async function _r(t){const e=t.toUpperCase();if(wr.has(e))return wr.get(e);const r=await Ra(e);return wr.set(e,r),r}Kn();const yt=t=>{if(!t)return"-";const e=new Date(t);if(isNaN(e.getTime()))return"-";const r=String(e.getDate()).padStart(2,"0"),n=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getFullYear()).slice(-2);return`${r}-${n}-${o}`},Ia="rgb(140,185,162)",Oa=({item:t,index:e,editMode:r,handleChangeSymbol:n,handleBuyPriceChange:o,handleBuyDateChange:a,handleRevertBuyDate:s,handleFetchHistoricalData:l,handleDelete:d,handleRefreshPrice:h,items:u,changePercent:f,lookedUpBuyPrice:x})=>{var Y;const b=ne(Ia),k=ne("black"),T=ne("#e31507");if(c.debug("TickerRow received item:",t),c.debug("Historical Data:",t.historicalData),!t||!Array.isArray(t.historicalData))return c.warn("‚õî Invalid item or missing historicalData for row",t),null;let w=NaN;if(!isNaN(Number(t.buyPrice)))w=Number(t.buyPrice),c.debug(`Using stored buyPrice: ${w}`);else if(t.historicalData&&t.historicalData.length>0){const g=t.historicalData[0],P=t.historicalData[t.historicalData.length-1],E=t.historicalData.length===1||new Date(g==null?void 0:g.timestamp)<new Date(P==null?void 0:P.timestamp);E?w=Number(g==null?void 0:g.price):w=Number(P==null?void 0:P.price),c.debug(`Using oldest historical price as buyPrice: ${w} (data is ${E?"ascending":"descending"})`)}let v=NaN;if(t.historicalData&&t.historicalData.length>0){const g=t.historicalData[0],P=t.historicalData[t.historicalData.length-1],E=t.historicalData.length===1||new Date(g==null?void 0:g.timestamp)<new Date(P==null?void 0:P.timestamp);E?v=Number(P==null?void 0:P.price):v=Number(g==null?void 0:g.price),c.debug(`Data sort order: ${E?"ascending":"descending"}, latest price: ${v}`)}const y=typeof t.currentPrice=="number"?t.currentPrice:v;if(c.debug(`Buy price for ${t.symbol}:`,w),c.debug(`Latest price for ${t.symbol}:`,v),c.debug(`Current price for ${t.symbol}:`,y),c.debug(`[DEBUG PRICES] ${t.symbol}:`),c.debug("item.buyPrice (stored):",t.buyPrice),c.debug("Historical data length:",(Y=t.historicalData)==null?void 0:Y.length),t.historicalData&&t.historicalData.length>0){const g=t.historicalData[0],P=t.historicalData[t.historicalData.length-1];c.debug(`First historical point: ${g==null?void 0:g.timestamp} ‚Üí $${g==null?void 0:g.price}`),c.debug(`Last historical point: ${P==null?void 0:P.timestamp} ‚Üí $${P==null?void 0:P.price}`),c.debug("Are timestamps ascending?",new Date(g==null?void 0:g.timestamp)<new Date(P==null?void 0:P.timestamp))}if(isNaN(w))return c.warn(`‚õî Skipping row: No valid buy price resolved for ${t.symbol}`),null;c.debug(`[ChangePercent Prop] ${t.symbol}:`,f),c.debug(`Rendering row for ${t.symbol}`);const C=async g=>{if(g)try{const P=await _r(g),_=`https://www.tradingview.com/chart/i0seCgVv/?symbol=${encodeURIComponent(`${P}:${g.toUpperCase()}`)}`;window.open(_,"_blank")}catch(P){c.warn(`‚ö†Ô∏è Error opening chart for ${g}:`,P);const _=`https://www.tradingview.com/chart/i0seCgVv/?symbol=${encodeURIComponent(`NASDAQ:${g.toUpperCase()}`)}`;window.open(_,"_blank")}},R=(()=>{if(!t.historicalData||t.historicalData.length===0)return"Unknown";const g=t.historicalData[t.historicalData.length-1];if(!g||!g.timestamp)return"Unknown";const P=new Date(g.timestamp),_=new Date-P,U=Math.floor(_/(1e3*60*60));return U<1?"Just now":U<24?`${U}h ago`:`${Math.floor(U/24)}d ago`})();return i.jsxs("tr",{style:{borderBottom:`1px solid ${b}`,background:k},children:[i.jsx("td",{style:{padding:8,fontFamily:"'Courier New', Courier, monospace",color:b,fontSize:15},children:r?i.jsx("input",{type:"text",value:t.symbol,onChange:g=>n(e,g.target.value),style:{fontFamily:"'Courier New', Courier, monospace",fontSize:"1rem",backgroundColor:k,border:`1px solid ${b}`,color:b,padding:4,width:80,textTransform:"uppercase"},title:"Edit ticker symbol"}):i.jsx("span",{onClick:()=>C(t.symbol),style:{cursor:"pointer",textDecoration:"underline",display:"flex",alignItems:"center",gap:"4px"},title:`Click to open ${t.symbol} chart in new tab - Last updated: ${R}`,children:(()=>{if(u.filter(P=>P.symbol===t.symbol).length>1){const P=u.slice(0,e).filter(_=>_.symbol===t.symbol).length,E="*".repeat(P+1);return t.symbol+E}return t.symbol})()})}),i.jsx("td",{style:{padding:8,fontFamily:"'Courier New', Courier, monospace",color:b,fontSize:15},title:`${r?"Stored Buy Price":"Display Price"}: $${r?isNaN(w)?"N/A":w.toFixed(2):isNaN(x)?"N/A":x.toFixed(2)} | Buy Date: ${t.buyDate}`,children:r?i.jsx("input",{type:"number",value:isNaN(w)?"":w,step:"0.01",min:"0",onChange:g=>{typeof o=="function"&&o(e,parseFloat(g.target.value))},style:{fontFamily:"'Courier New', Courier, monospace",fontSize:"1rem",backgroundColor:k,border:`1px solid ${b}`,color:b,padding:4,width:80}}):isNaN(x)?"-":x.toFixed(2)}),i.jsx("td",{style:{padding:8,fontFamily:"'Courier New', Courier, monospace",color:b,fontSize:15},title:`Buy Date: ${t.buyDate} | Formatted: ${yt(t.buyDate)}${t.buyDateMetadata?" | Custom date":""}`,children:r?i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[i.jsx("input",{type:"date",value:t.buyDate?t.buyDate.slice(0,10):"",onChange:g=>{typeof a=="function"&&a(e,g.target.value)},style:{fontFamily:"'Courier New', Courier, monospace",fontSize:"1rem",backgroundColor:k,border:`1px solid ${b}`,color:b,padding:4,width:120}}),t.buyDateMetadata&&typeof s=="function"&&i.jsx("button",{onClick:()=>s(e),title:`Revert to original buy date: ${t.buyDateMetadata.originalBuyDate?yt(t.buyDateMetadata.originalBuyDate):"original"}`,style:{fontFamily:"'Courier New', Courier, monospace",fontSize:"0.8rem",backgroundColor:"transparent",border:`1px solid ${b}`,color:b,padding:"2px 6px",cursor:"pointer",borderRadius:2,minWidth:"auto",height:"auto"},onMouseOver:g=>{g.target.style.backgroundColor=b,g.target.style.color=k},onMouseOut:g=>{g.target.style.backgroundColor="transparent",g.target.style.color=b},children:"‚Ü∂"}),i.jsx("style",{children:`
                input[type="date"]::-webkit-calendar-picker-indicator {
                  filter: invert(1) brightness(0.8) sepia(1) saturate(5) hue-rotate(140deg);
                }
                input[type="date"]::-webkit-clear-button {
                  display: none !important;
                }
                input[type="date"]::-webkit-inner-spin-button {
                  display: none !important;
                }
              `})]}):i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[yt(t.buyDate),t.buyDateMetadata&&i.jsx("span",{style:{fontSize:"0.8rem",opacity:.7},title:"Custom buy date",children:"‚öô"})]})}),i.jsx("td",{style:{padding:8,fontFamily:"'Courier New', Courier, monospace",color:b,fontSize:15},title:`Current Price: $${isNaN(y)?"N/A":y.toFixed(2)} | Last updated: ${R}`,children:isNaN(y)?"-":y.toFixed(2)}),i.jsx("td",{style:{padding:8,fontFamily:"'Courier New', Courier, monospace",color:b,fontSize:15},children:(()=>{const g=Number(f);return isFinite(g)?i.jsxs("span",{title:`Return: ${g>=0?"+":""}${g.toFixed(2)}% | Timeframe: Selected timeframe`,style:{color:g>=0?b:T,fontFamily:"'Courier New', Courier, monospace"},children:[g.toFixed(2),"%"]}):i.jsxs(i.Fragment,{children:[c.warn("‚ö†Ô∏è Missing or invalid changePercent for",t.symbol),i.jsx("span",{title:"Change % not available",style:{color:ne("#888888"),fontFamily:"'Courier New', Courier, monospace"},children:"0.00%"})]})})()}),r&&i.jsx("td",{style:{padding:8},children:i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[i.jsx(de,{onClick:()=>{typeof l=="function"&&l(e)},style:{background:"transparent",color:b,border:`1px solid ${b}`,fontFamily:"'Courier New', monospace",textTransform:"lowercase",fontWeight:400,letterSpacing:1,boxShadow:"none",borderRadius:2,fontSize:"0.8rem",padding:"2px 6px"},title:"Fetch historical data for current buy date",children:"üìä"}),i.jsx(de,{onClick:()=>{typeof d=="function"&&d(e)},style:{background:"transparent",color:b,border:`1px solid ${b}`,fontFamily:"'Courier New', monospace",textTransform:"lowercase",fontWeight:400,letterSpacing:1,boxShadow:"none",borderRadius:2},children:"delete"})]})}),i.jsx("td",{})]},e)},Fa=nt.memo(Oa);function Ba(t,e){return S.useMemo(()=>{if(!(e!=null&&e.key))return c.log("‚ÑπÔ∏è No sort key provided, returning original items"),t;c.log(`üîÉ Sorting items by ${e.key} (${e.direction})`);const r=[...t].sort((n,o)=>{var h,u,f,x;const a=((u=(h=n.historicalData)==null?void 0:h[n.historicalData.length-1])==null?void 0:u.price)??0,s=((x=(f=o.historicalData)==null?void 0:f[o.historicalData.length-1])==null?void 0:x.price)??0;let l=e.key==="changePercent"?((typeof n.currentPrice=="number"?n.currentPrice:a)-n.buyPrice)/n.buyPrice*100:n[e.key],d=e.key==="changePercent"?((typeof o.currentPrice=="number"?o.currentPrice:s)-o.buyPrice)/o.buyPrice*100:o[e.key];return typeof l=="string"&&(l=l.toUpperCase()),typeof d=="string"&&(d=d.toUpperCase()),l<d?e.direction==="asc"?-1:1:l>d?e.direction==="asc"?1:-1:0});return c.log("‚úÖ Sorted items:",r),r},[t,e])}const Ma="rgb(140,185,162)",La=({children:t,style:e={}})=>{const r=ne(Ma),n=ne("black");return i.jsx("div",{className:"mobile-table-wrapper",style:{border:`1px solid ${r}`,background:n,...e},children:t})},Ua="rgb(140,185,162)",za=({items:t,editMode:e,handleChangeSymbol:r,handleBuyPriceChange:n,handleBuyDateChange:o,handleRevertBuyDate:a,handleFetchHistoricalData:s,handleDelete:l,handleRefreshPrice:d,selectedTimeframe:h})=>{const u=ne(Ua),f=ne("black");if(!Array.isArray(t))return c.warn("‚ö†Ô∏è TickerTable received invalid items prop:",t),null;const[x,b]=S.useState({key:"symbol",direction:"asc"}),k=y=>{c.log(`üß≠ handleSort triggered for key: ${y}`),b(C=>C.key===y?{key:y,direction:C.direction==="asc"?"desc":"asc"}:{key:y,direction:"asc"})},T=y=>x.key!==y?"":x.direction==="asc"?"‚Üë":"‚Üì",w=Ba(t,x),v=Xn(w);return c.log("üìä Average return from sortedItems:",v),typeof window<"u"&&typeof window.setWatchlistAverageReturn=="function"&&window.setWatchlistAverageReturn(v),i.jsx(La,{children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",color:u,background:f,fontFamily:"Courier New",minWidth:"600px","@media (max-width: 768px)":{minWidth:"500px"},"@media (max-width: 480px)":{minWidth:"400px"}},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{borderBottom:`1px solid ${u}`},children:[i.jsxs("th",{onClick:()=>k("symbol"),style:{cursor:"pointer",padding:"8px 4px",textAlign:"left",color:u,borderBottom:`1px solid ${u}`,fontFamily:"Courier New",background:f,minWidth:"60px","@media (max-width: 480px)":{padding:"4px 2px",minWidth:"50px"}},children:["Symbol ",T("symbol")]}),i.jsxs("th",{onClick:()=>k("buyPrice"),style:{cursor:"pointer",padding:"8px 4px",textAlign:"left",color:u,borderBottom:`1px solid ${u}`,fontFamily:"Courier New",background:f,minWidth:"80px","@media (max-width: 480px)":{padding:"4px 2px",minWidth:"60px"}},children:[h==="MAX"?"Buy Price":"Start Price"," ",T("buyPrice")]}),i.jsx("th",{style:{padding:"8px 4px",textAlign:"left",color:u,borderBottom:`1px solid ${u}`,fontFamily:"Courier New",background:f,minWidth:"80px","@media (max-width: 480px)":{padding:"4px 2px",minWidth:"60px"}},children:"Buy Date"}),i.jsxs("th",{onClick:()=>k("currentPrice"),style:{cursor:"pointer",padding:"8px 4px",textAlign:"left",color:u,borderBottom:`1px solid ${u}`,fontFamily:"Courier New",background:f,minWidth:"80px","@media (max-width: 480px)":{padding:"4px 2px",minWidth:"60px"}},children:["Current Price ",T("currentPrice")]}),i.jsxs("th",{onClick:()=>k("changePercent"),style:{cursor:"pointer",padding:"8px 4px",textAlign:"left",color:u,borderBottom:`1px solid ${u}`,fontFamily:"Courier New",background:f,minWidth:"80px","@media (max-width: 480px)":{padding:"4px 2px",minWidth:"60px"}},children:["Change % ",T("changePercent")]}),e&&i.jsx("th",{style:{padding:"8px 4px",textAlign:"left",color:u,borderBottom:`1px solid ${u}`,fontFamily:"Courier New",background:f,minWidth:"80px","@media (max-width: 480px)":{padding:"4px 2px",minWidth:"60px"}},children:"Actions"}),i.jsx("th",{style:{textAlign:"left",color:u,borderBottom:`1px solid ${u}`,fontFamily:"Courier New",background:f,width:"20px","@media (max-width: 480px)":{width:"10px"}}})]})}),i.jsx("tbody",{children:w.map((y,C)=>{var U,W;c.log(`ü©π Rendering row for ${y.symbol}`);let A;if(typeof y.buyPrice=="number"?A=y.buyPrice:Array.isArray(y.historicalData)&&y.historicalData.length>0?A=y.historicalData[0].price:typeof y.currentPrice=="number"&&(A=y.currentPrice),!y.historicalData||y.historicalData.length===0)return null;if(typeof A>"u"||!y.buyDate||!y.historicalData||!Array.isArray(y.historicalData)||y.historicalData.length===0)return c.warn(`‚ö†Ô∏è Invalid ticker data for ${y.symbol}. Skipping row.`,y),null;const R=y.buyDate&&new Date(y.buyDate).toString()!=="Invalid Date"?y.buyDate:null;c.debug(`[NEW LOGIC] ${y.symbol} in timeframe: ${h}`);let Y,g;if(h==="MAX"){if(c.debug(`[MAX MODE DEBUG] ${y.symbol}:`),c.debug(`  - Stored buyPrice: ${y.buyPrice}`),c.debug(`  - Stored buyDate: ${y.buyDate}`),c.debug(`  - Current price: ${y.currentPrice}`),c.debug(`  - Historical data points: ${((U=y.historicalData)==null?void 0:U.length)||0}`),((W=y.historicalData)==null?void 0:W.length)>0){const q=y.historicalData[0],H=y.historicalData[y.historicalData.length-1];c.debug(`  - First historical point: ${q.timestamp} ‚Üí $${q.price}`),c.debug(`  - Last historical point: ${H.timestamp} ‚Üí $${H.price}`)}const{startPoint:$,endPoint:I}=vr(y.historicalData,h,R,y.symbol,null);Y=$,g=I}else{c.debug(`[TIMEFRAME MODE] Using timeframe start price for ${h}, ignoring custom buy date for ${y.symbol}`);const{startPoint:$,endPoint:I}=vr(y.historicalData,h,null,y.symbol,null);Y=$,g=I}let P=0,E=y.buyPrice;if(Y&&typeof Y.price=="number"&&Y.price>0){h==="MAX"?(E=Y.price,c.debug(`[MAX PRICE] ${y.symbol}: Using startPoint.price (first historical price): ${E}`)):E=Y.price;let $;if(typeof y.currentPrice=="number")$=y.currentPrice;else if(g&&typeof g.price=="number")$=g.price;else return c.warn(`‚ö†Ô∏è No valid current price found for ${y.symbol}, skipping calculation`),null;let I;h==="MAX"?(I=Y.price,P=($-I)/I*100,c.debug(`[Table % MAX] ${y.symbol}: startPoint.price: ${I}, currentPrice: ${$}, changePercent: ${P}%`)):(I=Y.price,P=($-I)/I*100,c.debug(`[Table % ${h}] ${y.symbol}: startPoint: ${I}, currentPrice: ${$}, changePercent: ${P}%`)),c.debug(`[Table Price] ${y.symbol}: displayPrice: ${E} (${h==="MAX"?"buyPrice":"timeframe start price"})`),c.debug(`DEBUG ${y.symbol}: referencePrice=${I}, currentPrice=${$}, difference=${$-I}, calculation=${($-I)/I*100}`)}const _=t.findIndex($=>$.symbol===y.symbol&&$.buyDate===y.buyDate&&$.buyPrice===y.buyPrice);return i.jsx(Fa,{item:{...y},index:_,editMode:e,handleChangeSymbol:r,handleBuyPriceChange:typeof n=="function"?n:void 0,handleBuyDateChange:typeof o=="function"?o:void 0,handleRevertBuyDate:typeof a=="function"?a:void 0,handleFetchHistoricalData:typeof s=="function"?s:void 0,handleDelete:typeof l=="function"?l:void 0,handleRefreshPrice:typeof d=="function"?d:void 0,items:t,selectedTimeframe:h,changePercent:P,lookedUpBuyPrice:E},`${y.symbol}-${_}`)})})]})})},_a=nt.memo(za);var Wa={};const Ha=Wa.VITE_FINHUB_API_KEY||"d1leaapr01qt4thfm1a0d1leaapr01qt4thfm1ag";async function Va(t,e="d"){try{t=t.toUpperCase(),c.info(`üåê Requesting Finnhub quote for symbol: ${t}`);const r=`https://finnhub.io/api/v1/quote?symbol=${t}&token=${Ha}`,o=(await he.get(r)).data;if(!o||typeof o.c!="number"||typeof o.t!="number")return c.warn(`‚ùó Invalid quote data for ${t}:`,o),null;const a=Number(o.c),s=new Date(Number(o.t)*1e3).toISOString(),l=new Date().toISOString();c.info(`üì° fetchQuote ‚Üí ${t}: $${a} @ ${s}`);const d={price:a,timestamp:s,fetchTimestamp:l,symbol:t,volume:o.v||0,high:o.h||a,low:o.l||a,open:o.o||a,previousClose:o.pc||a};return{symbol:t,buyPrice:a,buyDate:s,historicalData:[d]}}catch(r){return r.response&&r.response.status===429?c.debug(`‚è≥ Rate limited for ${t} (429) - this is expected`):(c.error(`‚ùå fetchQuote error for ${t}:`,r),r.response?c.error(`‚ùå Server error for ${t}:`,{status:r.response.status,statusText:r.response.statusText,data:r.response.data}):r.request?c.error(`‚ùå Network error for ${t}:`,r.request):c.error(`‚ùå Other error for ${t}:`,r.message)),null}}function sr(t){return typeof t!="string"?"":t.trim().toUpperCase().replace(/\s+/g,"")}function Pr(t){const e=sr(t);return/^#?\w{1,10}$/.test(e)}async function Zn(t,e="real",r=null,n=null){if(!t||typeof t!="string")return c.error("‚ùå createTicker: Invalid symbol provided:",t),null;t=sr(t);const o=new Date().toISOString();try{c.log(`üåê Fetching real ticker data for ${t}`);const a=await Va(t);if(c.log(`üì• fetchQuote result for ${t}:`,a?"success":"failed"),!a||typeof a!="object"||!a.symbol||!a.historicalData)return c.warn(`‚ö†Ô∏è Skipping ${t}: malformed ticker object`,a),null;if(c.log(`‚úÖ Valid ticker data received for ${t}, historicalData length: ${a.historicalData.length}`),r!==null&&!isNaN(Number(r)))a.buyPrice=Number(r),c.log(`üí∞ Using custom buy price for ${t}: $${a.buyPrice}`);else{const l=a.historicalData[a.historicalData.length-1];a.buyPrice=l.price,c.log(`üí∞ Using current market price as buy price for ${t}: $${a.buyPrice}`)}if(n&&!isNaN(Date.parse(n)))a.buyDate=n,c.log(`üìÖ Using custom buy date for ${t}: ${a.buyDate}`);else{const l=a.historicalData[a.historicalData.length-1];a.buyDate=l.timestamp,c.log(`üìÖ Using current market date as buy date for ${t}: ${a.buyDate}`)}if(r!==null&&!isNaN(Number(r))||n&&!isNaN(Date.parse(n))){const l={price:a.buyPrice,timestamp:a.buyDate,fetchTimestamp:new Date().toISOString(),symbol:t},d=a.historicalData[a.historicalData.length-1];a.historicalData=[l,d],c.log(`üìä Created 2-point historical data for ${t}:`,a.historicalData)}a.addedAt=o,a.type="real";const s=zr(a);return c.log("‚úÖ createTicker returning real:",s),s}catch(a){return c.error(`‚ùå createTicker failed for ${t}:`,a),null}}const qa="rgb(140,185,162)",Ja=({bulkSymbols:t,setBulkSymbols:e,handleBulkAdd:r,buyDate:n,setBuyDate:o,buyPrice:a,setBuyPrice:s,setWatchlists:l,editMode:d,watchlists:h,setNotification:u,setNotificationType:f})=>{const[x,b]=S.useState(!1),[k,T]=S.useState(""),[w,v]=S.useState(""),[y,C]=S.useState(!1),A=S.useRef(),R=ne(qa),Y=ne("black"),g=()=>{if(!t.trim())return v(""),!1;const E=t.split(/[,	\s]+/).map(U=>U.trim().toUpperCase()).filter(Boolean);if(E.length===0)return v("Please enter valid ticker symbols."),!1;const _=E.filter(U=>!Pr(U));if(_.length>0)return v(`Invalid symbols: ${_.join(", ")}`),!1;if(d){if(a!==null&&(isNaN(a)||a<=0))return v("Buy price must be a positive number."),!1;if(n&&isNaN(Date.parse(n)))return v("Please enter a valid buy date."),!1}return v(""),!0};S.useEffect(()=>{w&&u&&f&&(u(w),f("error"))},[w,u,f]),S.useEffect(()=>(A.current&&clearTimeout(A.current),A.current=setTimeout(()=>{g()},300),()=>{A.current&&clearTimeout(A.current)}),[t,a,n,d,y]);const P=async()=>{var E;if(C(!0),!!g()){b(!0),T("");try{const U=t.split(/[,\s]+/).map(z=>z.trim().toUpperCase()).filter(Boolean).filter(Pr),W=window.location.pathname.split("/").pop(),$=h&&((E=Object.values(h).find(z=>z.slug===W))==null?void 0:E.items)||[],I=new Set($.map(z=>z.symbol)),q=U.find(z=>I.has(z));if(q){u&&f&&(u(`Ticker '${q}' already exists in this watchlist`),f("error")),b(!1);return}console.log("üì¶ Adding Tickers:",t),console.log("üìÖ With Buy Date:",n),console.log("üíµ With Buy Price:",a);const H=[];console.log(`üîç Processing ${U.length} valid symbols:`,U);for(const z of U){console.log(`üîÑ Processing symbol: ${z}`);const V=sr(z);if(console.log(`üìù Normalized symbol: ${V}`),I.has(V)){console.warn(`‚ö†Ô∏è Skipping duplicate symbol: ${V}`);continue}H.length>0&&(console.log("‚è≥ Waiting 5 seconds before next request..."),await new Promise(Ce=>setTimeout(Ce,5e3)));const ee=d&&typeof a=="number"&&!isNaN(a)?a:void 0,ge=!d&&!ee,ve=d&&n?n:void 0;console.log(`üìû Calling createTicker for ${V} with price=${ee}, date=${ve}`);const ye=await Zn(V,"real",ee,ve);if(!ye){console.warn(`‚ùå createTicker returned null for symbol: ${V}`);continue}if(console.log(`‚úÖ createTicker succeeded for ${V}:`,ye),typeof ye.buyPrice!="number"||ye.buyPrice===0){console.warn(`‚ùå Skipping ${V}: buyPrice is still 0 after fetch.`);continue}ye?(console.log(`‚úÖ Adding ${V} to newItems with buyPrice: ${ye.buyPrice}`),H.push(ye)):console.warn("‚ùå Failed to create ticker:",V)}if(console.log(`üìä Final newItems count: ${H.length}/${U.length}`),console.log("üìã Final newItems:",H.map(z=>({symbol:z.symbol,buyPrice:z.buyPrice}))),H.length===0){u&&f&&(u("No valid tickers were added, check your input"),f("error"));return}if(typeof l=="function"){const z={...h};for(const V in z)z[V].slug===W&&(z[V]={...z[V],items:[...z[V].items||[],...H.map(ee=>({...ee,buyPrice:typeof ee.buyPrice=="number"?ee.buyPrice:0}))]},console.log("üîç Pre-setWatchlists buyPrices:",z[V].items.map(ee=>({symbol:ee.symbol,buyPrice:ee.buyPrice}))));try{localStorage.setItem("burnlist_watchlists",JSON.stringify(z))}catch(V){console.error("‚ùå Failed to save to localStorage:",V),T("Failed to save to storage. Please try again.");return}if(!z||typeof z!="object"){console.error("‚ùå updatedObject is invalid before calling setWatchlists"),T("Failed to update watchlists. Please try again.");return}else console.log("‚úÖ Final watchlist structure before setWatchlists:",z),l(z)}for(const z of H)(!z.buyDate||isNaN(new Date(z.buyDate)))&&console.error("‚ùå Invalid buyDate in item:",z);typeof r=="function"?(console.log("üß™ Calling handleBulkAdd with:",H),r(H)):console.warn("‚ö†Ô∏è handleBulkAdd is not a function"),e(""),s(null),o(null)}catch{u&&f&&(u("Failed to add tickers. Please try again."),f("error"))}finally{b(!1)}}};return i.jsx("div",{style:{marginTop:20,"@media (max-width: 768px)":{marginTop:16},"@media (max-width: 480px)":{marginTop:12}},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",width:"100%",flexWrap:"wrap",gap:"8px","@media (max-width: 480px)":{flexDirection:"column",alignItems:"stretch",gap:"12px"}},children:[i.jsx("textarea",{value:t,onChange:E=>e(E.target.value),placeholder:"e.g. SPY, QQQ",rows:1,style:{flex:1,fontFamily:"'Courier New', Courier, monospace",fontSize:"0.9rem",backgroundColor:Y,border:`1px solid ${R}`,color:R,padding:6,resize:"none",boxSizing:"border-box",cursor:"pointer",minWidth:0,minHeight:"32px","@media (max-width: 480px)":{fontSize:"14px",padding:"8px",width:"100%"}},onKeyDown:E=>{E.key==="Enter"&&!E.shiftKey&&(E.preventDefault(),P())},onBlur:()=>C(!0)}),d&&i.jsx("input",{type:"number",placeholder:"Buy Price",step:"0.01",value:a||"",onChange:E=>{const _=parseFloat(E.target.value);s(_)},style:{marginLeft:8,fontFamily:"'Courier New', Courier, monospace",fontSize:"0.9rem",backgroundColor:Y,border:`1px solid ${R}`,color:R,padding:6,cursor:"pointer",minWidth:0,minHeight:"32px","@media (max-width: 480px)":{marginLeft:0,fontSize:"14px",padding:"8px",width:"100%"}}}),d&&i.jsx("input",{type:"date",value:n||"",onChange:E=>{const _=E.target.value;o(_)},style:{marginLeft:8,fontFamily:"'Courier New', Courier, monospace",fontSize:"0.9rem",backgroundColor:Y,border:`1px solid ${R}`,color:R,padding:6,cursor:"pointer",minWidth:0,minHeight:"32px","@media (max-width: 480px)":{marginLeft:0,fontSize:"14px",padding:"8px",width:"100%"}}}),i.jsx(de,{mobile:!1,onClick:P,disabled:x,title:"Add ticker(s)",style:{marginLeft:8,backgroundColor:x?"#666666":R,color:"black",opacity:x?.6:1,minWidth:0,height:"32px",minHeight:"32px",fontSize:"14px",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",padding:"8px 16px",transition:"all 0.2s ease-in-out","@media (max-width: 480px)":{marginLeft:0,width:"100%",fontSize:"14px",padding:"8px 16px",height:"32px",minHeight:"32px"}},children:x?"...":"+++"})]})})},Ga="rgb(140,185,162)",Ya=({editMode:t,setEditMode:e})=>{const r=ne(Ga);return ne("black"),i.jsx("div",{style:{marginTop:0,textAlign:"right"},children:i.jsx(de,{onClick:()=>e(!t),style:{background:"transparent",color:r,border:`1px solid ${r}`,fontFamily:"'Courier New', monospace",textTransform:"lowercase",fontWeight:400,letterSpacing:1,margin:0,boxShadow:"none",borderRadius:2,fontSize:15},children:t?"done":"edit"})})},Qa="rgb(140,185,162)",Xa=({children:t,height:e=400,style:r={}})=>{const n=ne(Qa),o=ne("black");return i.jsx("div",{style:{width:"100%",height:e,border:`1px solid ${n}`,background:o,position:"relative",overflow:"hidden",touchAction:"pan-x pan-y",...r},children:i.jsx("div",{style:{width:"100%",height:"100%",position:"relative",overflow:"auto",WebkitOverflowScrolling:"touch"},children:t})})};function Ka(t){if(!Array.isArray(t)||t.length===0)return{averagePrice:0,totalValue:0,itemCount:0,priceRange:{min:0,max:0},dateRange:{earliest:null,latest:null}};const e=t.filter(u=>u&&Number(u.buyPrice)>0&&u.buyDate&&Array.isArray(u.historicalData)&&u.historicalData.length>0);if(e.length===0)return{averagePrice:0,totalValue:0,itemCount:0,priceRange:{min:0,max:0},dateRange:{earliest:null,latest:null}};const r=e.flatMap(u=>u.historicalData.map(f=>new Date(f.timestamp)));new Date(Math.max(...r));const n=e.map(u=>{const f=new Date(u.buyDate),x=Number(u.buyPrice);let b=x;if(typeof u.currentPrice=="number"&&u.currentPrice>0)b=u.currentPrice;else if(u.historicalData&&u.historicalData.length>0){const T=[...u.historicalData].sort((w,v)=>new Date(v.timestamp)-new Date(w.timestamp));T.length>0&&(b=Number(T[0].price))}const k=x;return{symbol:u.symbol,buyPrice:x,buyDate:f,currentPrice:b,normalizedPrice:b,priceChange:b-k,priceChangePercent:k>0?(b-k)/k*100:0}}),o=n.reduce((u,f)=>u+f.currentPrice,0),a=o/n.length,s=n.map(u=>u.currentPrice),l={min:Math.min(...s),max:Math.max(...s)},d=e.map(u=>new Date(u.buyDate)),h={earliest:new Date(Math.min(...d)),latest:new Date(Math.max(...d))};return{averagePrice:Number(a.toFixed(2)),totalValue:Number(o.toFixed(2)),itemCount:e.length,priceRange:l,dateRange:h,normalizedPrices:n,totalBuyValue:n.reduce((u,f)=>u+f.buyPrice,0),totalGainLoss:n.reduce((u,f)=>u+f.priceChange,0),averageGainLossPercent:n.reduce((u,f)=>u+f.priceChangePercent,0)/n.length}}function Za(t){if(!Array.isArray(t)||t.length===0)return{twap:0,weightedPrices:[]};const e=t.filter(l=>l&&Number(l.buyPrice)>0&&l.buyDate);if(e.length===0)return{twap:0,weightedPrices:[]};const r=new Date,n=e.map(l=>{const d=new Date(l.buyDate),h=(r-d)/(1e3*60*60*24),u=Math.max(1,h);return{symbol:l.symbol,buyPrice:Number(l.buyPrice),buyDate:d,weight:u,weightedPrice:Number(l.buyPrice)*u}}),o=n.reduce((l,d)=>l+d.weightedPrice,0),a=n.reduce((l,d)=>l+d.weight,0),s=a>0?o/a:0;return{twap:Number(s.toFixed(2)),weightedPrices:n}}function es(t,e="D"){if(!Array.isArray(t)||t.length===0)return{beta:0,confidence:0,marketCorrelation:0};const r=t.filter(n=>n&&Array.isArray(n.historicalData)&&n.historicalData.length>0);if(r.length===0)return{beta:0,confidence:0,marketCorrelation:0};try{const n=r.map(f=>{const x=[...f.historicalData].sort((w,v)=>new Date(w.timestamp)-new Date(v.timestamp));if(x.length<2)return null;let b=[];const T={D:1,W:7,M:30,Y:365}[e]||1;for(let w=T;w<x.length;w++){const v=Number(x[w].price),y=Number(x[w-T].price);if(y>0){const C=(v-y)/y*100;b.push(C)}}return{symbol:f.symbol,returns:b,avgReturn:b.length>0?b.reduce((w,v)=>w+v,0)/b.length:0,volatility:b.length>0?Math.sqrt(b.reduce((w,v)=>w+Math.pow(v-b.reduce((y,C)=>y+C,0)/b.length,2),0)/b.length):0}}).filter(f=>f!==null);if(n.length===0)return{beta:0,confidence:0,marketCorrelation:0};const o=r.reduce((f,x)=>{var k;const b=Number(((k=x.historicalData[x.historicalData.length-1])==null?void 0:k.price)||0);return f+b},0),a=r.reduce((f,x,b)=>{var v;const k=Number(((v=x.historicalData[x.historicalData.length-1])==null?void 0:v.price)||0),T=o>0?k/o:0,w=n.find(y=>y.symbol===x.symbol);return f+T*((w==null?void 0:w.volatility)||0)},0),s=n.reduce((f,x)=>f+x.volatility,0)/n.length,l=s>0?a/s:1,d=n.reduce((f,x)=>f+x.returns.length,0)/n.length,h=Math.min(100,Math.max(0,d/30*100)),u=Math.min(1,Math.max(-1,l*.8));return{beta:Number(l.toFixed(2)),confidence:Number(h.toFixed(0)),marketCorrelation:Number(u.toFixed(2)),portfolioVolatility:Number(a.toFixed(2)),avgMarketVolatility:Number(s.toFixed(2))}}catch(n){return c.error("Error calculating portfolio beta:",n),{beta:0,confidence:0,marketCorrelation:0}}}const We="rgb(140,185,162)";function ts(){const t=new Date,e=new Date(t.toLocaleString("en-US",{timeZone:"America/New_York"})),r=e.getDay(),n=e.getHours();return!(r===0||r===6||n<4||n>=20)}const rs=()=>{var le;const{slug:t}=Or(),e=it(),r=dt(),[n,o]=S.useState("W");S.useEffect(()=>{c.log("üéØ [BURN PAGE] selectedTimeframe changed to:",n)},[n]);const[a,s]=S.useState(null),[l,d]=S.useState({}),[h,u]=S.useState(""),[f,x]=S.useState(null),[b,k]=S.useState(null),[T,w]=S.useState(!1),{notification:v,notificationType:y,setNotification:C,setNotificationType:A}=St(),[R,Y]=S.useState(!1),{isInverted:g}=ut(),[P,E]=S.useState(null),_=Xn((a==null?void 0:a.items)||[],n),U=Ka((a==null?void 0:a.items)||[]),W=Za((a==null?void 0:a.items)||[]);es((a==null?void 0:a.items)||[],n);const $=Array.isArray(a==null?void 0:a.items)?a.items.filter(N=>N.type==="real").length:0;S.useEffect(()=>{const N=()=>{const B=Date.now(),L=3*60*1e3,Q=B%L,X=L-Q,Z=Math.floor(X/(1e3*60)),me=Math.floor(X%(1e3*60)/1e3);E(`${Z}:${me.toString().padStart(2,"0")}`)};N();const m=setInterval(N,1e3);return()=>clearInterval(m)},[]),S.useEffect(()=>{(async()=>{var m;if(console.log("üîß DEBUG: Starting initializeFetching..."),console.log("üîß DEBUG: watchlist:",a),console.log("üîß DEBUG: slug:",t),await Me.initialize(),console.log("üîß DEBUG: fetchManager initialized"),a&&Array.isArray(a.items)&&a.items.length>0&&t){const B=a.items.map(X=>X.symbol);console.log("üîß DEBUG: About to register tickers:",B);const{default:L}=await Mt(()=>Promise.resolve().then(()=>ga),void 0);L.registerActiveBurnlist(t,B),console.log(`‚úÖ DEBUG: Successfully registered ${t} as active burnlist with ${B.length} tickers: ${B.join(", ")}`);const J=L.getActiveBurnlists(),Q=L.getAllUniqueTickers();console.log("üîß DEBUG: Active burnlists:",J),console.log("üîß DEBUG: All unique tickers:",Q)}else console.log("üîß DEBUG: Not registering - conditions not met"),console.log("üîß DEBUG: watchlist exists:",!!a),console.log("üîß DEBUG: items is array:",Array.isArray(a==null?void 0:a.items)),console.log("üîß DEBUG: items length:",(m=a==null?void 0:a.items)==null?void 0:m.length),console.log("üîß DEBUG: slug exists:",!!t)})()},[a,t]);const I=S.useRef(null),q=async(N=!1,m=!1)=>{if(!a||!Array.isArray(a.items))return;const B=await Me.startFetch(t,a.items,(L,J)=>{const Q={...a,items:L},X=Object.keys(l).find(Z=>l[Z].slug===t);if(X){const Z={...l,[X]:Q};ee(Z)}},N,m,n);B.success?localStorage.setItem(`burnlist_last_refresh_${t}`,new Date().toISOString()):B.message&&(C(B.message),A("info"))},H=Me.getFetchStatus(t),z=H&&H.status==="active",V=async()=>{console.log("üîß DEBUG: handleManualRefresh called!"),console.log("üîß DEBUG: isWatchlistFetching:",z),z?(console.log("üîß DEBUG: Cancelling active fetch"),Me.cancelFetch(t),C("Fetch cancelled","info")):(ts()||(console.log("üîß DEBUG: Market closed, but allowing manual refresh"),C("Manual refresh allowed outside market hours","info")),console.log("üîß DEBUG: Calling fetchWatchlistData(true, true)"),await q(!0,!0))};S.useEffect(()=>{const N=()=>{var B,L;try{const J=localStorage.getItem("burnlist_watchlists");if(J)try{const Q=JSON.parse(J);d(Q);const X=Object.values(Q).find(Z=>Z.slug===t);X&&(X.items=(B=X.items)==null?void 0:B.map(zr),X.items=(L=X.items)==null?void 0:L.filter(Z=>{var ae;const me=Z&&Number(Z.buyPrice)>0&&Array.isArray(Z.historicalData)&&Number((ae=Z.historicalData[0])==null?void 0:ae.price)>0;return me||c.warn("üß® Invalid item detected during hydration:",Z),me})),s(X||null),console.log("üìä DEBUG: Loaded/reloaded watchlist data")}catch{localStorage.removeItem("burnlist_watchlists"),s(null)}}catch{s(null)}};N();const m=B=>{console.log("üîß DEBUG: Storage event received:",B.key),B.key==="burnlist_watchlists"&&(console.log("üîÑ DEBUG: Storage event received, reloading watchlist data"),N())};return window.addEventListener("storage",m),()=>{window.removeEventListener("storage",m)}},[t]),S.useEffect(()=>{if(!(!a||!Array.isArray(a.items)))return()=>{I.current&&clearInterval(I.current)}},[a,t]),S.useEffect(()=>()=>{Me.pauseFetch(t)},[t]),S.useEffect(()=>{w(!0);const N=setTimeout(()=>w(!1),350);return()=>clearTimeout(N)},[n,a]);const ee=N=>{if(!(!N||typeof N!="object"||Array.isArray(N)))try{const m=Object.values(N).find(L=>L.slug===t);m&&s(m);const B=JSON.stringify(N);localStorage.setItem("burnlist_watchlists",B),d(N)}catch{}},ge=(N,m)=>{s(B=>{if(!B||!Array.isArray(B.items))return B;const L=B.items.map((Q,X)=>X===N?{...Q,buyPrice:m}:Q),J={...B,items:L};return d(Q=>{const X=Object.keys(Q).find(me=>Q[me].slug===t);if(!X)return Q;const Z={...Q,[X]:J};return localStorage.setItem("burnlist_watchlists",JSON.stringify(Z)),Z}),J})},ve=N=>{let m,B;return N<=7?(m="5min",B=Math.min(250,N*78)):N<=30?(m="15min",B=250):N<=90?(m="1h",B=250):N<=365?(m="1day",B=Math.min(250,N)):(m="1week",B=Math.min(250,Math.ceil(N/7))),c.log(`üìä Requesting exactly ${B} data points for ${N} days using ${m} intervals`),{interval:m,outputSize:B}},ye=async(N,m)=>{console.log("üö® [FIND TRADING DAY] Starting for",N,"date:",m);const{fetchHistoricalData:B}=await Mt(()=>Promise.resolve().then(()=>xr),void 0);console.log(`üîç [HISTORICAL FETCH] Checking if ${m} is a trading day for ${N}`),console.log("üîç [HISTORICAL FETCH] Using direct twelvedataAdapter - no market hours validation");for(let L=0;L<=7;L++){const J=new Date(m);J.setDate(J.getDate()-L);const Q=J.toISOString().slice(0,10);try{console.log(`üîç [FALLBACK] Day ${L}: Trying exact date ${Q}...`);const X=await B(N,Q,null,"1day");if(X&&X.historicalData&&X.historicalData.length>0){const Z=X.historicalData[0];console.log(`üí∞ [FALLBACK] Found price data for ${Q}: $${Z.price}`),console.log(L===0?`‚úÖ Found data for user's exact date: ${Q}`:`‚úÖ Found nearest trading day: ${Q} (${L} day${L>1?"s":""} before user's date)`);const me={actualDate:Q,fallbackDays:L,price:Z.price};return console.log("üö® [FIND TRADING DAY] Returning result:",me),me}}catch(X){console.log(`‚è≠Ô∏è ${Q} - no market data available:`,X.message)}}throw new Error(`No valid market data found near selected buy date. Please choose an earlier date (tried ${m} and 7 days prior).`)},Ce=async N=>{var B;const m=(B=a==null?void 0:a.items)==null?void 0:B[N];if(!m||!m.symbol||!m.buyDate){c.warn("‚ö†Ô∏è Cannot fetch historical data: missing ticker, symbol, or buy date"),C("Cannot fetch historical data: missing required information"),A("warning");return}c.log(`üì° Manually fetching historical data for ${m.symbol} from ${m.buyDate}`),await fe(N,m.buyDate.slice(0,10))},Ie=async N=>{var J,Q,X;const m=(J=a==null?void 0:a.items)==null?void 0:J[N];if(!m||!m.symbol){c.warn("‚ö†Ô∏è Cannot revert buy date: missing ticker or symbol");return}const B=((Q=m.buyDateMetadata)==null?void 0:Q.originalBuyDate)||m.addedAt,L=(X=m.buyDateMetadata)==null?void 0:X.originalBuyPrice;if(!B){C(`No original buy date found for ${m.symbol}`),A("warning");return}c.log(`üîÑ Reverting ${m.symbol} to original buy date: ${B}`),s(Z=>{if(!Z||!Array.isArray(Z.items))return Z;const me=Z.items.map((be,ue)=>ue===N?{...be,buyDate:B,buyPrice:L||be.buyPrice,buyDateMetadata:void 0}:be),ae={...Z,items:me};return d(be=>{const ue=Object.keys(be).find(te=>be[te].slug===t);if(!ue)return be;const se={...be,[ue]:ae};return localStorage.setItem("burnlist_watchlists",JSON.stringify(se)),se}),ae}),C(`Reverted ${m.symbol} to original buy date: ${B}`),A("success")},fe=async(N,m)=>{var Z,me,ae,be,ue,se,te,xe;if(console.log("üö® [BUY DATE CHANGE TRIGGERED]",{index:N,newDate:m}),m==="REVERT_TO_ORIGINAL"){await Ie(N);return}const B=new Date().toISOString().slice(0,10);if(m>B){C("Buy date cannot be in the future"),A("warning");return}const L=(Z=a==null?void 0:a.items)==null?void 0:Z[N];if(!L||!L.symbol){c.warn("‚ö†Ô∏è Cannot change buy date: missing ticker or symbol");return}console.log("üö® [CURRENT TICKER STATE]",{symbol:L.symbol,currentBuyPrice:L.buyPrice,currentBuyDate:L.buyDate,currentPrice:L.currentPrice,historicalDataLength:(me=L.historicalData)==null?void 0:me.length});const J=L.buyDate,Q=L.buyPrice,X=L.historicalData;c.log(`üìÖ [BUY DATE CHANGE] Starting: ${L.symbol} from ${J} to ${m}`),c.log("üìÖ [BUY DATE CHANGE] This should bypass all market hours validation"),w(!0),C(`Fetching historical data for ${L.symbol}...`),A("info");try{const{fetchHistoricalData:pe}=await Mt(()=>Promise.resolve().then(()=>xr),void 0),we=new Date(m),Le=new Date,ke=Math.floor((Le-we)/(1e3*60*60*24));if(ke>3650)throw new Error("Buy date is too far in the past. Most assets may not have data from that period.");c.log(`üîç Step 1: Finding actual trading day for ${m}`);const Ae=await ye(L.symbol,m),Pe=Ae.actualDate,Xe=Ae.price;c.log(`üîç [TRADING DAY RESULT] for ${L.symbol}:`),c.log(`  - Requested date: ${m}`),c.log(`  - Actual trading date: ${Pe}`),c.log(`  - Buy price from that date: $${Xe}`),c.log(`  - Fallback days: ${Ae.fallbackDays}`),Ae.fallbackDays>0&&c.log(`üìÖ Using fallback trading day: ${Pe} (${Ae.fallbackDays} days before ${m})`);const{interval:ot,outputSize:ft}=ve(ke);c.log(`üì° [HISTORICAL FETCH] Step 2: Fetching time series data from ${Pe} with interval=${ot}, outputSize=${ft}`),c.log("üì° [HISTORICAL FETCH] Using direct twelvedataAdapter - bypassing ALL market validation");let et;try{et=await pe(L.symbol,Pe,Le.toISOString(),ot,ft),c.log(`‚úÖ [HISTORICAL FETCH] API call successful - requested exactly ${ft} points with ${ot} interval`)}catch(Ne){c.warn(`‚ö†Ô∏è [HISTORICAL FETCH] API call failed with ${ot}, trying with 1day fallback:`,Ne),et=await pe(L.symbol,Pe,Le.toISOString(),"1day",Math.min(ke,100))}if(!et||!et.historicalData||et.historicalData.length===0)throw new Error(`No historical data found for ${L.symbol} from ${Pe}. This date may predate the asset's trading history.`);let je=et.historicalData;if(c.log(`üìä Received exactly ${je.length} data points as requested (target was ${ft})`),je.length>0){const Ne=je[0],Ke=je[je.length-1];c.log(`üìÖ API Data Range: ${Ne.timestamp} ‚Üí ${Ke.timestamp}`);const Ge=[...je.slice(0,3),...je.length>6?["..."]:[],...je.slice(-3)];c.log("üìä Sample timestamps:",Ge.map(Oe=>Oe==="..."?"...":`${Oe.timestamp} ($${Oe.price})`))}c.log(`üìä Received ${et.historicalData.length} points, using ${je.length} for chart`),c.log(`üîß Creating unified time-series for ${L.symbol}`),c.log(`üìä Fetched historical data: ${je.length} points from ${Pe} to present`),c.log(`üìä Existing live data: ${((ae=L.historicalData)==null?void 0:ae.length)||0} points`);let Ee=[...je];if(L.historicalData&&L.historicalData.length>0){const Ne=L.historicalData,Ke=new Date((be=je[je.length-1])==null?void 0:be.timestamp).getTime(),Ge=Ne.filter(Oe=>new Date(Oe.timestamp).getTime()>Ke);Ge.length>0&&(Ee=[...je,...Ge],c.log(`üîó Merged ${Ge.length} live data points with historical data`))}Ee.sort((Ne,Ke)=>new Date(Ne.timestamp)-new Date(Ke.timestamp)),c.log(`‚úÖ Unified time-series created: ${Ee.length} total points`),c.log(`üìÖ Timeline: ${(ue=Ee[0])==null?void 0:ue.timestamp} ‚Üí ${(se=Ee[Ee.length-1])==null?void 0:se.timestamp}`);const Ct=Ee.length>0?Ee[Ee.length-1].price:L.currentPrice;c.log(`üí∞ [BUY DATE CHANGE] Price Summary for ${L.symbol}:`),c.log(`  - Original buy price: $${Q}`),c.log(`  - New buy price: $${Xe}`),c.log(`  - Original current price: $${L.currentPrice}`),c.log(`  - New current price: $${Ct}`),c.log(`  - Historical data points: ${Ee.length}`);const mt={...L,buyDate:Pe,buyPrice:Xe,currentPrice:Ct,historicalData:Ee,buyDateMetadata:{originalUserDate:m,actualTradingDate:Pe,fallbackDays:Ae.fallbackDays,originalBuyDate:J,originalBuyPrice:Q,dataFetchedAt:new Date().toISOString(),dataPoints:Ee.length,interval:ot,mergedLiveData:((te=L.historicalData)==null?void 0:te.length)||0}};console.log("üö® [ABOUT TO UPDATE STATE]",{newBuyPrice:Xe,newBuyDate:Pe,newCurrentPrice:Ct,historicalDataLength:Ee.length}),s(Ne=>{if(!Ne||!Array.isArray(Ne.items))return Ne;const Ke=Ne.items.map((Oe,at)=>at===N?mt:Oe),Ge={...Ne,items:Ke};return d(Oe=>{const at=Object.keys(Oe).find(p=>Oe[p].slug===t);if(!at)return Oe;const kt={...Oe,[at]:Ge};return localStorage.setItem("burnlist_watchlists",JSON.stringify(kt)),kt}),console.log("üö® [STATE UPDATED]",{updatedTicker:mt,newBuyPrice:mt.buyPrice,newCurrentPrice:mt.currentPrice}),Ge});let tt;Ae.fallbackDays===0?tt=`‚úÖ Updated ${L.symbol}: buy date ${Pe}, buy price $${Xe.toFixed(2)}`:tt=`‚úÖ Updated ${L.symbol}: buy date ${Pe} (${Ae.fallbackDays} day${Ae.fallbackDays>1?"s":""} before your selected date), buy price $${Xe.toFixed(2)}`;const Dt=((xe=L.historicalData)==null?void 0:xe.length)||0;Dt>0?tt+=`, unified ${Ee.length} total datapoints (${je.length} historical + ${Dt} existing live)`:tt+=`, ${je.length} historical datapoints`,c.log(`‚úÖ ${tt}`),C(tt),A("success")}catch(pe){c.error(`‚ùå Error changing buy date for ${L.symbol}:`,pe),s(we=>{if(!we||!Array.isArray(we.items))return we;const Le=we.items.map((ke,Ae)=>Ae===N?{...ke,buyDate:J,buyPrice:Q,historicalData:X}:ke);return{...we,items:Le}}),C(`Failed to update buy date for ${L.symbol}: ${pe.message}`),A("error")}finally{w(!1)}},O=async N=>{if(!a||!Array.isArray(a.items))return;const m=a.items[N];if(!m||!m.symbol||!m.buyDate){c.warn("‚ö†Ô∏è Cannot refresh: missing symbol or buy date");return}try{c.log(`üîÑ Refreshing price for ${m.symbol} at date ${m.buyDate}`),c.log(`üì° Fetching historical data for ${m.symbol} from Twelve Data...`);const{fetchHistoricalData:B}=await Mt(()=>Promise.resolve().then(()=>xr),void 0),L=new Date(m.buyDate),J=new Date,Q=Math.floor((J-L)/(1e3*60*60*24));let X=[];if(Q<=50){c.log(`üìÖ Buy date is ${Q} days ago, fetching daily data for entire period`),c.log(`üîç API Call: ${m.symbol} from ${m.buyDate} to ${J.toISOString()} (1day)`);const se=await B(m.symbol,m.buyDate,J.toISOString(),"1day");c.log("üì• Daily data result:",se),se&&se.historicalData&&(X=se.historicalData)}else{c.log(`üìÖ Buy date is ${Q} days ago, fetching weekly + daily data`);const se=new Date(J.getTime()-50*24*60*60*1e3);c.log(`üìÖ Cutoff date: ${se.toISOString()}`),c.log(`üîç Weekly API Call: ${m.symbol} from ${m.buyDate} to ${se.toISOString()} (1week)`);const te=await B(m.symbol,m.buyDate,se.toISOString(),"1week");c.log("üì• Weekly data result:",te),c.log(`üîç Daily API Call: ${m.symbol} from ${se.toISOString()} to ${J.toISOString()} (1day)`);const xe=await B(m.symbol,se.toISOString(),J.toISOString(),"1day");c.log("üì• Daily data result:",xe),te&&te.historicalData&&(X=[...te.historicalData],c.log(`üìä Added ${te.historicalData.length} weekly data points`)),xe&&xe.historicalData&&(X=[...X,...xe.historicalData],c.log(`üìä Added ${xe.historicalData.length} daily data points`))}if(c.log(`üìä Total historical data points: ${X.length}`),X.length===0){c.warn(`‚ö†Ô∏è No historical data found for ${m.symbol}`),c.error("‚ùå Debug info:",{symbol:m.symbol,buyDate:m.buyDate,daysDiff:Q,interval:Q<=50?"1day":"1week+1day"}),C(`No historical data found for ${m.symbol}`,"error");return}let Z=null,me=null,ae=1/0;c.log(`üîç Looking for price on ${L.toISOString().split("T")[0]} for ${m.symbol}`),c.log(`üìä Historical data points: ${X.length}`);for(const se of X){const te=new Date(se.timestamp),xe=L.toISOString().split("T")[0],pe=te.toISOString().split("T")[0];if(c.log(`üîç Comparing: ${pe} vs ${xe}`),pe===xe){Z=se.price,me=se.timestamp,c.log(`‚úÖ Found exact date match for ${m.symbol}: ${Z} at ${me}`);break}const we=Math.abs(te.getTime()-L.getTime());we<ae&&(ae=we,Z=se.price,me=se.timestamp,c.log(`üìå Closest match so far: ${Z} at ${me} (diff: ${we}ms)`))}if(Z===null){c.warn(`‚ö†Ô∏è No historical price found for ${m.symbol} at ${m.buyDate}`),C(`No historical price found for ${m.symbol} at ${m.buyDate}`,"error");return}const be=L.toISOString().split("T")[0],ue=new Date(me).toISOString().split("T")[0];be!==ue&&(c.log(`‚ö†Ô∏è No exact date match found for ${m.symbol}`),c.log(`üìÖ Buy date: ${be}, Closest available: ${ue}`),c.log(`üí∞ Using closest price: ${Z} (from ${me})`),C(`Using closest available price for ${m.symbol} (${ue})`,"info")),c.log(`üìä Updating ${m.symbol} buy price from ${m.buyPrice} to ${Z} (date: ${me})`),c.log(`üíæ Saving ${X.length} historical data points for ${m.symbol}`),c.log("üìä First data point:",X[0]),c.log("üìä Last data point:",X[X.length-1]),s(se=>{if(!se||!Array.isArray(se.items))return se;const te=se.items.map((pe,we)=>we===N?{...pe,buyPrice:Z,historicalData:X}:pe),xe={...se,items:te};return c.log(`‚úÖ Updated watchlist item for ${m.symbol}:`,te[N]),c.log("üìä Historical data length after update:",te[N].historicalData.length),d(pe=>{const we=Object.keys(pe).find(Xe=>pe[Xe].slug===t);if(!we)return pe;const Le={...pe,[we]:xe};c.log(`üíæ Saving to localStorage with key: ${we}`),c.log("üìä Updated watchlist items count:",xe.items.length),localStorage.setItem("burnlist_watchlists",JSON.stringify(Le));const ke=localStorage.getItem("burnlist_watchlists"),Pe=JSON.parse(ke)[we].items[N];return c.log("‚úÖ Verification - Saved historical data length:",Pe.historicalData.length),Le}),xe}),C(`Updated ${m.symbol} buy price to $${Z.toFixed(2)}`,"success")}catch(B){c.error(`‚ùå Error refreshing price for ${m.symbol}:`,B),C(`Failed to refresh price for ${m.symbol}`,"error")}},K=N=>{s(m=>{if(!m||!Array.isArray(m.items))return m;const B=m.items.filter((J,Q)=>Q!==N),L={...m,items:B};return d(J=>{const Q=Object.keys(J).find(Z=>J[Z].slug===t);if(!Q)return J;const X={...J,[Q]:L};return localStorage.setItem("burnlist_watchlists",JSON.stringify(X)),X}),L})};return a?i.jsxs("div",{style:{backgroundColor:g?"rgb(140,185,162)":"transparent",minHeight:"100vh",color:g?"#000000":"#ffffff",padding:"0",paddingBottom:"80px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"10px 20px",borderBottom:`1px solid ${We}`,background:"rgba(0,0,0,0.3)",gap:"10px",marginBottom:"20px"},children:[i.jsx(de,{onClick:()=>e("/universes"),style:{background:r.pathname==="/universes"||r.pathname.startsWith("/universe/")?We:"transparent",color:r.pathname==="/universes"||r.pathname.startsWith("/universe/")?"#000000":We,border:`1px solid ${We}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"UNIVERSE"}),i.jsx(de,{onClick:()=>e("/journal"),style:{background:r.pathname==="/journal"?We:"transparent",color:r.pathname==="/journal"?"#000000":We,border:`1px solid ${We}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"JOURNAL"}),i.jsx(de,{onClick:()=>e("/"),style:{background:r.pathname==="/"||r.pathname.startsWith("/burn/")?We:"transparent",color:r.pathname==="/"||r.pathname.startsWith("/burn/")?"#000000":We,border:`1px solid ${We}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"BURNPAGE"})]}),U&&U.averagePrice>0&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,zIndex:10002,backgroundColor:"rgba(0,0,0,0.9)",borderBottom:`2px solid ${We}`,padding:"8px 20px"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"15px",fontFamily:"'Courier New', monospace",fontSize:"14px",color:We},children:[i.jsxs("div",{style:{fontWeight:"bold"},children:["ETF Price: $",U.averagePrice.toFixed(2)]}),i.jsxs("div",{style:{color:We,fontWeight:"bold"},children:["Next Fetch: ",P||"‚Äì:‚Äì"]}),i.jsxs("div",{style:{color:"#888"},children:[Number.isFinite(_)?`${_.toFixed(2)}%`:"‚Äì%"," (",(n==null?void 0:n.toUpperCase())||"N/A",")"]}),i.jsxs("div",{style:{color:U.totalGainLoss>=0?We:"#e31507",fontWeight:"bold"},children:["P&L: $",U.totalGainLoss.toFixed(2)," (",U.averageGainLossPercent.toFixed(2),"%)"]})]})}),v&&i.jsx("div",{style:{position:"fixed",top:U&&U.averagePrice>0?60:24,left:0,right:0,zIndex:10001,display:"flex",justifyContent:"center",pointerEvents:"none"},children:i.jsx("div",{style:{minWidth:320,maxWidth:480,pointerEvents:"auto"},children:i.jsx(Je,{message:v,type:y,onClose:()=>C("")})})}),i.jsx("div",{style:{padding:"20px 20px 0 20px",marginBottom:"50px",marginTop:U&&U.averagePrice>0?"50px":"0px"},children:i.jsx(ja,{name:a.name,averageReturn:_,selected:n,notification:T?"Calculating returns and updating chart...":null,onNotificationClose:()=>w(!1),onRefresh:V,realStockCount:$,etfPriceData:U,twapData:W})}),i.jsxs("div",{style:{padding:"5px 20px 10px 20px"},children:[i.jsx(Xa,{height:505,style:{},children:i.jsx(bn,{portfolioReturnData:((le=a.items)==null?void 0:le.map(N=>({symbol:N.symbol,buyDate:N.buyDate,buyPrice:N.buyPrice,historicalData:N.historicalData,timeframe:n})))||[],watchlistSlug:t,showBacktestLine:!1,height:500,suppressEmptyMessage:!0})}),i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10,flexWrap:"wrap",gap:"8px"},children:[i.jsx(Pa,{selected:n,onChange:o}),i.jsx(Ya,{editMode:R,setEditMode:Y})]}),Array.isArray(a.items)&&a.items.length>0?i.jsx(_a,{items:a.items,selectedTimeframe:n,editMode:R,handleBuyPriceChange:ge,handleBuyDateChange:fe,handleRevertBuyDate:Ie,handleFetchHistoricalData:Ce,handleDelete:K,handleRefreshPrice:O}):null,(!Array.isArray(a.items)||a.items.length===0)&&i.jsx("div",{style:{fontFamily:"'Courier New', monospace",color:"#999",textAlign:"center",marginTop:"20px"},children:"‚ö†Ô∏è No valid data to display yet."}),i.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:"30px"},children:i.jsx(Ja,{watchlists:l,setWatchlists:ee,currentSlug:t,bulkSymbols:h,setBulkSymbols:u,buyPrice:f,setBuyPrice:x,buyDate:b,setBuyDate:k,setNotification:C,setNotificationType:A,handleBulkAdd:async N=>{if(!(!N||N.length===0))try{const m=localStorage.getItem("burnlist_watchlists");if(!m||m==="undefined")return;const B=JSON.parse(m),L=t,J=Object.values(B).find(ue=>ue.slug===L);if(!J||!Array.isArray(J.items))return;const Q=N.filter(ue=>ue&&ue.symbol&&typeof ue.symbol=="string"&&Array.isArray(ue.historicalData)),X=new Set((J.items||[]).map(ue=>ue.symbol)),me=Q.filter(ue=>!X.has(ue.symbol)).filter(ue=>Array.isArray(ue.historicalData)&&ue.historicalData.length>0);J.items.push(...me);const ae={...B},be=Object.keys(ae).find(ue=>ae[ue].slug===L);if(be)ae[be]=J;else return;localStorage.setItem("burnlist_watchlists",JSON.stringify(ae)),d(ae)}catch{}}})})]})]}):i.jsx("div",{style:{backgroundColor:g?"rgb(140,185,162)":"#000000",color:g?"#000000":"#ffffff",padding:"20px"},children:i.jsx("h2",{style:{color:"#e31507",fontFamily:"'Courier New', monospace"},children:"‚ö†Ô∏è Watchlist not found."})})};function $t(t,e,r){return t<=e?0:t>=r?100:(t-e)/(r-e)*100}function ns(t){return t<=15?100:t<=30?70:t<=50?40:0}function is(t){return t>=1.2&&t<=2.5?100:50}function os({epsGrowth:t,avgVolume:e,relVolume:r,technicalFlags:n,earningsDaysAway:o,price:a,pe:s,marketCap:l,beta:d,newsFlag:h,sectorAlignment:u,marketSupport:f,volatilityClear:x,breadthHealthy:b}={}){let k=0,T=0;t!=null&&t!==""&&(k+=$t(t,0,50)*.15,T+=.15),e!=null&&e!==""&&(k+=$t(e,5e5,2e6)*.12,T+=.12),r!=null&&r!==""&&(k+=$t(r,1,3)*.1,T+=.1),n!=null&&(k+=(n?100:0)*.1,T+=.1),o!=null&&o!==""&&(k+=(o>5?100:0)*.1,T+=.1),a!=null&&a!==""&&(k+=$t(a,7,50)*.08,T+=.08),s!=null&&s!==""&&(k+=ns(s)*.08,T+=.08),l!=null&&l!==""&&(k+=$t(l,5e8,5e10)*.07,T+=.07),d!=null&&d!==""&&(k+=is(d)*.05,T+=.05),h!=null&&(k+=(h?100:0)*.02,T+=.02);const w=T>0?k*(70/(100*T)):0;let v=0;u&&(v+=10),f&&(v+=10),x&&(v+=5),b&&(v+=5);const y=w+v;let C="Standby";return y>=90?C="Prime Entry":y>=75&&(C="Almost Ready"),{coreSetupScore:Math.round(w*100)/100,contextScore:v,totalBuyScore:Math.round(y*100)/100,tag:C}}var ei={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},dn=nt.createContext&&nt.createContext(ei),as=["attr","size","title"];function ss(t,e){if(t==null)return{};var r=ls(t,e),n,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(o=0;o<a.length;o++)n=a[o],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function ls(t,e){if(t==null)return{};var r={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(e.indexOf(n)>=0)continue;r[n]=t[n]}return r}function Xt(){return Xt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Xt.apply(this,arguments)}function un(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,n)}return r}function Kt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?un(Object(r),!0).forEach(function(n){cs(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):un(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function cs(t,e,r){return e=ds(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ds(t){var e=us(t,"string");return typeof e=="symbol"?e:e+""}function us(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ti(t){return t&&t.map((e,r)=>nt.createElement(e.tag,Kt({key:r},e.attr),ti(e.child)))}function vt(t){return e=>nt.createElement(ps,Xt({attr:Kt({},t.attr)},e),ti(t.child))}function ps(t){var e=r=>{var{attr:n,size:o,title:a}=t,s=ss(t,as),l=o||r.size||"1em",d;return r.className&&(d=r.className),t.className&&(d=(d?d+" ":"")+t.className),nt.createElement("svg",Xt({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,s,{className:d,style:Kt(Kt({color:t.color||r.color},r.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),a&&nt.createElement("title",null,a),t.children)};return dn!==void 0?nt.createElement(dn.Consumer,null,r=>e(r)):e(ei)}function hs(t){return vt({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(t)}const Pt="/assets/greenflag-1754043543625.png",_t="/assets/redflag-1754043543625.png",gs="/assets/yellowflag-1754043543625.png",pn="/assets/box-1754043543625.png",hn="/assets/checkbox-1754043543625.png",M="rgb(140,185,162)",$e={breakout:{name:"Breakout",checklists:["Horizontal resistance tested at least 2‚Äì3 times","Tight consolidation range (3‚Äì7 bars) near resistance","No overlapping wicks or indecision candles near breakout zone","Volume increasing into resistance (1-day Relative Volume > 1.5)","RSI between 50‚Äì65 and rising","MACD bullish crossover or trending upward","Price within 5% of 52-week high","No major macro event or earnings within next 7 days","Clean air above breakout level (no nearby supply)"],newsValidation:["Catalyst present in last 3 days (e.g. earnings beat, analyst upgrade, sector momentum)","Headline or PR confirms why price is reacting","Price action matches news intensity (no fade after news)"]},pullback:{name:"Pullback",checklists:["Strong uptrend visible on daily chart","Pullback to support (20 EMA, 50 SMA, or breakout retest)","Low volume during the pullback vs prior rally","Candle structure is clean (no breakdown bars or gaps)","Reversal signal forming (hammer, engulfing, inside bar)","RSI between 35‚Äì50, curling up","MACD flattening or turning bullish","Relative Volume (3‚Äì5 day avg) > 1.2","No earnings within next 5 days","Pullback has not broken prior swing low"],newsValidation:["Recent catalyst (earnings, analyst note, macro driver) caused last rally","Catalyst is still relevant (not priced in / not reversed)","If no news, chart structure alone justifies trade"]},shortSqueeze:{name:"Short Squeeze",checklists:["Wide-range breakout candle on high volume","Gap + hold or strong Day 1/Day 2 continuation behavior","Relative Volume (1-day) > 2.0","Beta > 2.0 or Volatility > 4%","RSI between 55‚Äì70 (not overbought)","MACD trending upward or freshly crossed","High short float (20%+) confirmed externally (Finviz, Fintel, etc.)","Small float or prior squeeze chart behavior","Room above ‚Äî no major resistance overhead"],newsValidation:["Confirmed event or sentiment driver (e.g. earnings beat, activist, insider buys)","Headline present within last 3 days","If no news: verify price is moving *only* due to float pressure (pure squeeze logic)"]},postEarnings:{name:"Post-Earnings Momentum",checklists:["Earnings occurred within last 3 trading days","Large green candle on earnings day with strong close","Price gapped up and held or built above 20 EMA","Day 2 or Day 3 shows continuation or controlled pullback","Relative Volume (1‚Äì3 day avg) > 1.5","RSI between 55‚Äì70","MACD bullish","No major macro interference (Fed, CPI, etc.) within 3 days","Target zone has room for extension (no hard resistance above)"],newsValidation:["Confirm earnings beat ‚Äî look for revenue + EPS beat and guidance raise","Check press release or SA earnings summary","Ensure market reaction aligns with numbers (not a fake pump)"]}},fs=(t,e,r,n)=>{const o=r*(n/100),a=3.5,s=1.25*e,l=Math.min(t*(a/100),s),d=t-l,h=t+2*l,u=o/l;return{stopLoss:Number(d.toFixed(5)),takeProfit:Number(h.toFixed(5)),positionSize:Number(u.toFixed(5))}},ms=()=>{var tt,Dt,Ne,Ke,Ge,Oe,at,kt;const{slug:t}=Or(),e=it(),r=dt(),[n,o]=S.useState(null),[a,s]=S.useState({}),[l,d]=S.useState(""),{notification:h,notificationType:u,setNotification:f,setNotificationType:x}=St(),[b,k]=S.useState(!1),[T,w]=S.useState(new Set),[v,y]=S.useState({key:"symbol",direction:"asc"}),[C,A]=S.useState(()=>{const p=localStorage.getItem("burnlist_screener_settings");return p?JSON.parse(p):{accountSize:1e4,riskPercent:2}}),{isInverted:R}=ut(),[Y,g]=S.useState(!1),[P,E]=S.useState(null),[_,U]=S.useState(""),[W,$]=S.useState({}),[I,q]=S.useState(""),[H,z]=S.useState(""),[V,ee]=S.useState(""),[ge,ve]=S.useState(""),[ye,Ce]=S.useState("2"),[Ie,fe]=S.useState(""),[O,K]=S.useState(!1),[le,N]=S.useState(new Set),[m,B]=S.useState(null),[L,J]=S.useState(!1);S.useEffect(()=>{try{const p=localStorage.getItem("burnlist_universes");if(p){const F=JSON.parse(p);s(F);const j=Object.values(F).find(re=>re.slug===t);j&&o(j)}}catch(p){c.error("Failed to load universes:",p)}},[t]),S.useEffect(()=>{if(n){const p={...a},F=Object.keys(p).find(j=>p[j].id===n.id);F&&(p[F]=n,localStorage.setItem("burnlist_universes",JSON.stringify(p)))}},[n]),S.useEffect(()=>{localStorage.setItem("burnlist_screener_settings",JSON.stringify(C))},[C]);const Q=async()=>{if(!l.trim()){f("Please enter ticker symbols"),x("error");return}k(!0),f("Adding tickers to universe..."),x("loading");try{const p=l.split(/[,	\s]+/).map(ce=>ce.trim().toUpperCase()).filter(Boolean).filter(Pr);if(p.length===0){f("No valid ticker symbols found"),x("error");return}const F=new Set(((n==null?void 0:n.items)||[]).map(ce=>ce.symbol)),j=p.filter(ce=>!F.has(ce));if(j.length===0){f("All symbols already exist in universe"),x("info");return}const re=[];for(const ce of j){const Se=sr(ce),Ue={id:Jt(),symbol:Se,lastPrice:0,atr:0,flags:{news:!1},tradeType:"",tradeTypeName:"",quickTradeType:"",quickTradeTypeName:"",journalVerdict:"",journalVerdictType:"",journalVerdictFlag:"",entryPrice:"",notes:"",stopLoss:"",takeProfit:"",positionSize:""};re.push(Ue)}o(ce=>({...ce,items:[...(ce==null?void 0:ce.items)||[],...re]})),d(""),f(`Added ${re.length} tickers to universe. You can now manually enter prices.`),x("success")}catch(p){c.error("Error adding tickers:",p),f("Failed to add tickers"),x("error")}finally{k(!1)}},X=(p,F,j)=>{o(re=>({...re,items:((re==null?void 0:re.items)||[]).map(ce=>{if(ce.id===p){const Se={...ce};if(F==="flags"?Se.flags={...Se.flags,...j}:Se[F]=j,F==="entryPrice"||F==="atr"){const Ue=F==="entryPrice"?parseFloat(j):Se.entryPrice,De=F==="atr"?parseFloat(j):Se.atr;if(Ue&&De&&Ue>0&&De>0){const{stopLoss:Fe,takeProfit:xt,positionSize:ze}=fs(Ue,De,C.accountSize,C.riskPercent);Se.stopLoss=Fe.toFixed(2),Se.takeProfit=xt.toFixed(2),Se.positionSize=ze.toFixed(2)}}return Se}return ce})}))},Z=p=>{o(F=>({...F,items:((F==null?void 0:F.items)||[]).filter(j=>j.id!==p)})),w(F=>{const j=new Set(F);return j.delete(p),j}),N(F=>{const j=new Set(F);return j.delete(p),j})},me=p=>{w(F=>{const j=new Set(F);return j.has(p)?j.delete(p):j.add(p),j})},ae=()=>{var p;T.size===(((p=n==null?void 0:n.items)==null?void 0:p.length)||0)?w(new Set):w(new Set(((n==null?void 0:n.items)||[]).map(F=>F.id)))},be=p=>{N(F=>{const j=new Set(F);return j.has(p)?j.delete(p):j.add(p),j})},ue=()=>{var p;le.size===(((p=n==null?void 0:n.items)==null?void 0:p.length)||0)?N(new Set):N(new Set(((n==null?void 0:n.items)||[]).map(F=>F.id)))},se=async()=>{if(T.size===0){f("Please select at least one ticker"),x("error");return}k(!0),f("Creating watchlist with fresh market data..."),x("info");try{const p=((n==null?void 0:n.items)||[]).filter(ze=>T.has(ze.id)),F=JSON.parse(localStorage.getItem("burnlist_watchlists")||"{}"),j=Jt(),re=`Screener ${yt(new Date)}`,ce=re.toLowerCase().replace(/[^a-z0-9]/g,"-"),Se=[];let Ue=0,De=0;for(const ze of p)try{const st=await Zn(ze.symbol,"real",parseFloat(ze.entryPrice)||null,null);st?(Se.push(st),Ue++):(De++,c.warn(`Failed to fetch data for ${ze.symbol}`)),p.length>1&&await new Promise(cr=>setTimeout(cr,1e3))}catch(st){De++,c.error(`Error fetching data for ${ze.symbol}:`,st)}if(Se.length===0){f("Failed to fetch market data for any selected tickers"),x("error"),k(!1);return}const Fe={id:j,name:re,slug:ce,items:Se,reason:`Created from screener with ${Ue} tickers (${De} failed)`,createdAt:new Date().toISOString()},xt={...F,[j]:Fe};localStorage.setItem("burnlist_watchlists",JSON.stringify(xt)),f(`Created watchlist "${re}" with ${Ue} tickers${De>0?` (${De} failed)`:""}`),x("success"),w(new Set)}catch(p){c.error("Error creating watchlist:",p),f("Failed to create watchlist"),x("error")}finally{k(!1)}},te=p=>{y(F=>F.key===p?{key:p,direction:F.direction==="asc"?"desc":"asc"}:{key:p,direction:"asc"})},xe=[...(n==null?void 0:n.items)||[]].map(p=>{const F={epsGrowth:p.epsGrowth||0,avgVolume:p.avgVolume||0,relVolume:p.relVolume||1,technicalFlags:!!(p.tradeType&&p.journalVerdictType==="qualified"),earningsDaysAway:p.earningsDaysAway||10,price:p.lastPrice||0,pe:p.pe||15,marketCap:p.marketCap||5e8,debtEquity:p.debtEquity||.25,pb:p.pb||1.1,beta:p.beta||1.5,newsFlag:p.flags.news||!1,sectorAlignment:p.sectorAlignment||!1,marketSupport:p.marketSupport||!1,volatilityClear:p.volatilityClear||!1,breadthHealthy:p.breadthHealthy||!1},j=os(F);return{...p,_buyScore:j.totalBuyScore,_buyTag:j.tag}}).sort((p,F)=>{const j=(De,Fe)=>Fe.includes(".")?Fe.split(".").reduce((ze,st)=>ze==null?void 0:ze[st],De):De[Fe],re=j(p,v.key),ce=j(F,v.key);if(v.key==="symbol"||v.key==="tradeType"||v.key==="quickTradeType"||v.key==="notes"||v.key==="journalVerdict"){const De=String(re||""),Fe=String(ce||"");return v.direction==="asc"?De.localeCompare(Fe):Fe.localeCompare(De)}if(v.key==="flags.news"){const De=!!re,Fe=!!ce;return De===Fe?0:v.direction==="asc"?De?1:-1:Fe?1:-1}const Se=parseFloat(re)||0,Ue=parseFloat(ce)||0;return v.direction==="asc"?Se-Ue:Ue-Se}),pe=p=>v.key!==p?"":v.direction==="asc"?"‚Üë":"‚Üì",we=()=>{if(!I||!H||!V)return null;const p=parseFloat(I),F=parseFloat(H),j=parseFloat(V);if(p<=0||F<=0||j<=0)return null;const re=Math.abs(p-F),ce=Math.abs(j-p);return re===0?null:(ce/re).toFixed(2)},Le=()=>{if(!ge||!ye||!I||!H)return null;const p=parseFloat(ge),F=parseFloat(ye)/100,j=parseFloat(I),re=parseFloat(H);if(p<=0||F<=0||j<=0||re<=0)return null;const ce=p*F,Se=Math.abs(j-re);return Se===0?null:Math.floor(ce/Se)},ke=()=>{if(!_||Object.keys(W).length===0)return null;const p=Object.keys(W).length,F=Object.values(W).filter(Boolean).length,j=p-F;return j===0?{type:"qualified",text:"Qualified",flag:Pt}:j<=2?{type:"discretionary",text:"Discretionary",flag:gs}:{type:"blocked",text:"Blocked",flag:_t}},Ae=p=>{$(F=>({...F,[p]:!F[p]}))},Pe=p=>{E(p),g(!0),U(p.tradeType||""),q(p.entryPrice||""),z(p.stopLoss||""),ee(p.target||""),ve(p.accountSize||""),Ce(p.riskPerTrade||"2"),fe(p.overrideReason||"");const F={};p.tradeType&&$e[p.tradeType]&&[...$e[p.tradeType].checklists,...$e[p.tradeType].newsValidation].forEach(re=>{p.notes&&p.notes.includes(re)&&(F[re]=!0)}),$(F),Xe(p.symbol)},Xe=async p=>{if(p){J(!0);try{const F=await fetch(`/api/twelvedata-quote?symbols=${p}&interval=1min`);if(F.ok){const j=await F.json();j&&j.length>0?B(j[0].price):(c.warn(`No price data received for ${p}`),B(null))}else c.warn(`API error for ${p}: ${F.status}`),B(null)}catch(F){c.error("Error fetching current market price:",F),B(null)}finally{J(!1)}}},ot=()=>{g(!1),E(null)},ft=()=>{if(!P||!_)return;const p=ke();p&&(o(F=>({...F,items:((F==null?void 0:F.items)||[]).map(j=>{if(j.id===P.id){const ce=$e[_].newsValidation.every(Se=>W[Se]);return{...j,tradeType:_,tradeTypeName:$e[_].name,journalVerdict:p.text,journalVerdictType:p.type,journalVerdictFlag:p.flag,entryPrice:I,stopLoss:H,target:V,takeProfit:V,accountSize:ge,riskPerTrade:ye,riskReward:we(),positionSize:Le(),checklistItems:{...W},overrideReason:p.type!=="qualified"?Ie:"",journaledAt:new Date().toISOString(),flags:{...j.flags,news:ce}}}return j})})),g(!1),E(null),U(""),$({}),q(""),z(""),ee(""),ve(""),Ce("2"),fe(""))};S.useEffect(()=>{if(!Y||!_||!$e[_])return;if(Object.keys(W).length===0){const F={};$e[_].checklists.forEach(j=>{F[j]=!1}),$e[_].newsValidation.forEach(j=>{F[j]=!1}),$(F)}},[_,Y]);const et=async p=>{if(!p.tradeType||!p.entryPrice||!p.stopLoss||!p.target){f("Complete journal entry first"),x("error");return}try{f("Fetching latest price from Twelve Data API..."),x("loading");let F=null,j=!1;try{const Bt=await fetch(`/api/twelvedata-quote?symbols=${p.symbol}&interval=1min`);if(Bt.ok){const dr=await Bt.json();dr&&dr.length>0&&(F=dr[0].price,c.log(`üìä Latest price for ${p.symbol}: $${F}`),j=window.confirm(`Current market price for ${p.symbol}: $${F.toFixed(2)}

Your entered price: $${parseFloat(p.entryPrice).toFixed(2)}

Would you like to use the current market price instead?`))}}catch(Bt){c.warn("Twelve Data API not available, using manual entry price:",Bt),f("Using manual entry price (API unavailable)"),x("info")}const re=j?F:parseFloat(p.entryPrice),ce=re,Se=parseFloat(p.stopLoss),Ue=parseFloat(p.target),De=Math.abs(ce-Se),Fe=Math.abs(Ue-ce),xt=De>0?(Fe/De).toFixed(2):"0",ze={id:Date.now(),ticker:p.symbol,setup:p.tradeTypeName||p.tradeType,riskReward:xt,verdict:p.journalVerdict||"Not journaled",outcome:"Open",entryPrice:re,stopLoss:parseFloat(p.stopLoss),target:parseFloat(p.target),positionSize:p.positionSize,accountSize:p.accountSize,riskPerTrade:p.riskPerTrade,executedAt:new Date().toISOString(),notes:p.notes||"",currentMarketPrice:F,priceSource:j?"Twelve Data API":F?"Manual Entry (API Available)":"Manual Entry (API Unavailable)"},st=JSON.parse(localStorage.getItem("trade_journal_trades")||"[]"),cr=[ze,...st];localStorage.setItem("trade_journal_trades",JSON.stringify(cr));const ni=j?` (updated to current market price: $${F.toFixed(2)})`:F?` (using manual entry: $${parseFloat(p.entryPrice).toFixed(2)})`:` (using manual entry: $${parseFloat(p.entryPrice).toFixed(2)})`;f(`Trade executed: ${p.symbol} logged to journal${ni}`),x("success")}catch(F){c.error("Error executing trade:",F),f(`Failed to execute trade: ${F.message}`),x("error")}},je=p=>{U(p),$({}),q(""),z(""),ee(""),ve(""),Ce("2"),fe("")},Ee=(p,F)=>{o(j=>({...j,items:((j==null?void 0:j.items)||[]).map(re=>{var ce;return re.id===p?{...re,quickTradeType:F,quickTradeTypeName:F?((ce=$e[F])==null?void 0:ce.name)||F:""}:re})}))},Ct=p=>{var F;if(le.size===0){f("Please select at least one stock first"),x("error");return}o(j=>({...j,items:((j==null?void 0:j.items)||[]).map(re=>{var ce;return le.has(re.id)?{...re,quickTradeType:p,quickTradeTypeName:p?((ce=$e[p])==null?void 0:ce.name)||p:""}:re})})),f(`Set ${le.size} stocks to ${((F=$e[p])==null?void 0:F.name)||p}`),x("success")},mt=async p=>{if(p)try{const F=await _r(p),re=`https://www.tradingview.com/chart/i0seCgVv/?symbol=${encodeURIComponent(`${F}:${p.toUpperCase()}`)}`;window.open(re,"_blank")}catch(F){c.warn(`‚ö†Ô∏è Error opening chart for ${p}:`,F);const re=`https://www.tradingview.com/chart/i0seCgVv/?symbol=${encodeURIComponent(`NASDAQ:${p.toUpperCase()}`)}`;window.open(re,"_blank")}};return i.jsxs("div",{style:{backgroundColor:R?"rgb(140,185,162)":"transparent",minHeight:"100vh",color:R?"#000000":"#ffffff",padding:"0"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"10px 20px",borderBottom:`1px solid ${M}`,background:"rgba(0,0,0,0.3)",gap:"10px",marginBottom:"20px"},children:[i.jsx(de,{onClick:()=>e("/universes"),style:{background:r.pathname==="/universes"||r.pathname.startsWith("/universe/")?M:"transparent",color:r.pathname==="/universes"||r.pathname.startsWith("/universe/")?"#000000":M,border:`1px solid ${M}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"UNIVERSE"}),i.jsx(de,{onClick:()=>e("/journal"),style:{background:r.pathname==="/journal"?M:"transparent",color:r.pathname==="/journal"?"#000000":M,border:`1px solid ${M}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"JOURNAL"}),i.jsx(de,{onClick:()=>e("/market"),style:{background:r.pathname==="/market"?M:"transparent",color:r.pathname==="/market"?"#000000":M,border:`1px solid ${M}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"MARKET"}),i.jsx(de,{onClick:()=>e("/"),style:{background:r.pathname==="/"||r.pathname.startsWith("/burn/")?M:"transparent",color:r.pathname==="/"||r.pathname.startsWith("/burn/")?"#000000":M,border:`1px solid ${M}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"BURNPAGE"})]}),i.jsxs("div",{style:{padding:"20px"},children:[h&&i.jsx("div",{style:{position:"fixed",top:24,left:0,right:0,zIndex:10001,display:"flex",justifyContent:"center",pointerEvents:"none"},children:i.jsx("div",{style:{minWidth:320,maxWidth:480,pointerEvents:"auto"},children:i.jsx(Je,{message:h,type:u,onClose:()=>f("")})})}),i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:[i.jsx(Zt,{to:"/universes",style:{display:"inline-flex",alignItems:"center",border:"none",background:"none",padding:0,margin:0,textDecoration:"none"},"aria-label":"back to universes",children:i.jsx("img",{src:Qn,alt:"back",style:{width:24,height:24,filter:R?"invert(1)":"none"}})}),i.jsx("h1",{style:{color:M,fontFamily:"'Courier New', monospace",margin:0,marginLeft:0,textAlign:"right",flex:1},children:(n==null?void 0:n.name)||"UNIVERSE SCREENER"})]}),i.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"20px"},children:[i.jsx(de,{onClick:ae,children:T.size===(((tt=n==null?void 0:n.items)==null?void 0:tt.length)||0)?"DESELECT ALL":"SELECT ALL"}),i.jsx(de,{onClick:se,disabled:T.size===0||b,children:b?"CREATING WATCHLIST...":`CREATE WATCHLIST FROM SELECTED (${T.size})`}),O&&i.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[i.jsx("span",{style:{color:M,fontSize:"12px",fontFamily:"'Courier New', monospace"},children:"MASS SET:"}),Object.keys($e).map(p=>i.jsx("button",{onClick:()=>Ct(p),disabled:le.size===0,style:{background:"transparent",color:M,border:`1px solid ${M}`,padding:"4px 8px",fontFamily:"Courier New",fontSize:10,cursor:le.size===0?"not-allowed":"pointer",borderRadius:0,opacity:le.size===0?.5:1,transition:"all 0.2s"},title:`Set ${le.size} selected stocks to ${$e[p].name}`,children:p.charAt(0).toUpperCase()+p.slice(1).replace(/([A-Z])/g," $1")},p))]})]}),(((Dt=n==null?void 0:n.items)==null?void 0:Dt.length)||0)>0&&i.jsxs("div",{style:{overflowX:"auto"},children:[(((Ne=n==null?void 0:n.items)==null?void 0:Ne.length)||0)>0&&i.jsx("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:16},children:i.jsx("button",{onClick:()=>K(p=>!p),style:{background:"none",border:"none",color:M,fontFamily:"'Courier New', monospace",fontSize:"12px",padding:"2px 8px",borderRadius:0,fontWeight:400,textTransform:"lowercase",letterSpacing:0,cursor:"pointer",transition:"all 0.2s",minWidth:0,boxShadow:"none"},children:O?"done":"edit"})}),i.jsxs("table",{style:{width:"100%",borderCollapse:"separate",borderSpacing:0,color:M,background:"black",fontFamily:"Courier New",border:`2px solid ${M}`,fontSize:"15px",boxShadow:"0 2px 16px 0 rgba(140,185,162,0.08)",tableLayout:"fixed"},children:[i.jsx("thead",{style:{position:"sticky",top:0,zIndex:5,background:"black",borderBottom:`2px solid ${M}`},children:i.jsxs("tr",{style:{borderBottom:`2px solid ${M}`},children:[i.jsxs("th",{style:{width:"7.14%",padding:"8px",textAlign:"center",borderBottom:`1px solid ${M}`,background:"black"},children:[O?i.jsx("input",{type:"checkbox",checked:le.size===(((Ke=n==null?void 0:n.items)==null?void 0:Ke.length)||0)&&(((Ge=n==null?void 0:n.items)==null?void 0:Ge.length)||0)>0,onChange:ue,style:{accentColor:M}}):i.jsx("input",{type:"checkbox",checked:T.size===(((Oe=n==null?void 0:n.items)==null?void 0:Oe.length)||0)&&(((at=n==null?void 0:n.items)==null?void 0:at.length)||0)>0,onChange:ae,style:{accentColor:M}}),") : null}"]}),i.jsxs("th",{onClick:()=>te("symbol"),style:{width:"7.14%",padding:"8px",textAlign:"left",borderBottom:`1px solid ${M}`,background:"black",cursor:"pointer"},children:["Symbol ",pe("symbol")]}),i.jsxs("th",{onClick:()=>te("tradeType"),style:{width:"7.14%",padding:"8px",textAlign:"center",borderBottom:`1px solid ${M}`,background:"black",fontSize:15,cursor:"pointer"},children:["Trade Type ",pe("tradeType")]}),i.jsxs("th",{onClick:()=>te("quickTradeType"),style:{width:"7.14%",padding:"8px",textAlign:"center",borderBottom:`1px solid ${M}`,background:"black",fontSize:15,cursor:"pointer"},children:["Quick Type ",pe("quickTradeType")]}),i.jsxs("th",{onClick:()=>te("lastPrice"),style:{width:"7.14%",padding:"8px",textAlign:"right",borderBottom:`1px solid ${M}`,background:"black",cursor:"pointer"},children:["Last Price ",pe("lastPrice")]}),i.jsxs("th",{onClick:()=>te("tradeType"),style:{width:"7.14%",padding:"2px 4px",textAlign:"center",borderBottom:`1px solid ${M}`,background:"black",fontSize:15,cursor:"pointer"},children:["SETUP ",pe("tradeType")]}),i.jsxs("th",{onClick:()=>te("flags.news"),style:{width:"7.14%",padding:"2px 4px",textAlign:"center",borderBottom:`1px solid ${M}`,background:"black",fontSize:15,cursor:"pointer"},children:["NEWS ",pe("flags.news")]}),i.jsxs("th",{onClick:()=>te("journalVerdict"),style:{width:"7.14%",padding:"2px 4px",textAlign:"center",borderBottom:`1px solid ${M}`,background:"black",fontSize:15,cursor:"pointer"},children:["VERDICT ",pe("journalVerdict")]}),i.jsxs("th",{onClick:()=>te("entryPrice"),style:{width:"7.14%",padding:"8px",textAlign:"right",borderBottom:`1px solid ${M}`,background:"black",cursor:"pointer"},children:["Entry Price ",pe("entryPrice")]}),i.jsxs("th",{onClick:()=>te("stopLoss"),style:{width:"7.14%",padding:"8px",textAlign:"right",borderBottom:`1px solid ${M}`,background:"black",fontSize:15,cursor:"pointer"},children:["SL ",pe("stopLoss")]}),i.jsxs("th",{onClick:()=>te("takeProfit"),style:{width:"7.14%",padding:"8px",textAlign:"right",borderBottom:`1px solid ${M}`,background:"black",fontSize:15,cursor:"pointer"},children:["TP ",pe("takeProfit")]}),i.jsxs("th",{onClick:()=>te("positionSize"),style:{width:"7.14%",padding:"8px",textAlign:"right",borderBottom:`1px solid ${M}`,background:"black",fontSize:15,cursor:"pointer"},children:["Position ",pe("positionSize")]}),i.jsxs("th",{onClick:()=>te("notes"),style:{width:"7.14%",padding:"8px",textAlign:"left",borderBottom:`1px solid ${M}`,background:"black",fontSize:15,cursor:"pointer"},children:["Notes ",pe("notes")]}),i.jsx("th",{style:{width:"7.14%",padding:"8px",textAlign:"center",borderBottom:`1px solid ${M}`,background:"black",fontSize:15},children:"Execute"})]})}),i.jsx("tbody",{children:xe.map((p,F)=>i.jsxs("tr",{style:{borderBottom:`1px solid ${M}`,background:F%2===0?"#0a0a0a":"#181818",transition:"background 0.2s",boxShadow:"none",outline:"none",cursor:"pointer"},onMouseEnter:j=>j.currentTarget.style.background="#232323",onMouseLeave:j=>j.currentTarget.style.background=F%2===0?"#0a0a0a":"#181818",onClick:j=>{j.target.closest("button")||j.target.tagName==="BUTTON"||j.target.closest("input")||Pe(p)},children:[i.jsx("td",{style:{width:"7.14%",padding:"8px",textAlign:"center"},children:O?i.jsx("input",{type:"checkbox",checked:le.has(p.id),onChange:()=>be(p.id),style:{accentColor:M}}):i.jsx("input",{type:"checkbox",checked:T.has(p.id),onChange:()=>me(p.id),style:{accentColor:M}})}),i.jsx("td",{style:{width:"7.14%",padding:"8px",textAlign:"left"},children:i.jsxs("span",{onClick:j=>{j.stopPropagation(),mt(p.symbol)},style:{color:M,cursor:"pointer",fontFamily:"'Courier New', monospace",fontSize:14,display:"flex",alignItems:"center",gap:"4px",textDecoration:"underline"},title:`Click to open ${p.symbol} chart in new tab`,children:[p.symbol,i.jsx("img",{src:Pt,alt:"Open Chart",style:{width:12,height:12,verticalAlign:"middle"}})]})}),i.jsx("td",{style:{width:"7.14%",padding:"8px",textAlign:"center",cursor:O?"pointer":"default"},onClick:O?()=>{const j=document.querySelector(`select[data-item-id="${p.id}"][data-field="tradeType"]`);j&&j.focus()}:void 0,children:O?i.jsxs("select",{value:p.tradeType||"",onChange:j=>X(p.id,"tradeType",j.target.value),"data-item-id":p.id,"data-field":"tradeType",style:{background:"black",color:M,border:`1px solid ${M}`,padding:"2px 4px",fontFamily:"Courier New",fontSize:12},children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{value:"breakout",children:"Breakout"}),i.jsx("option",{value:"pullback",children:"Pullback"}),i.jsx("option",{value:"shortSqueeze",children:"Short Squeeze"}),i.jsx("option",{value:"postEarnings",children:"Post-Earnings"})]}):i.jsx("span",{style:{fontSize:14},children:p.tradeTypeName||"-"})}),i.jsx("td",{style:{width:"7.14%",padding:"8px",textAlign:"center"},children:i.jsxs("select",{value:p.quickTradeType||"",onChange:j=>{j.stopPropagation(),Ee(p.id,j.target.value)},style:{background:"transparent",color:M,border:"none",borderBottom:`1px solid ${M}`,padding:"1px 2px",fontFamily:"Courier New",fontSize:14,cursor:"pointer",borderRadius:0,width:"90%",textAlign:"center",height:"20px",minHeight:"20px",outline:"none"},onClick:j=>j.stopPropagation(),children:[i.jsx("option",{value:"",children:"-"}),Object.keys($e).map(j=>i.jsx("option",{value:j,children:$e[j].name},j))]})}),i.jsx("td",{style:{width:"7.14%",padding:"8px",textAlign:"right",cursor:O?"text":"default"},onClick:O?()=>{const j=document.querySelector(`input[data-item-id="${p.id}"][data-field="lastPrice"]`);j&&j.focus()}:void 0,children:O?i.jsx("input",{type:"number",step:"0.01",value:p.lastPrice||"",onChange:j=>X(p.id,"lastPrice",parseFloat(j.target.value)||0),placeholder:"0.00","data-item-id":p.id,"data-field":"lastPrice",style:{backgroundColor:"black",color:M,border:`1px solid ${M}`,padding:"4px 6px",fontFamily:"'Courier New', monospace",fontSize:14,width:"60px",textAlign:"right",borderRadius:0}}):i.jsxs("span",{children:["$",p.lastPrice?p.lastPrice.toFixed(2):"0.00"]})}),i.jsx("td",{style:{width:"7.14%",padding:"2px 4px",textAlign:"center"},children:i.jsx("img",{src:p.tradeType?Pt:_t,alt:"SETUP",title:p.tradeTypeName||"No setup selected",style:{width:13,height:13,verticalAlign:"middle",filter:"drop-shadow(0 0 1px #222)"}})}),i.jsx("td",{style:{width:"7.14%",padding:"2px 4px",textAlign:"center"},children:i.jsx("img",{src:p.flags.news||p.newsFlag?Pt:_t,alt:"NEWS",title:"NEWS",style:{width:13,height:13,verticalAlign:"middle",filter:"drop-shadow(0 0 1px #222)"}})}),i.jsx("td",{style:{width:"7.14%",padding:"2px 4px",textAlign:"center"},children:i.jsx("img",{src:p.journalVerdictFlag||_t,alt:"VERDICT",title:p.journalVerdict||"Not journaled",style:{width:13,height:13,verticalAlign:"middle",filter:"drop-shadow(0 0 1px #222)"}})}),i.jsx("td",{style:{width:"7.14%",padding:"8px",textAlign:"right"},children:p.entryPrice!==void 0&&p.entryPrice!==null?p.entryPrice:"-"}),i.jsx("td",{style:{width:"7.14%",padding:"8px",textAlign:"right"},children:p.stopLoss?`$${p.stopLoss}`:"-"}),i.jsx("td",{style:{width:"7.14%",padding:"8px",textAlign:"right"},children:p.target?`$${p.target}`:p.takeProfit?`$${p.takeProfit}`:"-"}),i.jsx("td",{style:{width:"7.14%",padding:"8px",textAlign:"right"},children:p.positionSize?p.positionSize:"-"}),i.jsx("td",{style:{width:"7.14%",padding:"8px",textAlign:"left",cursor:O?"text":"default"},onClick:O?()=>{const j=document.querySelector(`input[data-item-id="${p.id}"][data-field="notes"]`);j&&j.focus()}:void 0,children:O?i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("input",{type:"text",value:p.notes,onChange:j=>X(p.id,"notes",j.target.value),placeholder:"Notes...","data-item-id":p.id,"data-field":"notes",style:{backgroundColor:"black",color:M,borderRadius:0,border:`1px solid ${M}`,fontSize:14,boxShadow:p.notes.trim()?`0 0 4px 0 ${M}22`:"none",fontFamily:"'Courier New', monospace",width:"80px",padding:"4px 6px"}}),i.jsx("button",{onClick:()=>Z(p.id),style:{background:"none",border:"none",color:M,padding:0,margin:0,cursor:"pointer",fontSize:14,display:"inline-flex",alignItems:"center",transition:"all 0.2s"},title:"Delete Ticker",children:i.jsx(hs,{})})]}):i.jsx("span",{style:{color:M,fontFamily:"'Courier New', monospace",fontSize:14},children:p.notes||"-"})}),i.jsx("td",{style:{width:"7.14%",padding:"8px",textAlign:"center"},children:i.jsx("button",{onClick:()=>et(p),disabled:!p.tradeType||!p.entryPrice||!p.stopLoss||!p.target,style:{background:!p.tradeType||!p.entryPrice||!p.stopLoss||!p.target?"#222":M,color:!p.tradeType||!p.entryPrice||!p.stopLoss||!p.target?M:"black",border:`1px solid ${M}`,borderRadius:0,padding:"6px 12px",fontFamily:"'Courier New', monospace",fontWeight:700,fontSize:14,cursor:!p.tradeType||!p.entryPrice||!p.stopLoss||!p.target?"not-allowed":"pointer",transition:"all 0.2s",minWidth:60,height:"32px",minHeight:"32px",display:"flex",alignItems:"center",justifyContent:"center"},title:!p.tradeType||!p.entryPrice||!p.stopLoss||!p.target?"Complete journal entry first":"Execute trade",children:"EXECUTE"})})]},p.id))})]})]}),!n&&i.jsx("div",{style:{textAlign:"center",color:"#999",fontFamily:"'Courier New', monospace",marginTop:"50px"},children:"‚ö†Ô∏è Universe not found."}),n&&(((kt=n==null?void 0:n.items)==null?void 0:kt.length)||0)===0&&i.jsx("div",{style:{textAlign:"center",color:"#999",fontFamily:"'Courier New', monospace",marginTop:"50px"},children:"‚ö†Ô∏è No tickers in universe yet. Add some tickers above to get started."}),Y&&P&&i.jsxs(i.Fragment,{children:[i.jsx("div",{onClick:ot,style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.3)",zIndex:10009,pointerEvents:"auto"}}),i.jsxs("div",{style:{position:"fixed",top:0,right:0,width:800,height:"100vh",background:"#0a0a0a",color:M,zIndex:10010,boxShadow:`-4px 0 24px 0 ${M}33`,borderLeft:`2px solid ${M}`,display:"flex",flexDirection:"column",transition:"transform 0.3s",fontFamily:"Courier New",padding:0,pointerEvents:"auto"},onClick:p=>p.stopPropagation(),onMouseDown:p=>p.stopPropagation(),children:[i.jsxs("div",{style:{padding:28,flex:1,overflowY:"auto"},children:[i.jsxs("h2",{style:{color:M,marginBottom:18,fontWeight:700,fontSize:24},children:["Journal: ",P.symbol]}),i.jsxs("div",{style:{marginBottom:"30px"},children:[i.jsx("h3",{style:{marginBottom:"15px",fontSize:"18px"},children:"1. SELECT SETUP TYPE"}),i.jsx("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap"},children:Object.entries($e).map(([p,F])=>i.jsx("button",{onClick:()=>je(p),style:{background:_===p?M:"transparent",color:_===p?"#000":M,border:`2px solid ${M}`,fontWeight:_===p?"bold":"normal",padding:"8px 16px",fontFamily:"Courier New",cursor:"pointer"},children:F.name},p))})]}),_&&i.jsxs("div",{style:{marginBottom:"30px"},children:[i.jsxs("h3",{style:{marginBottom:"15px",fontSize:"18px"},children:["2. VERIFY SETUP CRITERIA (",$e[_].name,")"]}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"10px",border:`2px solid ${M}`,padding:"16px",borderRadius:"4px",background:"rgba(140,185,162,0.04)",marginBottom:"20px"},children:$e[_].checklists.map((p,F)=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px",cursor:"pointer"},children:[i.jsx("span",{onClick:()=>Ae(p),style:{display:"inline-flex",alignItems:"center",cursor:"pointer"},tabIndex:0,onKeyDown:j=>{(j.key===" "||j.key==="Enter")&&Ae(p)},role:"checkbox","aria-checked":W[p]||!1,children:i.jsx("img",{src:W[p]?hn:pn,alt:W[p]?"Checked":"Unchecked",style:{width:22,height:22}})}),i.jsx("span",{style:{fontSize:"14px"},children:p})]},F))}),i.jsxs("div",{style:{marginTop:24},children:[i.jsx("h4",{style:{marginBottom:"10px",fontSize:"16px",color:M},children:"News Validation"}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"10px",border:`2px solid ${M}`,padding:"16px",borderRadius:"4px",background:"rgba(140,185,162,0.04)"},children:$e[_].newsValidation.map((p,F)=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px",cursor:"pointer"},children:[i.jsx("span",{onClick:()=>Ae(p),style:{display:"inline-flex",alignItems:"center",cursor:"pointer"},tabIndex:0,onKeyDown:j=>{(j.key===" "||j.key==="Enter")&&Ae(p)},role:"checkbox","aria-checked":W[p]||!1,children:i.jsx("img",{src:W[p]?hn:pn,alt:W[p]?"Checked":"Unchecked",style:{width:22,height:22}})}),i.jsx("span",{style:{fontSize:"14px"},children:p})]},F))})]})]}),_&&i.jsxs("div",{style:{marginBottom:"30px"},children:[i.jsx("h3",{style:{marginBottom:"15px",fontSize:"18px"},children:"3. ENTRY DETAILS"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px"},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:"5px"},children:"Entry Price:"}),i.jsx("input",{type:"number",step:"0.01",value:I,onChange:p=>q(p.target.value),style:{width:"100%",padding:"8px",background:"transparent",border:`1px solid ${M}`,color:M,fontFamily:"Courier New"}}),L?i.jsx("div",{style:{fontSize:"12px",color:M,marginTop:"4px",fontStyle:"italic"},children:"üîÑ Fetching current market price..."}):m?i.jsxs("div",{style:{fontSize:"12px",color:M,marginTop:"4px",padding:"4px 8px",border:`1px solid ${M}`,borderRadius:"2px",background:"rgba(140,185,162,0.1)"},children:["üìä Current Market: $",m.toFixed(2),i.jsx("button",{onClick:()=>{q(m.toFixed(2)),f(`Entry price updated to current market price: $${m.toFixed(2)}`),x("success")},style:{marginLeft:"8px",background:"transparent",border:`1px solid ${M}`,color:M,padding:"2px 6px",fontSize:"10px",cursor:"pointer",fontFamily:"Courier New"},children:"USE"})]}):i.jsx("div",{style:{fontSize:"12px",color:"#666",marginTop:"4px",fontStyle:"italic"},children:"Unable to fetch current market price"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:"5px"},children:"Stop Loss:"}),i.jsx("input",{type:"number",step:"0.01",value:H,onChange:p=>z(p.target.value),style:{width:"100%",padding:"8px",background:"transparent",border:`1px solid ${M}`,color:M,fontFamily:"Courier New"}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:"5px"},children:"Target:"}),i.jsx("input",{type:"number",step:"0.01",value:V,onChange:p=>ee(p.target.value),style:{width:"100%",padding:"8px",background:"transparent",border:`1px solid ${M}`,color:M,fontFamily:"Courier New"}})]})]})]}),_&&i.jsxs("div",{style:{marginBottom:"30px"},children:[i.jsx("h3",{style:{marginBottom:"15px",fontSize:"18px"},children:"4. RISK MANAGEMENT"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px"},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:"5px"},children:"Account Size ($):"}),i.jsx("input",{type:"number",value:ge,onChange:p=>ve(p.target.value),style:{width:"100%",padding:"8px",background:"transparent",border:`1px solid ${M}`,color:M,fontFamily:"Courier New"}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:"5px"},children:"Risk Per Trade (%):"}),i.jsx("input",{type:"number",step:"0.1",value:ye,onChange:p=>Ce(p.target.value),style:{width:"100%",padding:"8px",background:"transparent",border:`1px solid ${M}`,color:M,fontFamily:"Courier New"}})]})]}),i.jsx("div",{style:{marginTop:"15px",padding:"15px",border:`1px solid ${M}`,background:"rgba(140,185,162,0.1)"},children:i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"10px"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Risk:Reward:"})," ",we()?`${we()}:1`:"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Position Size:"})," ",Le()?`${Le()} shares`:"N/A"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Risk Amount:"})," ",ge&&ye?`$${(parseFloat(ge)*parseFloat(ye)/100).toFixed(2)}`:"N/A"]})]})})]}),ke()&&i.jsxs("div",{style:{marginBottom:"30px"},children:[i.jsx("h3",{style:{marginBottom:"15px",fontSize:"18px"},children:"5. SETUP VERDICT"}),i.jsxs("div",{style:{padding:"15px",border:`2px solid ${M}`,textAlign:"center",fontSize:"18px",fontWeight:"bold",background:ke().type==="qualified"?"rgba(0,255,0,0.1)":ke().type==="discretionary"?"rgba(255,165,0,0.1)":"rgba(255,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px"},children:[i.jsx("img",{src:ke().flag,alt:ke().text,style:{width:"24px",height:"24px"}}),ke().text]}),ke().type!=="qualified"&&i.jsxs("div",{style:{marginTop:"15px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"5px"},children:"Override Reason (Required for Discretionary/Blocked):"}),i.jsx("textarea",{value:Ie,onChange:p=>fe(p.target.value),style:{width:"100%",padding:"8px",background:"transparent",border:`1px solid ${M}`,color:M,fontFamily:"Courier New",minHeight:"60px"},placeholder:"Explain why you're proceeding despite failed criteria..."})]})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:16,padding:20,borderTop:`1.5px solid ${M}`,background:"#111"},children:[i.jsx("button",{onClick:ot,style:{fontFamily:"Courier New",fontWeight:700,fontSize:17,borderRadius:4,padding:"8px 28px",cursor:"pointer",transition:"all 0.2s",background:"black",color:M,border:`2px solid ${M}`},children:"Cancel"}),i.jsx("button",{onClick:ft,style:{fontFamily:"Courier New",fontWeight:700,fontSize:17,borderRadius:4,padding:"8px 28px",cursor:"pointer",transition:"all 0.2s",background:M,color:"black",border:`2px solid ${M}`},children:"Save Journal"})]})]})]}),i.jsx("div",{style:{marginTop:32,display:"flex",justifyContent:"center"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",width:420,gap:10,height:"32px"},children:[i.jsx("input",{type:"text",value:l,onChange:p=>d(p.target.value),placeholder:"e.g. AAPL, MSFT, GOOGL, TSLA",style:{flex:1,fontFamily:"'Courier New', Courier, monospace",fontSize:"14px",backgroundColor:"black",border:`1px solid ${M}`,color:M,padding:"6px 12px",boxSizing:"border-box",minWidth:0,borderRadius:0,height:"32px",maxHeight:"32px",minHeight:"32px",margin:0,outline:"none",lineHeight:"20px"},onKeyDown:p=>{p.key==="Enter"&&(p.preventDefault(),Q())}}),i.jsx(de,{onClick:Q,disabled:b||!l.trim(),mobile:!1,title:"Add ticker(s)",style:{backgroundColor:b?"#666666":M,color:"black",opacity:b?.6:1,minWidth:0,height:"32px",minHeight:"32px",fontSize:"0.9rem",display:"flex",alignItems:"center",justifyContent:"center",padding:"6px 12px",borderRadius:0},children:b?"...":"+++"})]})})]})]})},He="rgb(140,185,162)",xs=()=>{const t=it(),e=dt(),[r,n]=S.useState({}),{notification:o,notificationType:a,setNotification:s,setNotificationType:l}=St(),[d,h]=S.useState(!1),[u,f]=S.useState(!1),[x,b]=S.useState(!1),[k,T]=S.useState(null),{isInverted:w}=ut(),v=ne(He),y=ne("black"),C=ne("#e31507"),A=ne("#888");S.useEffect(()=>{try{const $=localStorage.getItem("burnlist_universes");if($){const I=JSON.parse($);n(I)}}catch($){console.error("Failed to load universes:",$)}},[]),S.useEffect(()=>{localStorage.setItem("burnlist_universes",JSON.stringify(r))},[r]);const R=()=>{f(!0),setTimeout(()=>f(!1),150);const I=`Universe ${yt(new Date)}`,q=Jt(),H=I.toLowerCase().replace(/[^a-z0-9]/g,"-");if(Object.values(r).some(ge=>ge.name&&ge.name.toLowerCase()===I.toLowerCase())){s("‚ö†Ô∏è Universe name already exists"),l("error");return}const V={id:q,name:I,slug:H,items:[],reason:"",createdAt:new Date().toISOString()},ee={...r,[q]:V};n(ee),localStorage.setItem("burnlist_universes",JSON.stringify(ee)),s("")},Y=$=>{const I=Object.keys(r).find(z=>r[z].id===$);if(!I){c.log("üóëÔ∏è Could not find universe with id:",$);return}const{[I]:q,...H}=r;n(H),localStorage.setItem("burnlist_universes",JSON.stringify(H)),q?c.log("üóëÔ∏è Deleted universe:",q.name):c.log("üóëÔ∏è Deleted universe with id:",$)};S.useCallback(($,I)=>{if(Object.values(r).some(H=>H.id!==$&&H.name&&H.name.toLowerCase()===I.toLowerCase())){s("‚ö†Ô∏è Name already exists"),l("error");return}n(H=>{const z={...H};return z[$]&&(z[$]={...z[$],name:I,slug:I.toLowerCase().replace(/[^a-z0-9]/g,"-")}),localStorage.setItem("burnlist_universes",JSON.stringify(z)),z})},[n,r]);const g=S.useCallback(($,I)=>{const q={...r,[$]:{...r[$],reason:I}};n(q),localStorage.setItem("burnlist_universes",JSON.stringify(q))},[n,r]),[P,E]=S.useState({});S.useEffect(()=>{if(d){const $={};Object.values(r).forEach(I=>{$[I.id]={value:I.name,prev:I.name}}),E($)}else E({})},[d,r]);const _=($,I)=>{E(q=>({...q,[$]:{...q[$],value:I}}))},U=$=>{var H;const I=((H=P[$])==null?void 0:H.value)||"";if(Object.values(r).some(z=>z.id!==$&&z.name&&z.name.toLowerCase()===I.toLowerCase())){s("‚ö†Ô∏è Name already exists"),l("error"),E(z=>({...z,[$]:{...z[$],value:z[$].prev}}));return}n(z=>{const V={...z};return V[$]&&(V[$]={...V[$],name:I,slug:I.toLowerCase().replace(/[^a-z0-9]/g,"-")}),localStorage.setItem("burnlist_universes",JSON.stringify(V)),V}),E(z=>({...z,[$]:{...z[$],prev:I}}))},W=S.useMemo(()=>Object.values(r),[r]);return i.jsx("div",{style:{fontFamily:"Courier New",color:v,backgroundColor:y,minHeight:"100vh",padding:"0"},children:i.jsxs("div",{style:{padding:"32px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:24},children:[i.jsx("div",{children:i.jsx("strong",{style:{fontSize:"170%",color:y},children:"UNIVERSE SCREENER"})}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:10},children:i.jsxs("span",{style:{color:v},children:["UNIVERSES: ",Object.keys(r).length]})})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"10px 20px",borderBottom:`1px solid ${He}`,background:"rgba(0,0,0,0.3)",gap:"10px",marginBottom:"20px"},children:[i.jsx(de,{onClick:()=>t("/universes"),style:{background:e.pathname==="/universes"||e.pathname.startsWith("/universe/")?He:"transparent",color:e.pathname==="/universes"||e.pathname.startsWith("/universe/")?"#000000":He,border:`1px solid ${He}`,padding:"8px 16px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"UNIVERSE"}),i.jsx(de,{onClick:()=>t("/journal"),style:{background:e.pathname==="/journal"?He:"transparent",color:e.pathname==="/journal"?"#000000":He,border:`1px solid ${He}`,padding:"8px 16px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"JOURNAL"}),i.jsx(de,{onClick:()=>t("/market"),style:{background:e.pathname==="/market"?He:"transparent",color:e.pathname==="/market"?"#000000":He,border:`1px solid ${He}`,padding:"8px 16px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"MARKET"}),i.jsx(de,{onClick:()=>t("/"),style:{background:e.pathname==="/"||e.pathname.startsWith("/burn/")?He:"transparent",color:e.pathname==="/"||e.pathname.startsWith("/burn/")?"#000000":He,border:`1px solid ${He}`,padding:"8px 16px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"BURNPAGE"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[i.jsx("style",{children:`
            .clicked-button {
              background-color: ${y} !important;
              color: ${v} !important;
            }
          `}),i.jsx(de,{onClick:()=>{h(!d),c.log("üõ†Ô∏è Edit mode:",!d)},style:{backgroundColor:d?v:y,color:d?y:v},children:d?"DONE":"EDIT"})]}),o&&i.jsx("div",{style:{position:"fixed",top:24,left:0,right:0,zIndex:10001,display:"flex",justifyContent:"center",pointerEvents:"none"},children:i.jsx("div",{style:{minWidth:320,maxWidth:480,pointerEvents:"auto"},children:i.jsx(Je,{message:o,type:a,onClose:()=>s("")})})}),x&&i.jsx(Je,{message:"Loading universes...",type:"loading"}),k&&i.jsx(Je,{message:k,type:"error",onClose:()=>T(null)}),Object.keys(r).length===0&&i.jsx("p",{style:{textAlign:"center",color:A,marginTop:"50px"},children:"No universes found. Create your first universe to get started."}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 252px)",rowGap:"20px",columnGap:"20px",margin:"70px 0 1px 0",justifyContent:"center",alignItems:"start"},children:W.map(($,I)=>{var z;const q=$.items||[],H=i.jsxs("div",{style:{width:252,height:d?250:120,fontFamily:"Courier New",background:"transparent",padding:"10px 8px",margin:0,border:`1px solid ${v}`,borderRadius:0,boxShadow:"none",display:"flex",flexDirection:"column",alignItems:"stretch",justifyContent:"flex-start",position:"relative",boxSizing:"border-box",overflow:"hidden"},children:[d?i.jsx("input",{value:((z=P[$.id])==null?void 0:z.value)??$.name,onChange:V=>_($.id,V.target.value),onBlur:()=>U($.id),onKeyDown:V=>{V.key==="Enter"&&(V.preventDefault(),U($.id))},style:{fontFamily:"Courier New",fontSize:18,color:v,background:y,border:`1px solid ${A}`,marginBottom:4,padding:"2px 4px",width:"100%",fontWeight:"bold",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}):i.jsx("div",{style:{fontSize:18,color:v,fontWeight:"bold",marginBottom:4,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:$.name||`UNIVERSE ${I+1}`}),d&&i.jsx(de,{onClick:()=>Y($.id),style:{backgroundColor:y,color:C,border:`1px solid ${C}`,padding:"2px 6px",marginBottom:4,fontSize:10,width:"100%",fontWeight:"bold"},children:"DELETE"}),d?i.jsx("input",{value:$.reason||"",onChange:V=>g($.id,V.target.value),style:{fontFamily:"Courier New",fontSize:14,color:v,background:y,border:`1px solid ${A}`,marginBottom:4,padding:"2px 4px",width:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},placeholder:"Reason..."}):i.jsx("div",{style:{fontSize:14,color:v,marginBottom:4,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:$.reason||"N/A"}),i.jsxs("div",{style:{fontSize:13,color:v,marginBottom:2},children:[q.length," tickers"]}),i.jsx("div",{style:{fontSize:11,color:A,marginBottom:2},children:yt($.createdAt)}),i.jsx("div",{style:{fontSize:19,color:v,fontWeight:"bold",marginBottom:2},children:q.length>0?"ACTIVE":"EMPTY"})]});return i.jsx("div",{style:{margin:0},children:d?H:i.jsx(Zt,{to:`/universe/${$.slug}`,style:{textDecoration:"none",color:"inherit"},children:H})},$.id)})}),i.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:"20px",marginBottom:"20px"},children:i.jsx(de,{onClick:R,className:u?"clicked-button":"",style:{backgroundColor:v,color:y,transition:"all 0.2s ease-in-out",padding:"8px 16px",fontSize:"14px",fontWeight:"bold"},children:"+++"})})]})})},gn="rgb(140,185,162)",ys=({value:t,onSelect:e})=>{const[r,n]=S.useState([]);return S.useEffect(()=>{try{const o=localStorage.getItem("burnlist_watchlists");if(o){const a=JSON.parse(o),s=Object.values(a).map(l=>({name:l.name,slug:l.slug}));n(s)}}catch{n([])}},[]),i.jsxs("select",{value:t||"",onChange:o=>e&&e(o.target.value),style:{background:"black",color:gn,border:`1px solid ${gn}`,fontFamily:"Courier New, monospace",fontSize:16,padding:"6px 12px",borderRadius:4,outline:"none",minWidth:180,margin:0},children:[i.jsx("option",{value:"",disabled:!0,children:"Select Watchlist"}),r.map(o=>i.jsx("option",{value:o.slug,children:o.name},o.slug))]})},ie="rgb(140,185,162)",bs="#e31507",jt={border:`1.5px solid ${ie}`,borderRadius:4,background:"black",color:ie,fontFamily:"Courier New",padding:16,marginBottom:24,boxShadow:"0 2px 8px 0 rgba(140,185,162,0.08)"};function ws(t){var o,a;if(!t||!Array.isArray(t.historicalData)||t.historicalData.length<2)return{latest:null,change:null};const e=(o=t.historicalData[t.historicalData.length-1])==null?void 0:o.price,r=(a=t.historicalData[t.historicalData.length-2])==null?void 0:a.price;if(typeof e!="number"||typeof r!="number"||r===0)return{latest:null,change:null};const n=(e-r)/r*100;return{latest:e,change:n}}function Ss(){const t=S.useRef(null);return S.useEffect(()=>{t.current&&(t.current.innerHTML="");const e=document.createElement("script");return e.type="text/javascript",e.async=!0,e.src="https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js",e.innerHTML=JSON.stringify({allow_symbol_change:!0,calendar:!1,details:!1,hide_side_toolbar:!0,hide_top_toolbar:!0,hide_legend:!0,hide_volume:!0,hotlist:!1,interval:"D",locale:"en",save_image:!1,style:"1",symbol:"NASDAQ:AAPL",theme:"dark",timezone:"Etc/UTC",backgroundColor:"rgba(0, 0, 0, 1)",gridColor:"rgba(102, 187, 106, 0.06)",watchlist:[],withdateranges:!1,compareSymbols:[],studies:["STD;DEMA"],autosize:!0,overrides:{"mainSeriesProperties.candleStyle.upColor":"#00aaff","mainSeriesProperties.candleStyle.downColor":"#ffe600","mainSeriesProperties.candleStyle.borderUpColor":"#00aaff","mainSeriesProperties.candleStyle.borderDownColor":"#ffe600","mainSeriesProperties.candleStyle.wickUpColor":"#00aaff","mainSeriesProperties.candleStyle.wickDownColor":"#ffe600"}}),t.current&&t.current.appendChild(e),()=>{t.current&&(t.current.innerHTML="")}},[]),i.jsxs("div",{className:"tradingview-widget-container",style:{height:"150px",width:"100%"},children:[i.jsx("div",{ref:t,className:"tradingview-widget-container__widget",style:{height:"167px",width:"100%"}}),i.jsx("div",{className:"tradingview-widget-copyright",children:i.jsx("a",{href:"https://www.tradingview.com/",rel:"noopener nofollow",target:"_blank",children:i.jsx("span",{className:"blue-text",children:"Track all markets on TradingView"})})})]})}const vs=()=>{const t=it(),e=dt(),[r,n]=S.useState(""),[o,a]=S.useState(null);return S.useEffect(()=>{if(!r){a(null);return}try{const s=localStorage.getItem("burnlist_watchlists");if(s){const l=JSON.parse(s),d=Object.values(l).find(h=>h.slug===r);a(d||null)}else a(null)}catch{a(null)}},[r]),i.jsxs("div",{style:{fontFamily:"Courier New",color:ie,background:"black",minHeight:"100vh",padding:"0"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"10px 20px",borderBottom:`1px solid ${ie}`,background:"rgba(0,0,0,0.3)",gap:"10px",marginBottom:"20px"},children:[i.jsx(CustomButton,{onClick:()=>t("/universes"),style:{background:e.pathname==="/universes"||e.pathname.startsWith("/universe/")?ie:"transparent",color:e.pathname==="/universes"||e.pathname.startsWith("/universe/")?"#000000":ie,border:`1px solid ${ie}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"UNIVERSE"}),i.jsx(CustomButton,{onClick:()=>t("/journal"),style:{background:e.pathname==="/journal"?ie:"transparent",color:e.pathname==="/journal"?"#000000":ie,border:`1px solid ${ie}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"JOURNAL"}),i.jsx(CustomButton,{onClick:()=>t("/market"),style:{background:e.pathname==="/market"?ie:"transparent",color:e.pathname==="/market"?"#000000":ie,border:`1px solid ${ie}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"MARKET"}),i.jsx(CustomButton,{onClick:()=>t("/"),style:{background:e.pathname==="/"||e.pathname.startsWith("/burn/")?ie:"transparent",color:e.pathname==="/"||e.pathname.startsWith("/burn/")?"#000000":ie,border:`1px solid ${ie}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"BURNPAGE"})]}),i.jsxs("div",{style:{padding:"32px"},children:[i.jsxs("div",{style:{...jt,display:"flex",justifyContent:"space-between",alignItems:"center",fontWeight:700,fontSize:18},children:[i.jsx("div",{children:"Total Equity: $100,000"}),i.jsx("div",{children:"Cash: $20,000"}),i.jsxs("div",{children:["Open P/L: ",i.jsx("span",{style:{color:ie},children:"+$1,200"})]}),i.jsxs("div",{children:["% Allocated: ",i.jsx("span",{style:{border:`1px solid ${ie}`,padding:"2px 12px",borderRadius:2},children:"80%"})]}),i.jsx("div",{children:"Exposure: Long 70% / Short 10%"})]}),i.jsxs("div",{style:{display:"flex",gap:32},children:[i.jsx("div",{style:{flex:2},children:i.jsxs("div",{style:{...jt,minHeight:320},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("div",{style:{fontWeight:700,fontSize:17},children:"Positions"}),i.jsx("button",{style:{background:"none",color:ie,border:`1px solid ${ie}`,fontFamily:"Courier New",fontSize:15,padding:"4px 18px",borderRadius:2,cursor:"pointer"},children:"Add Position"}),i.jsx("button",{style:{background:"none",color:ie,border:`1px solid ${ie}`,fontFamily:"Courier New",fontSize:15,padding:"4px 18px",borderRadius:2,cursor:"pointer"},children:"Export .json"})]}),i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:15},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{borderBottom:`1.5px solid ${ie}`},children:[i.jsx("th",{style:{textAlign:"left",padding:6},children:"Ticker"}),i.jsx("th",{style:{textAlign:"right",padding:6},children:"Buy"}),i.jsx("th",{style:{textAlign:"right",padding:6},children:"Current"}),i.jsx("th",{style:{textAlign:"right",padding:6},children:"% Return"}),i.jsx("th",{style:{textAlign:"right",padding:6},children:"$ Return"}),i.jsx("th",{style:{textAlign:"right",padding:6},children:"Size"}),i.jsx("th",{style:{textAlign:"right",padding:6},children:"Held"}),i.jsx("th",{style:{textAlign:"center",padding:6},children:"Status"}),i.jsx("th",{style:{textAlign:"center",padding:6},children:"Notes"}),i.jsx("th",{style:{textAlign:"center",padding:6},children:"Trade"})]})}),i.jsx("tbody",{children:[1,2,3].map(s=>i.jsxs("tr",{style:{borderBottom:"1px solid #222"},children:[i.jsx("td",{style:{padding:6},children:"AAPL"}),i.jsx("td",{style:{padding:6,textAlign:"right"},children:"$180.00"}),i.jsx("td",{style:{padding:6,textAlign:"right"},children:"$185.00"}),i.jsx("td",{style:{padding:6,textAlign:"right",color:ie},children:"+2.8%"}),i.jsx("td",{style:{padding:6,textAlign:"right",color:ie},children:"+$50"}),i.jsx("td",{style:{padding:6,textAlign:"right"},children:"$1,000"}),i.jsx("td",{style:{padding:6,textAlign:"right"},children:"3d"}),i.jsx("td",{style:{padding:6,textAlign:"center"},children:"Open"}),i.jsx("td",{style:{padding:6,textAlign:"center"},children:"üìù"}),i.jsx("td",{style:{padding:6,textAlign:"center"},children:i.jsx("button",{style:{background:"none",color:ie,border:`1px solid ${ie}`,fontFamily:"Courier New",fontSize:14,padding:"2px 10px",borderRadius:2,cursor:"pointer"},children:"Trade"})})]},s))})]})]})}),i.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:24},children:[i.jsxs("div",{style:{...jt,minHeight:60,display:"flex",flexDirection:"column",alignItems:"stretch",justifyContent:"flex-start",padding:0},children:[i.jsx("div",{style:{padding:16,borderBottom:o&&Array.isArray(o.items)&&o.items.length>0?"1px solid #222":"none"},children:i.jsx(ys,{value:r,onSelect:n})}),o&&Array.isArray(o.items)&&o.items.length>0&&i.jsx("div",{style:{maxHeight:220,overflowY:"auto",padding:0},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:15},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{borderBottom:`1.5px solid ${ie}`},children:[i.jsx("th",{style:{textAlign:"left",padding:6,position:"sticky",top:0,background:"black",zIndex:1},children:"Symbol"}),i.jsx("th",{style:{textAlign:"right",padding:6,position:"sticky",top:0,background:"black",zIndex:1},children:"Latest"}),i.jsx("th",{style:{textAlign:"right",padding:6,position:"sticky",top:0,background:"black",zIndex:1},children:"% Change"})]})}),i.jsx("tbody",{children:o.items.map((s,l)=>{const{latest:d,change:h}=ws(s);return i.jsxs("tr",{style:{borderBottom:"1px solid #222"},children:[i.jsx("td",{style:{padding:6},children:s.symbol}),i.jsx("td",{style:{padding:6,textAlign:"right"},children:typeof d=="number"?`$${d.toFixed(2)}`:"--"}),i.jsx("td",{style:{padding:6,textAlign:"right",color:typeof h=="number"?h>=0?ie:bs:"#888"},children:typeof h=="number"?`${h>=0?"+":""}${h.toFixed(2)}%`:"--"})]},s.symbol||l)})})]})})]}),i.jsx("div",{style:{...jt,minHeight:180},children:i.jsx(Ss,{})})]})]}),i.jsxs("div",{style:{...jt,maxWidth:420,margin:"40px auto 0 auto",background:"#181818"},children:[i.jsx("div",{style:{fontWeight:700,fontSize:16,marginBottom:8},children:"Quick Trade Panel"}),i.jsxs("div",{style:{display:"flex",gap:10,marginBottom:8},children:[i.jsx("input",{placeholder:"Symbol",style:{flex:1,background:"black",color:ie,border:`1px solid ${ie}`,borderRadius:2,padding:"4px 8px",fontFamily:"Courier New"}}),i.jsxs("select",{style:{background:"black",color:ie,border:`1px solid ${ie}`,borderRadius:2,padding:"4px 8px",fontFamily:"Courier New"},children:[i.jsx("option",{children:"Long"}),i.jsx("option",{children:"Short"})]}),i.jsx("input",{placeholder:"Amount",style:{width:80,background:"black",color:ie,border:`1px solid ${ie}`,borderRadius:2,padding:"4px 8px",fontFamily:"Courier New"}})]}),i.jsxs("div",{style:{display:"flex",gap:10,marginBottom:8},children:[i.jsx("input",{placeholder:"Stop-loss ($ or %)",style:{flex:1,background:"black",color:ie,border:`1px solid ${ie}`,borderRadius:2,padding:"4px 8px",fontFamily:"Courier New"}}),i.jsx("input",{placeholder:"Take-profit ($ or %)",style:{flex:1,background:"black",color:ie,border:`1px solid ${ie}`,borderRadius:2,padding:"4px 8px",fontFamily:"Courier New"}})]}),i.jsx("textarea",{placeholder:"Reason (optional)",style:{width:"100%",background:"black",color:ie,border:`1px solid ${ie}`,borderRadius:2,padding:"4px 8px",fontFamily:"Courier New",minHeight:40,marginBottom:8}}),i.jsx("button",{style:{width:"100%",background:ie,color:"black",border:"none",borderRadius:2,fontFamily:"Courier New",fontWeight:700,fontSize:15,padding:"8px 0",cursor:"pointer"},children:"Submit Trade"})]})]})]})},G="rgb(140,185,162)",Cs=()=>{const{isInverted:t}=ut(),e=it(),r=dt(),[n,o]=S.useState([]),{notification:a,notificationType:s,setNotification:l}=St(),[d,h]=S.useState(!1),[u,f]=S.useState(new Set);S.useEffect(()=>{const g=localStorage.getItem("trade_journal_trades");if(g)try{o(JSON.parse(g))}catch(P){c.error("Error loading trades:",P)}},[]),S.useEffect(()=>{localStorage.setItem("trade_journal_trades",JSON.stringify(n))},[n]);const x=(g,P)=>{o(E=>E.map(_=>_.id===g?{..._,...P}:_))},b=g=>{o(P=>P.filter(E=>E.id!==g)),l("Trade deleted","success")},k=g=>new Date(g).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"2-digit"}),T=async g=>{if(g)try{const P=await _r(g),_=`https://www.tradingview.com/chart/i0seCgVv/?symbol=${encodeURIComponent(`${P}:${g.toUpperCase()}`)}`;window.open(_,"_blank")}catch(P){c.warn(`‚ö†Ô∏è Error opening chart for ${g}:`,P);const _=`https://www.tradingview.com/chart/i0seCgVv/?symbol=${encodeURIComponent(`NASDAQ:${g.toUpperCase()}`)}`;window.open(_,"_blank")}},v=(()=>{if(!n||n.length===0)return{totalTrades:0,winTrades:0,lossTrades:0,openTrades:0,winRate:0,averageReturn:0};const g=n.filter(I=>I.outcome&&I.outcome!=="Open"),P=g.filter(I=>I.outcome==="Win").length,E=g.filter(I=>I.outcome==="Loss").length,_=n.filter(I=>!I.outcome||I.outcome==="Open").length,U=g.length>0?P/g.length*100:0,W=g.reduce((I,q)=>{if(!q.entryPrice||!q.target)return I;const H=parseFloat(q.entryPrice),z=parseFloat(q.target);if(isNaN(H)||isNaN(z)||H<=0)return I;const V=(z-H)/H*100;return I+V},0),$=g.length>0?W/g.length:0;return{totalTrades:n.length,winTrades:P,lossTrades:E,openTrades:_,winRate:U,averageReturn:$}})(),y=()=>{h(!d),f(new Set)},C=g=>{f(P=>{const E=new Set(P);return E.has(g)?E.delete(g):E.add(g),E})},A=()=>{u.size===n.length?f(new Set):f(new Set(n.map(g=>g.id)))},R=()=>{if(u.size===0){l("Please select at least one trade to delete","error");return}o(g=>g.filter(P=>!u.has(P.id))),f(new Set),l(`Deleted ${u.size} trades`,"success")},Y=()=>{if(u.size===0){l("Please select at least one trade to create burnlist","error");return}const g=n.filter(I=>u.has(I.id)),P=JSON.parse(localStorage.getItem("burnlist_watchlists")||"{}"),E=`Journal_${new Date().toISOString().split("T")[0]}`,_=`journal_${Date.now()}`,U=E.toLowerCase().replace(/[^a-z0-9]/g,"-"),W={id:_,name:E,slug:U,items:g.map(I=>({symbol:I.ticker,buyPrice:parseFloat(I.entryPrice)||0,buyDate:I.executedAt||I.date||new Date().toISOString(),historicalData:[]})),reason:`Created from journal with ${g.length} trades`,createdAt:new Date().toISOString()},$={...P,[_]:W};localStorage.setItem("burnlist_watchlists",JSON.stringify($)),l(`Created burnlist "${E}" with ${g.length} stocks`,"success"),f(new Set)};return i.jsxs("div",{style:{backgroundColor:t?"rgb(140,185,162)":"#000000",color:t?"#000000":"#ffffff",minHeight:"100vh",padding:"0",fontFamily:"'Courier New', monospace"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"20px",borderBottom:`2px solid ${G}`,background:"rgba(0,0,0,0.3)"},children:[i.jsx("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:i.jsx("h1",{style:{color:G,margin:0,fontSize:"24px",fontWeight:"bold"},children:"TRADE JOURNAL"})}),i.jsxs("div",{style:{color:G,fontSize:"14px"},children:[n.length," Trades Logged"]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"10px 20px",borderBottom:`1px solid ${G}`,background:"rgba(0,0,0,0.3)",gap:"10px",marginBottom:"20px"},children:[i.jsx(de,{onClick:()=>e("/universes"),style:{background:r.pathname==="/universes"||r.pathname.startsWith("/universe/")?G:"transparent",color:r.pathname==="/universes"||r.pathname.startsWith("/universe/")?"#000000":G,border:`1px solid ${G}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"UNIVERSE"}),i.jsx(de,{onClick:()=>e("/journal"),style:{background:r.pathname==="/journal"?G:"transparent",color:r.pathname==="/journal"?"#000000":G,border:`1px solid ${G}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"JOURNAL"}),i.jsx(de,{onClick:()=>e("/market"),style:{background:r.pathname==="/market"?G:"transparent",color:r.pathname==="/market"?"#000000":G,border:`1px solid ${G}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"MARKET"}),i.jsx(de,{onClick:()=>e("/"),style:{background:r.pathname==="/"||r.pathname.startsWith("/burn/")?G:"transparent",color:r.pathname==="/"||r.pathname.startsWith("/burn/")?"#000000":G,border:`1px solid ${G}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"BURNPAGE"})]}),v.totalTrades>0&&i.jsxs("div",{style:{display:"flex",justifyContent:"space-around",alignItems:"center",padding:"12px 20px",background:"rgba(0,0,0,0.2)","@media (max-width: 768px)":{flexDirection:"column",gap:"8px",padding:"8px 16px"}},children:[i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{color:G,fontSize:"14px",fontWeight:"bold"},children:"TOTAL TRADES"}),i.jsx("div",{style:{color:G,fontSize:"18px",fontWeight:"bold"},children:v.totalTrades})]}),i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{color:G,fontSize:"14px",fontWeight:"bold"},children:"WINS"}),i.jsx("div",{style:{color:G,fontSize:"18px",fontWeight:"bold"},children:v.winTrades})]}),i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{color:G,fontSize:"14px",fontWeight:"bold"},children:"LOSSES"}),i.jsx("div",{style:{color:G,fontSize:"18px",fontWeight:"bold"},children:v.lossTrades})]}),i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{color:G,fontSize:"14px",fontWeight:"bold"},children:"OPEN"}),i.jsx("div",{style:{color:G,fontSize:"18px",fontWeight:"bold"},children:v.openTrades})]}),i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{color:G,fontSize:"14px",fontWeight:"bold"},children:"WIN RATE"}),i.jsxs("div",{style:{color:G,fontSize:"18px",fontWeight:"bold"},children:[v.winRate.toFixed(1),"%"]})]}),i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{color:G,fontSize:"14px",fontWeight:"bold"},children:"AVG RETURN"}),i.jsxs("div",{style:{color:G,fontSize:"18px",fontWeight:"bold"},children:[v.averageReturn.toFixed(1),"%"]})]})]}),a&&i.jsx(Je,{message:a,type:s,onClose:()=>l("")}),i.jsxs("div",{style:{padding:"20px"},children:[i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"10px"},children:i.jsx("button",{onClick:y,style:{background:"none",border:"none",color:G,fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",padding:"4px 8px",textDecoration:"underline"},children:d?"DONE":"EDIT"})}),n.length===0?i.jsxs("div",{style:{textAlign:"center",padding:"60px 20px",color:G,fontSize:"18px"},children:[i.jsx("div",{style:{marginBottom:"20px"},children:"üìä No executed trades yet"}),i.jsx("div",{style:{fontSize:"14px",opacity:.7},children:"Execute trades from the Universe page to see them here"})]}):i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:`1px solid ${G}`,fontSize:"14px",tableLayout:"fixed",lineHeight:"24px"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{background:"rgba(140,185,162,0.1)",borderBottom:`2px solid ${G}`,height:"40px"},children:[d&&i.jsx("th",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden",width:"40px"},children:i.jsx("input",{type:"checkbox",checked:u.size===n.length&&n.length>0,onChange:A,style:{accentColor:G}})}),i.jsx("th",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:"Ticker"}),i.jsx("th",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:"Setup"}),i.jsx("th",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:"R:R"}),i.jsx("th",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:"Verdict"}),i.jsx("th",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:"Outcome"}),i.jsx("th",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:"Entry"}),i.jsx("th",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:"Stop"}),i.jsx("th",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:"Target"}),i.jsx("th",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:"Position"}),i.jsx("th",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:"Date"}),i.jsx("th",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:"Price Source"}),d&&i.jsx("th",{style:{padding:"0px",textAlign:"center",height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:"Actions"})]})}),i.jsx("tbody",{children:n.map((g,P)=>i.jsxs("tr",{style:{borderBottom:`1px solid ${G}`,background:P%2===0?"rgba(0,0,0,0.3)":"rgba(0,0,0,0.1)",height:"40px"},children:[d&&i.jsx("td",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden",width:"40px"},children:i.jsx("input",{type:"checkbox",checked:u.has(g.id),onChange:()=>C(g.id),style:{accentColor:G}})}),i.jsx("td",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,fontWeight:"bold",height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:i.jsx("span",{onClick:()=>T(g.ticker),style:{cursor:"pointer",textDecoration:"underline",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},title:`Click to open ${g.ticker} chart in new tab`,children:g.ticker})}),i.jsx("td",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:g.setup||g.setupType||"Manual"}),i.jsx("td",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:g.riskReward?`${g.riskReward}:1`:"N/A"}),i.jsx("td",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",height:"24px",maxHeight:"24px"},children:[i.jsx("img",{src:g.verdictFlag||Pt,alt:g.verdict,style:{width:"14px",height:"14px"}}),i.jsx("span",{style:{fontSize:"12px",lineHeight:"14px"},children:g.verdict||"Qualified"})]})}),i.jsx("td",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:i.jsxs("select",{value:g.outcome||"Open",onChange:E=>x(g.id,{outcome:E.target.value}),style:{background:"transparent",color:G,border:"none",padding:"2px 4px",fontFamily:"'Courier New', monospace",fontSize:"11px",cursor:"pointer",height:"35px",maxHeight:"35px",lineHeight:"31px"},children:[i.jsx("option",{value:"Open",children:"Open"}),i.jsx("option",{value:"Win",children:"Win"}),i.jsx("option",{value:"Loss",children:"Loss"}),i.jsx("option",{value:"Break Even",children:"Break Even"})]})}),i.jsxs("td",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:["$",g.entryPrice?g.entryPrice.toFixed(2):"N/A",g.currentMarketPrice&&i.jsxs("div",{style:{fontSize:"10px",color:"#666",marginTop:"2px",fontStyle:"italic"},children:["Market: $",g.currentMarketPrice.toFixed(2)]})]}),i.jsxs("td",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:["$",g.stopLoss?g.stopLoss.toFixed(2):"N/A"]}),i.jsxs("td",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:["$",g.target?g.target.toFixed(2):"N/A"]}),i.jsx("td",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:g.positionSize?`${g.positionSize} shares`:"N/A"}),i.jsx("td",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:g.executedAt?k(g.executedAt):k(g.date)}),i.jsx("td",{style:{padding:"0px",textAlign:"center",borderRight:`1px solid ${G}`,height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:g.priceSource||"Manual"}),d&&i.jsx("td",{style:{padding:"8px",textAlign:"center",height:"40px",minHeight:"40px",maxHeight:"40px",lineHeight:"24px",boxSizing:"border-box",verticalAlign:"middle",overflow:"hidden"},children:i.jsx(de,{onClick:()=>b(g.id),style:{background:"none",border:"none",color:"#ff4444",padding:"2px 4px",fontSize:"10px",cursor:"pointer",height:"20px",maxHeight:"20px",lineHeight:"16px"},children:"DELETE"})})]},g.id))})]})})]}),d&&i.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"10px 20px",borderBottom:`1px solid ${G}`,background:"rgba(0,0,0,0.2)",gap:"10px",marginBottom:"20px"},children:[i.jsx(de,{onClick:A,style:{background:u.size===n.length?G:"transparent",color:u.size===n.length?"#000000":G,border:`1px solid ${G}`,padding:"6px 12px",fontFamily:"'Courier New', monospace",fontSize:"10px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease"},children:u.size===n.length?"DESELECT ALL":"SELECT ALL"}),i.jsxs(de,{onClick:R,disabled:u.size===0,style:{background:u.size===0?"rgba(0,0,0,0.3)":"transparent",color:u.size===0?"#666":"#e31507",border:`1px solid ${u.size===0?"#666":"#e31507"}`,padding:"6px 12px",fontFamily:"'Courier New', monospace",fontSize:"10px",fontWeight:"bold",cursor:u.size===0?"not-allowed":"pointer",transition:"all 0.2s ease"},children:["DELETE (",u.size,")"]}),i.jsxs(de,{onClick:Y,disabled:u.size===0,style:{background:u.size===0?"rgba(0,0,0,0.3)":"transparent",color:u.size===0?"#666":G,border:`1px solid ${u.size===0?"#666":G}`,padding:"6px 12px",fontFamily:"'Courier New', monospace",fontSize:"10px",fontWeight:"bold",cursor:u.size===0?"not-allowed":"pointer",transition:"all 0.2s ease"},children:["CREATE BURNLIST (",u.size,")"]})]})]})},Ds=()=>{const[t,e]=S.useState(""),[r,n]=S.useState(null),[o,a]=S.useState(!1),[s,l]=S.useState(""),d=async()=>{a(!0),l(""),n(null);try{const h=await fetch(`http://localhost:3001/api/finviz-quote?ticker=${t.toUpperCase()}`);if(!h.ok)throw new Error("Failed to fetch");const u=await h.json();Array.isArray(u)&&u.length>0&&u[0].Close?n(u[0].Close):l("No price data found")}catch{l("Error fetching price")}a(!1)};return i.jsxs("div",{style:{maxWidth:400,margin:"60px auto",padding:24,background:"#111",color:"#C0FFC0",borderRadius:8,fontFamily:"monospace"},children:[i.jsx("h2",{style:{color:"#C0FFC0"},children:"Add Stock & Get Current Price"}),i.jsx("input",{type:"text",value:t,onChange:h=>e(h.target.value),placeholder:"Enter ticker (e.g. SPY)",style:{width:"100%",padding:8,fontSize:18,marginBottom:12,borderRadius:4,border:"1px solid #333",background:"#222",color:"#C0FFC0"}}),i.jsx("button",{onClick:d,disabled:o||!t,style:{width:"100%",padding:10,fontSize:18,background:"#C0FFC0",color:"#111",border:"none",borderRadius:4,cursor:"pointer",fontWeight:"bold"},children:o?"Loading...":"Get Price"}),r&&i.jsxs("div",{style:{marginTop:24,fontSize:22,color:"#C0FFC0"},children:["Current Price: ",i.jsx("span",{style:{fontWeight:"bold"},children:r})]}),s&&i.jsx("div",{style:{marginTop:16,color:"#FF5555"},children:s})]})},Ye="rgb(140,185,162)",ks=()=>{const t=it(),e=dt(),{isInverted:r,toggleTheme:n}=ut(),o=ne(Ye),a=ne("black"),s=ne("#e31507"),{notification:l,notificationType:d,setNotification:h}=St();return i.jsx("div",{style:{fontFamily:"Courier New",color:o,backgroundColor:a,minHeight:"100vh",padding:"0"},children:i.jsxs("div",{style:{padding:"32px","@media (max-width: 768px)":{padding:"16px",paddingBottom:"80px"},"@media (max-width: 480px)":{padding:"12px",paddingBottom:"80px"}},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:24,flexWrap:"wrap",gap:"12px","@media (max-width: 768px)":{flexDirection:"column",alignItems:"flex-start",marginBottom:16}},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,"@media (max-width: 480px)":{gap:8}},children:[i.jsx("button",{onClick:n,style:{border:"none",background:"none",padding:0,cursor:"pointer",display:"flex",alignItems:"center",minHeight:"44px"},"aria-label":"Toggle theme",children:i.jsx("img",{src:r?Yn:Gn,alt:"Burnlist Logo",style:{width:40,height:40,marginRight:10,transition:"filter 0.3s","@media (max-width: 480px)":{width:32,height:32,marginRight:8}}})}),i.jsx("strong",{style:{fontSize:"170%",lineHeight:"40px",display:"inline-block",color:o,"@media (max-width: 768px)":{fontSize:"140%",lineHeight:"32px"},"@media (max-width: 480px)":{fontSize:"120%",lineHeight:"28px"}},children:"BURNLIST v1.1"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,"@media (max-width: 768px)":{alignSelf:"flex-end"}},children:[i.jsx("span",{style:{color:s,fontWeight:"bold",fontSize:12},children:"19"}),i.jsx("span",{style:{color:o,fontWeight:"bold",fontSize:12},children:"6"}),i.jsx("span",{style:{color:o},children:"ACCOUNT: local"})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"10px 20px",borderBottom:`1px solid ${Ye}`,background:"rgba(0,0,0,0.3)",gap:"10px",marginBottom:"20px"},children:[i.jsx(de,{onClick:()=>t("/universes"),style:{background:e.pathname==="/universes"||e.pathname.startsWith("/universe/")?Ye:"transparent",color:e.pathname==="/universes"||e.pathname.startsWith("/universe/")?"#000000":Ye,border:`1px solid ${Ye}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"UNIVERSE"}),i.jsx(de,{onClick:()=>t("/journal"),style:{background:e.pathname==="/journal"?Ye:"transparent",color:e.pathname==="/journal"?"#000000":Ye,border:`1px solid ${Ye}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"JOURNAL"}),i.jsx(de,{onClick:()=>t("/market"),style:{background:e.pathname==="/market"?Ye:"transparent",color:e.pathname==="/market"?"#000000":Ye,border:`1px solid ${Ye}`,padding:"9px 18px",fontFamily:"'Courier New', monospace",fontSize:"12px",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s ease",minWidth:"80px",textAlign:"center"},children:"MARKET"})]}),i.jsxs("div",{style:{textAlign:"center",marginTop:"50px",color:o},children:[i.jsx("h2",{style:{fontSize:"24px",marginBottom:"20px"},children:"MARKET DATA"}),i.jsx("p",{style:{fontSize:"16px",marginBottom:"30px"},children:"Market analysis and data will be displayed here."})]}),l&&i.jsx("div",{style:{position:"fixed",top:24,left:0,right:0,zIndex:10001,display:"flex",justifyContent:"center",pointerEvents:"none","@media (max-width: 768px)":{top:16}},children:i.jsx("div",{style:{minWidth:320,maxWidth:480,pointerEvents:"auto","@media (max-width: 768px)":{minWidth:280,maxWidth:"calc(100vw - 32px)"}},children:i.jsx(Je,{message:l,type:d,onClose:()=>h("")})})})]})})},ri=S.createContext(),lr=()=>{const t=S.useContext(ri);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},As=({children:t})=>{const[e,r]=S.useState(null),[n,o]=S.useState(localStorage.getItem("burnlist_token")),[a,s]=S.useState(!0),[l,d]=S.useState(null);S.useEffect(()=>{n?he.defaults.headers.common.Authorization=`Bearer ${n}`:delete he.defaults.headers.common.Authorization},[n]),S.useEffect(()=>{(async()=>{if(n)try{(await he.get("/api/user/data")).status===200?r({token:n}):f()}catch(v){console.error("Token verification failed:",v),f()}s(!1)})()},[n]);const h=async(w,v)=>{var y,C;try{d(null);const A=await he.post("/api/auth/login",{username:w,password:v}),{token:R,user:Y}=A.data;return o(R),r(Y),localStorage.setItem("burnlist_token",R),{success:!0}}catch(A){const R=((C=(y=A.response)==null?void 0:y.data)==null?void 0:C.error)||"Login failed";return d(R),{success:!1,error:R}}},u=async(w,v)=>{var y,C;try{d(null);const A=await he.post("/api/auth/register",{username:w,password:v}),{token:R,user:Y}=A.data;return o(R),r(Y),localStorage.setItem("burnlist_token",R),{success:!0}}catch(A){const R=((C=(y=A.response)==null?void 0:y.data)==null?void 0:C.error)||"Registration failed";return d(R),{success:!1,error:R}}},f=()=>{r(null),o(null),d(null),localStorage.removeItem("burnlist_token"),delete he.defaults.headers.common.Authorization},T={user:e,token:n,loading:a,error:l,login:h,register:u,logout:f,syncLocalData:async w=>{if(!n)return{success:!1,error:"Not authenticated"};try{const v={};return w.watchlists&&(v.watchlists={},Object.entries(w.watchlists).forEach(([y,C])=>{v.watchlists[y]=C})),w.settings&&(v.settings={},Object.entries(w.settings).forEach(([y,C])=>{v.settings[y]=C})),await he.post("/api/user/data/batch",{data:v}),{success:!0}}catch(v){return console.error("Data sync failed:",v),{success:!1,error:"Failed to sync data"}}},loadUserData:async()=>{if(!n)return null;try{return(await he.get("/api/user/data")).data.data}catch(w){return console.error("Failed to load user data:",w),null}},saveUserData:async(w,v,y)=>{if(!n)return{success:!1,error:"Not authenticated"};try{return await he.post("/api/user/data",{data_type:w,data_key:v,data_value:y}),{success:!0}}catch(C){return console.error("Failed to save user data:",C),{success:!1,error:"Failed to save data"}}},isAuthenticated:!!n};return i.jsx(ri.Provider,{value:T,children:t})};function Er(t){return vt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"},child:[]},{tag:"line",attr:{x1:"1",y1:"1",x2:"23",y2:"23"},child:[]}]})(t)}function Nr(t){return vt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]}]})(t)}function Rr(t){return vt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"},child:[]},{tag:"path",attr:{d:"M7 11V7a5 5 0 0 1 10 0v4"},child:[]}]})(t)}function $s(t){return vt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"},child:[]},{tag:"polyline",attr:{points:"22,6 12,13 2,6"},child:[]}]})(t)}function Ir(t){return vt({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(t)}const js=({onSwitchToRegister:t})=>{const[e,r]=S.useState(""),[n,o]=S.useState(""),[a,s]=S.useState(!1),[l,d]=S.useState(!1),{login:h,error:u}=lr(),f=it(),x=async b=>{b.preventDefault(),d(!0);const k=await h(e,n);d(!1),k.success&&f("/")};return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"max-w-md w-full space-y-8",children:[i.jsxs("div",{children:[i.jsx("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-blue-100",children:i.jsx(Ir,{className:"h-6 w-6 text-blue-600"})}),i.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to your account"}),i.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Or"," ",i.jsx("button",{onClick:t,className:"font-medium text-blue-600 hover:text-blue-500",children:"create a new account"})]})]}),i.jsxs("form",{className:"mt-8 space-y-6",onSubmit:x,children:[u&&i.jsx("div",{className:"rounded-md bg-red-50 p-4",children:i.jsx("div",{className:"text-sm text-red-700",children:u})}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"username",className:"sr-only",children:"Username"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Ir,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{id:"username",name:"username",type:"text",required:!0,className:"appearance-none rounded-md relative block w-full px-3 py-2 pl-10 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Username",value:e,onChange:b=>r(b.target.value)})]})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Rr,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{id:"password",name:"password",type:a?"text":"password",required:!0,className:"appearance-none rounded-md relative block w-full px-3 py-2 pl-10 pr-10 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Password",value:n,onChange:b=>o(b.target.value)}),i.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>s(!a),children:a?i.jsx(Er,{className:"h-5 w-5 text-gray-400"}):i.jsx(Nr,{className:"h-5 w-5 text-gray-400"})})]})]})]}),i.jsx("div",{children:i.jsx("button",{type:"submit",disabled:l,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:l?i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Signing in..."]}):"Sign in"})})]})]})})},Ts=({onSwitchToLogin:t})=>{const[e,r]=S.useState(""),[n,o]=S.useState(""),[a,s]=S.useState(""),[l,d]=S.useState(!1),[h,u]=S.useState(!1),[f,x]=S.useState(!1),[b,k]=S.useState({}),{register:T,error:w}=lr(),v=it(),y=()=>{const A={};return e.length<3&&(A.username="Username must be at least 3 characters"),n.length<6&&(A.password="Password must be at least 6 characters"),n!==a&&(A.confirmPassword="Passwords do not match"),k(A),Object.keys(A).length===0},C=async A=>{if(A.preventDefault(),!y())return;x(!0);const R=await T(e,n);x(!1),R.success&&v("/")};return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"max-w-md w-full space-y-8",children:[i.jsxs("div",{children:[i.jsx("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-green-100",children:i.jsx($s,{className:"h-6 w-6 text-green-600"})}),i.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Create your account"}),i.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Or"," ",i.jsx("button",{onClick:t,className:"font-medium text-blue-600 hover:text-blue-500",children:"sign in to your existing account"})]})]}),i.jsxs("form",{className:"mt-8 space-y-6",onSubmit:C,children:[w&&i.jsx("div",{className:"rounded-md bg-red-50 p-4",children:i.jsx("div",{className:"text-sm text-red-700",children:w})}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"username",className:"sr-only",children:"Username"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Ir,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{id:"username",name:"username",type:"text",required:!0,className:`appearance-none rounded-md relative block w-full px-3 py-2 pl-10 border placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:z-10 sm:text-sm ${b.username?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`,placeholder:"Username",value:e,onChange:A=>r(A.target.value)})]}),b.username&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:b.username})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Rr,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{id:"password",name:"password",type:l?"text":"password",required:!0,className:`appearance-none rounded-md relative block w-full px-3 py-2 pl-10 pr-10 border placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:z-10 sm:text-sm ${b.password?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`,placeholder:"Password",value:n,onChange:A=>o(A.target.value)}),i.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>d(!l),children:l?i.jsx(Er,{className:"h-5 w-5 text-gray-400"}):i.jsx(Nr,{className:"h-5 w-5 text-gray-400"})})]}),b.password&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:b.password})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"confirmPassword",className:"sr-only",children:"Confirm Password"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Rr,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:h?"text":"password",required:!0,className:`appearance-none rounded-md relative block w-full px-3 py-2 pl-10 pr-10 border placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:z-10 sm:text-sm ${b.confirmPassword?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"}`,placeholder:"Confirm Password",value:a,onChange:A=>s(A.target.value)}),i.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>u(!h),children:h?i.jsx(Er,{className:"h-5 w-5 text-gray-400"}):i.jsx(Nr,{className:"h-5 w-5 text-gray-400"})})]}),b.confirmPassword&&i.jsx("p",{className:"mt-1 text-sm text-red-600",children:b.confirmPassword})]})]}),i.jsx("div",{children:i.jsx("button",{type:"submit",disabled:f,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed",children:f?i.jsxs("div",{className:"flex items-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating account..."]}):"Create account"})})]})]})})},Ps=()=>{const[t,e]=S.useState(!0);return i.jsx("div",{children:t?i.jsx(js,{onSwitchToRegister:()=>e(!1)}):i.jsx(Ts,{onSwitchToLogin:()=>e(!0)})})},lt=({children:t})=>{const{isAuthenticated:e,loading:r}=lr();return r?i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):e?t:i.jsx(oi,{to:"/auth",replace:!0})},Es="rgb(140,185,162)",Ns=()=>{const t=dt(),e=ne(Es),r=ne("black"),n=[{path:"/universes",label:"UNIVERSE"},{path:"/journal",label:"DASHBOARD"},{path:"/market",label:"MARKET"},{path:"/",label:"GRAPH VIEW"}];return i.jsxs(i.Fragment,{children:[i.jsx("style",{children:`
          .mobile-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: ${r};
            border-top: 1px solid ${e};
            padding: 12px 16px;
            z-index: 1000;
            display: flex;
            justify-content: space-around;
            align-items: center;
            gap: 8px;
          }
          
          @media (min-width: 769px) {
            .mobile-nav {
              display: none !important;
            }
          }
          
          .mobile-nav-button {
            background: ${r};
            color: ${e};
            border: 1px solid ${e};
            padding: 8px 12px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            font-weight: bold;
            text-decoration: none;
            text-align: center;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex: 1;
            transition: all 0.2s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
          }
          
          .mobile-nav-button:active {
            background: ${e};
            color: ${r};
          }
          
          @media (max-width: 480px) {
            .mobile-nav {
              padding: 8px 12px;
              gap: 6px;
            }
            .mobile-nav-button {
              font-size: 10px;
              padding: 6px 8px;
              letter-spacing: 0.3px;
            }
          }
        `}),i.jsx("div",{className:"mobile-nav",children:n.map(o=>{const a=t.pathname===o.path;return i.jsx(Zt,{to:o.path,className:"mobile-nav-button",style:{backgroundColor:a?e:r,color:a?r:e},children:o.label},o.path)})})]})};function Rs(){const[t,e]=S.useState(()=>{try{const a=localStorage.getItem("burnlist_watchlists");return c.info("üíæ Loaded watchlists from localStorage:",a),a?JSON.parse(a):{}}catch{return{}}}),{isAuthenticated:r,syncLocalData:n,loadUserData:o}=lr();return S.useEffect(()=>{c.info("üíæ Saving watchlists to localStorage:",t),localStorage.setItem("burnlist_watchlists",JSON.stringify(t))},[t]),S.useEffect(()=>{(async()=>{if(r)try{(await n({watchlists:t})).success&&c.info("‚úÖ Local data synced to server");const d=await o();if(d&&d.watchlists){const h={...t,...d.watchlists};e(h),c.info("‚úÖ Server data loaded and merged")}}catch(s){c.error("‚ùå Data sync failed:",s)}})()},[r]),S.useEffect(()=>()=>{Me.cleanup()},[]),i.jsx(ji,{children:i.jsxs(ai,{children:[i.jsxs(si,{children:[i.jsx(rt,{path:"/auth",element:i.jsx(Ps,{})}),i.jsx(rt,{path:"/",element:i.jsx(lt,{children:i.jsx(Aa,{watchlists:t,setWatchlists:e})})}),i.jsx(rt,{path:"/watchlist/:slug",element:i.jsx(lt,{children:i.jsx(rs,{watchlists:t,setWatchlists:e})})}),i.jsx(rt,{path:"/universes",element:i.jsx(lt,{children:i.jsx(xs,{})})}),i.jsx(rt,{path:"/universe/:slug",element:i.jsx(lt,{children:i.jsx(ms,{})})}),i.jsx(rt,{path:"/trade",element:i.jsx(lt,{children:i.jsx(vs,{})})}),i.jsx(rt,{path:"/journal",element:i.jsx(lt,{children:i.jsx(Cs,{})})}),i.jsx(rt,{path:"/add-stock-price",element:i.jsx(lt,{children:i.jsx(Ds,{})})}),i.jsx(rt,{path:"/market",element:i.jsx(lt,{children:i.jsx(ks,{})})})]}),i.jsx(Ns,{})]})})}function Is(){return i.jsx(As,{children:i.jsx(Rs,{})})}c.info("üöÄ MAIN.JSX is running");Sr.createRoot(document.getElementById("root")).render(i.jsx(Is,{}));
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
